#textdomain wesnoth-ModifiedWorldConquest


#define MAGENTA_IS_THE_TEAM_COLOR
    # A macro to define a common set of magenta color values which different
    # units can be color shifted by using the team color system.
    flag_rgb=magenta
#enddef

#define MENU_IMG_TXT IMAGE TEXT
"&"+{IMAGE}+"="+{TEXT}#enddef

#define WEAPON_SPECIAL_RAMMING
    [attacks]
        id=ramming
        name= _ "ramming"
        description= _ "When used offensively, this attack gets 1 more strikes but have decreased chance to hit by 10%."
        add=1
        apply_to=self
        active_on=offense
    [/attacks]
    [chance_to_hit]
        id=ramming
        sub=10
		apply_to=self
        cumulative=yes
        active_on=offense
    [/chance_to_hit]
#enddef

#define WEAPON_SPECIAL_MAD_GUNFIRE
    [attacks]
        id=mad_gunfire
        name= _ "mad gunfire"
        description= _ "When used offensively, this attack gets 50% more strikes but have decreased chance to hit by 10%."
		multiply=1.5
        apply_to=self
        active_on=offense
    [/attacks]
    [chance_to_hit]
        id=mad_gunfire
        sub=10
		apply_to=self
        cumulative=yes
        active_on=offense
    [/chance_to_hit]
#enddef

#define ABILITY_ABYSSPORTAL
	[teleport]
		id=abyssportal
		name=_"abyss portal"
		female_name=_"female^abyss portal"
		description= _ "This unit can use one move to teleport between any two chasms (besides this one with lava inside) visible on the map." 
		[tunnel]
			id=chasm_teleport
			[source]
				terrain=Qxu^*,Qxe^*,Qxua^*,Qx*,Qx*^*
				[not]
					[filter]
						[not]
							id=$teleport_unit.id
						[/not]
					[/filter]
				[/not]
			[/source]

			[target]
				terrain=Qxu^*,Qxe^*,Qxua^*,Qx*,Qx*^*
				[not]
					[filter]
						[not]
							id=$teleport_unit.id
						[/not]
					[/filter]
				[/not]
			[/target]

			[filter]
				ability=abyssportal
			[/filter]
		[/tunnel]
	[/teleport]
#enddef

#define WILD_MAGIC_EVENT
	[event]
		name=side turn
		first_time_only=no
		id=jumper_jumping
		[store_unit]
			[filter]
				ability=cr_wild_magic,wild_magic
				side=$side_number
			[/filter]
			kill=no
			variable=all_jumpers
		[/store_unit]
		{FOREACH all_jumpers k}
			{VARIABLE_OP temp_rand rand 1..10}
			[if]
				[variable]
					name=temp_rand
					less_than_equal_to=3
				[/variable]
				[then]
					[store_unit]
						[filter]
							id=$all_jumpers[$k].id
						[/filter]
						kill=yes
						variable=jumpers_to_jump
					[/store_unit]
					{FOREACH jumpers_to_jump i}
						[store_map_dimensions]
							variable=map_max_mwc
						[/store_map_dimensions]
						{VARIABLE_OP jumper_new_x rand (1..$map_max_mwc.width)}
						{VARIABLE_OP jumper_new_y rand (1..$map_max_mwc.height)}
						{CLEAR_VARIABLE map_max_mwc}
						{VARIABLE_OP temp_rand2 rand 1..3}
						[if]
							[variable]
								name=temp_rand2
								equals=1
							[/variable]
							[then]
								[scroll_to]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									check_fogged=false
								[/scroll_to]
								[sound]
									name=magic-dark-big.ogg
								[/sound]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-1.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-2.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-3.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-4.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-5.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=50
								[/delay]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-6.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-7.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
									halo=projectiles/whitemissile-impact-8.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								
								[delay]
									time=30
								[/delay]
								[remove_item]
									x,y=$jumpers_to_jump[$i].x,$jumpers_to_jump[$i].y
								[/remove_item]
								[remove_shroud]
									side=$side_number
									x=$jumper_new_x
									y=$jumper_new_y
									radius=1
								[/remove_shroud]
								# If there's a unit on the other rune, it swaps places
								[if]
									[have_unit]
										x=$jumper_new_x
										y=$jumper_new_y
									[/have_unit]
									[then]
										{VARIABLE temp_some_value yes}
										[store_unit]
											[filter]
												x=$jumper_new_x
												y=$jumper_new_y
											[/filter]
											kill=yes
											variable=stored_unit
										[/store_unit]
										{VARIABLE stored_unit.x $jumpers_to_jump[$i].x}
										{VARIABLE stored_unit.y $jumpers_to_jump[$i].y}
									[/then]
								[/if]
								[scroll_to]
									x,y=$jumper_new_x,$jumper_new_y
									check_fogged=false
								[/scroll_to]
								[sound]
									name=dwarf-laugh.wav
								[/sound]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-1.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-2.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-3.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-4.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-5.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=50
								[/delay]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-6.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-7.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								
								[delay]
									time=30
								[/delay]
								[item]
									x,y=$jumper_new_x,$jumper_new_y
									halo=projectiles/whitemissile-impact-8.png
								[/item]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								
								[delay]
									time=30
								[/delay]
								[remove_item]
									x,y=$jumper_new_x,$jumper_new_y
								[/remove_item]
								[teleport]
								  [filter]
									x=$jumpers_to_jump[$i].x
									y=$jumpers_to_jump[$i].y
								  [/filter]
								  x=$jumper_new_x
								  y=$jumper_new_y
								[/teleport]
								[redraw]
									side=1,2,3,4,5,6,7,8,9
								[/redraw]
								[if]
									[variable]
										name=temp_some_value
										equals=yes
									[/variable]
									[then]
										[unstore_unit]
											variable=stored_unit
										[/unstore_unit]
										{CLEAR_VARIABLE stored_unit,temp_some_value}
									[/then]
								[/if]
								{VARIABLE_OP red rand 1..255}
								{VARIABLE_OP green rand 1..255}
								{VARIABLE_OP blue rand 1..255}
								{VARIABLE jumpers_to_jump[$i].x $jumper_new_x}
								{VARIABLE jumpers_to_jump[$i].y $jumper_new_y}
								[unstore_unit]
									variable=jumpers_to_jump[$i]
									text="Teleportation!!!"
									red,green,blue=$red,$green,$blue
								[/unstore_unit]
								{CLEAR_VARIABLE jumper_new_x,jumper_new_y,temp_rand2}
								{CLEAR_VARIABLE red,green,blue}
							[/then]
							[else]
								[if]
									[variable]
										name=temp_rand2
										equals=2
									[/variable]
									[then]
										[store_unit]
											[filter]
												[filter_adjacent]
													id=$jumpers_to_jump[$i].id
													ability=cr_wild_magic,wild_magic
													adjacent=n,ne,se,s,sw,nw
													is_enemy=yes
												[/filter_adjacent]
											[/filter]
											kill=no
											variable=adjacted_to_jumper
										[/store_unit]
										{FOREACH adjacted_to_jumper j}
											{VARIABLE_OP temp_rand3 rand 1..3}
											[if]
												[variable]
													name=temp_rand3
													equals=1
												[/variable]
												[then]
													[scroll_to]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														check_fogged=false
													[/scroll_to]
													[sound]
														name=magic-dark-big.ogg
													[/sound]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-1.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-2.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-3.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-4.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-5.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=50
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-6.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-7.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/whitemissile-impact-8.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[remove_item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
													[/remove_item]
													[remove_shroud]
														side=$side_number
														x=$jumper_new_x
														y=$jumper_new_y
														radius=1
													[/remove_shroud]
													# If there's a unit on the other rune, it swaps places
													[if]
														[have_unit]
															x=$jumper_new_x
															y=$jumper_new_y
														[/have_unit]
														[then]
															{VARIABLE temp_some_value yes}
															[store_unit]
																[filter]
																	x=$jumper_new_x
																	y=$jumper_new_y
																[/filter]
																kill=yes
																variable=stored_unit
															[/store_unit]
															{VARIABLE stored_unit.x $adjacted_to_jumper[$j].x}
															{VARIABLE stored_unit.y $adjacted_to_jumper[$j].y}
														[/then]
													[/if]
													[scroll_to]
														x,y=$jumper_new_x,$jumper_new_y
														check_fogged=false
													[/scroll_to]
													[sound]
														name=dwarf-laugh.wav
													[/sound]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-1.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-2.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-3.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-4.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-5.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=50
													[/delay]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-6.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-7.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$jumper_new_x,$jumper_new_y
														halo=projectiles/whitemissile-impact-8.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[remove_item]
														x,y=$jumper_new_x,$jumper_new_y
													[/remove_item]
													[teleport]
													  [filter]
														x=$adjacted_to_jumper[$j].x
														y=$adjacted_to_jumper[$j].y
													  [/filter]
													  x=$jumper_new_x
													  y=$jumper_new_y
													[/teleport]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[if]
														[variable]
															name=temp_some_value
															equals=yes
														[/variable]
														[then]
															[unstore_unit]
																variable=stored_unit
															[/unstore_unit]
															{CLEAR_VARIABLE stored_unit,temp_some_value}
														[/then]
													[/if]
													{VARIABLE_OP red rand 1..255}
													{VARIABLE_OP green rand 1..255}
													{VARIABLE_OP blue rand 1..255}
													{VARIABLE adjacted_to_jumper[$j].x $jumper_new_x}
													{VARIABLE adjacted_to_jumper[$j].y $jumper_new_y}
													[unstore_unit]
														variable=adjacted_to_jumper[$j]
														text="Teleportation!!!"
														red,green,blue=$red,$green,$blue
													[/unstore_unit]
													{CLEAR_VARIABLE jumper_new_x,jumper_new_y,temp_rand3}
													{CLEAR_VARIABLE red,green,blue}
												[/then]
												[else]
													[unstore_unit]
														variable=adjacted_to_jumper[$j]
													[/unstore_unit]
												[/else]
											[/if]
										{NEXT j}
										[unstore_unit]
											variable=jumpers_to_jump[$i]
										[/unstore_unit]
										{CLEAR_VARIABLE adjacted_to_jumper}
									[/then]
									[else]
										{VARIABLE_OP temp_rand3 rand 1..10}
										{VARIABLE temp_rand4 0}
										[while]
											[variable]
												name=temp_rand4
												less_than=$temp_rand3
											[/variable]
											[do]
												[if]
													[have_unit]
														x,y=$jumper_new_x,$jumper_new_y
													[/have_unit]
													[then]
														[store_unit]
															[filter]
																x=$jumper_new_x
																y=$jumper_new_y
															[/filter]
															kill=no
															variable=stored_unit
														[/store_unit]
														[store_map_dimensions]
															variable=map_max_mwc
														[/store_map_dimensions]
														{VARIABLE_OP jumper_new_x2 rand (1..$map_max_mwc.width)}
														{VARIABLE_OP jumper_new_y2 rand (1..$map_max_mwc.height)}
														{CLEAR_VARIABLE map_max_mwc}
														[scroll_to]
															x,y=$jumper_new_x,$jumper_new_y
															check_fogged=false
														[/scroll_to]
														[sound]
															name=magic-dark-big.ogg
														[/sound]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-1.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-2.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-3.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-4.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-5.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=50
														[/delay]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-6.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-7.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x,$jumper_new_y
															halo=projectiles/whitemissile-impact-8.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														
														[delay]
															time=30
														[/delay]
														[remove_item]
															x,y=$jumper_new_x,$jumper_new_y
														[/remove_item]
														[remove_shroud]
															side=$side_number
															x=$jumper_new_x2
															y=$jumper_new_y2
															radius=1
														[/remove_shroud]
														# If there's a unit on the other rune, it swaps places
														[if]
															[have_unit]
																x=$jumper_new_x2
																y=$jumper_new_y2
															[/have_unit]
															[then]
																{VARIABLE temp_some_value yes}
																[store_unit]
																	[filter]
																		x=$jumper_new_x2
																		y=$jumper_new_y2
																	[/filter]
																	kill=yes
																	variable=stored_unit2
																[/store_unit]
																{VARIABLE stored_unit2.x $jumper_new_x}
																{VARIABLE stored_unit2.y $jumper_new_y}
															[/then]
														[/if]
														[scroll_to]
															x,y=$jumper_new_x2,$jumper_new_y2
															check_fogged=false
														[/scroll_to]
														[sound]
															name=dwarf-laugh.wav
														[/sound]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-1.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-2.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-3.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-4.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-5.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=50
														[/delay]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-6.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-7.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														
														[delay]
															time=30
														[/delay]
														[item]
															x,y=$jumper_new_x2,$jumper_new_y2
															halo=projectiles/whitemissile-impact-8.png
														[/item]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														
														[delay]
															time=30
														[/delay]
														[remove_item]
															x,y=$jumper_new_x2,$jumper_new_y2
														[/remove_item]
														[teleport]
														  [filter]
															x=$jumper_new_x
															y=$jumper_new_y
														  [/filter]
														  x=$jumper_new_x2
														  y=$jumper_new_y2
														[/teleport]
														[redraw]
															side=1,2,3,4,5,6,7,8,9
														[/redraw]
														[if]
															[variable]
																name=temp_some_value
																equals=yes
															[/variable]
															[then]
																[unstore_unit]
																	variable=stored_unit2
																[/unstore_unit]
																{CLEAR_VARIABLE stored_unit2,temp_some_value}
															[/then]
														[/if]
														{VARIABLE_OP red rand 1..255}
														{VARIABLE_OP green rand 1..255}
														{VARIABLE_OP blue rand 1..255}
														{VARIABLE stored_unit.x $jumper_new_x2}
														{VARIABLE stored_unit.y $jumper_new_y2}
														[unstore_unit]
															variable=stored_unit
															text="Teleportation!!!"
															red,green,blue=$red,$green,$blue
														[/unstore_unit]
														{CLEAR_VARIABLE jumper_new_x,jumper_new_y,jumper_new_x2,jumper_new_y2}
														{CLEAR_VARIABLE red,green,blue}
													[/then]
												[/if]
												{VARIABLE_OP temp_rand4 add 1}
											[/do]
										[/while]
										[unstore_unit]
											variable=jumpers_to_jump[$i]
										[/unstore_unit]
										{CLEAR_VARIABLE temp_rand3,temp_rand4}
									[/else]
								[/if]
							[/else]
						[/if]
					{NEXT i}
					{CLEAR_VARIABLE jumpers_to_jump}
				[/then]
				[else]
					[if]
						[variable]
							name=temp_rand
							less_than_equal_to=8
						[/variable]
						[then]
							[store_unit]
								[filter]
									id=$all_jumpers[$k].id
								[/filter]
								kill=no
								variable=jumpers
							[/store_unit]
							{FOREACH jumpers i}
								[store_unit]
									[filter]
										[filter_adjacent]
											id=$jumpers[$i].id
											ability=cr_wild_magic,wild_magic
											adjacent=n,ne,se,s,sw,nw
											is_enemy=yes
										[/filter_adjacent]
									[/filter]
									kill=no
									variable=adjacted_to_jumper
								[/store_unit]
								{FOREACH adjacted_to_jumper j}
									{VARIABLE_OP temp_rand_2 rand 1..2}
									[if]
										[variable]
											name=temp_rand_2
											equals=1
										[/variable]
										[then]
											{VARIABLE_OP temp_rand_3 rand 1..3}
											[switch]
												variable=temp_rand_3
												[case]
													value=1
													[scroll_to]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														check_fogged=false
													[/scroll_to]
													[sound]
														name=lightning.ogg
													[/sound]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-1.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-2.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-3.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-4.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=50
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-5.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-6.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-7.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-8.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-9.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-10.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-11.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-12.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-13.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fireball-impact-14.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[remove_item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
													[/remove_item]
												[/case]
												[case]
													value=2
													[scroll_to]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														check_fogged=false
													[/scroll_to]
													[sound]
														name=lightning.ogg
													[/sound]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-1.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-2.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-3.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-4.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-5.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=50
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-6.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-7.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-burst-small-8.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[remove_item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
													[/remove_item]
												[/case]
												[case]
													value=3
													[scroll_to]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														check_fogged=false
													[/scroll_to]
													[sound]
														name=lightning.ogg
													[/sound]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-1.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-2.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-3.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-4.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-5.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=50
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-6.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-7.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-8.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-9.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													
													[delay]
														time=30
													[/delay]
													[item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
														halo=projectiles/fire-breath-10.png
													[/item]
													[redraw]
														side=1,2,3,4,5,6,7,8,9
													[/redraw]
													[delay]
														time=30
													[/delay]
													[remove_item]
														x,y=$adjacted_to_jumper[$j].x,$adjacted_to_jumper[$j].y
													[/remove_item]
												[/case]
											[/switch]
											{VARIABLE_OP value_dmg rand "50,49,49,48,48,48,47,47,47,47,46,46,46,46,46,45,45,45,45,45,45,44,44,44,44,44,44,44,43,43,43,43,43,43,43,43,42,42,42,42,42,42,42,42,42,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,41,41,41,41,41,41,41,41,41,41,41,41,40,40,40,40,40,40,40,40,40,40,40,40,40,39,39,39,39,39,39,39,39,39,39,39,39,39,39,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"}
											{VARIABLE_OP value_dmg2 rand 0..$turn_number}
											{VARIABLE_OP value_dmg add $value_dmg2}
											{VARIABLE_OP type_dmg rand (blade,pierce,impact,cold,fire,arcane)}
											[harm_unit]
												[filter]
													id=$adjacted_to_jumper[$j].id
												[/filter]
												amount=$value_dmg
												slowed=no
												damage_type=$type_dmg
												fire_event=yes
												experience=no
												animate=no
												kill=no
											[/harm_unit]
											{CLEAR_VARIABLE value_dmg,type_dmg,temp_rand_3,value_dmg2}
										[/then]
										[else]
											{VARIABLE_OP temp_rand_2 rand 1..2}
											[if]
												[variable]
													name=temp_rand_2
													equals=1
												[/variable]
												[then]
													[store_map_dimensions]
														variable=map_max_mwc
													[/store_map_dimensions]
													{VARIABLE_OP hit_x rand (1..$map_max_mwc.width)}
													{VARIABLE_OP hit_y rand (1..$map_max_mwc.height)}
													{CLEAR_VARIABLE map_max_mwc}
													[if]
														[have_unit]
															x,y=$hit_x,$hit_y
														[/have_unit]
														[then]
															{VARIABLE_OP temp_rand_3 rand 1..3}
															[switch]
																variable=temp_rand_3
																[case]
																	value=1
																	[scroll_to]
																		x,y=$hit_x,$hit_y
																		check_fogged=false
																	[/scroll_to]
																	[sound]
																		name=lightning.ogg
																	[/sound]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-1.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-2.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-3.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-4.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=50
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-5.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-6.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-7.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-8.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-9.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-10.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-11.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-12.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-13.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fireball-impact-14.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[remove_item]
																		x,y=$hit_x,$hit_y
																	[/remove_item]
																[/case]
																[case]
																	value=2
																	[scroll_to]
																		x,y=$hit_x,$hit_y
																		check_fogged=false
																	[/scroll_to]
																	[sound]
																		name=lightning.ogg
																	[/sound]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-1.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-2.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-3.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-4.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-5.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=50
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-6.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-7.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-burst-small-8.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[remove_item]
																		x,y=$hit_x,$hit_y
																	[/remove_item]
																[/case]
																[case]
																	value=3
																	[scroll_to]
																		x,y=$hit_x,$hit_y
																		check_fogged=false
																	[/scroll_to]
																	[sound]
																		name=lightning.ogg
																	[/sound]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-1.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-2.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-3.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-4.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-5.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=50
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-6.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-7.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-8.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-9.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	
																	[delay]
																		time=30
																	[/delay]
																	[item]
																		x,y=$hit_x,$hit_y
																		halo=projectiles/fire-breath-10.png
																	[/item]
																	[redraw]
																		side=1,2,3,4,5,6,7,8,9
																	[/redraw]
																	[delay]
																		time=30
																	[/delay]
																	[remove_item]
																		x,y=$hit_x,$hit_y
																	[/remove_item]
																[/case]
															[/switch]
															{VARIABLE_OP value_dmg rand "50,49,49,48,48,48,47,47,47,47,46,46,46,46,46,45,45,45,45,45,45,44,44,44,44,44,44,44,43,43,43,43,43,43,43,43,42,42,42,42,42,42,42,42,42,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,41,41,41,41,41,41,41,41,41,41,41,41,40,40,40,40,40,40,40,40,40,40,40,40,40,39,39,39,39,39,39,39,39,39,39,39,39,39,39,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"}
															{VARIABLE_OP value_dmg2 rand 0..$turn_number}
															{VARIABLE_OP value_dmg add $value_dmg2}
															{VARIABLE_OP type_dmg rand (blade,pierce,impact,cold,fire,arcane)}
															[harm_unit]
																[filter]
																	x,y=$hit_x,$hit_y
																[/filter]
																amount=$value_dmg
																slowed=no
																damage_type=$type_dmg
																fire_event=yes
																experience=no
																animate=no
																kill=no
															[/harm_unit]
															{CLEAR_VARIABLE value_dmg,type_dmg,temp_rand_3,value_dmg2}
														[/then]
													[/if]
													{CLEAR_VARIABLE hit_x,hit_y}
												[/then]
											[/if]
										[/else]
									[/if]
									{CLEAR_VARIABLE temp_rand_2}
								{NEXT j}
								{CLEAR_VARIABLE adjacted_to_jumper}
							{NEXT i}
							{CLEAR_VARIABLE jumpers}
						[/then]
						[else]
							[store_unit]
								[filter]
									id=$all_jumpers[$k].id
								[/filter]
								kill=no
								variable=jumper_to_harm
							[/store_unit]
							{FOREACH jumper_to_harm i}
								{VARIABLE_OP temp_rand_2 rand 1..3}
								[if]
									[variable]
										name=temp_rand_2
										less_than=3
									[/variable]
									[then]
										[scroll_to]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											check_fogged=false
										[/scroll_to]
										[sound]
											name=explosion.ogg
										[/sound]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-n-1.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-n-2.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-n-3.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-4.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-5.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										[delay]
											time=50
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-6.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-7.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-8.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-9.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-10.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-11.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-12.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-13.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										
										[delay]
											time=30
										[/delay]
										[item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
											halo=projectiles/muzzle-flash-14.png
										[/item]
										[redraw]
											side=1,2,3,4,5,6,7,8,9
										[/redraw]
										[delay]
											time=30
										[/delay]
										[remove_item]
											x,y=$jumper_to_harm[$i].x,$jumper_to_harm[$i].y
										[/remove_item]
										{VARIABLE_OP value_dmg rand "50,49,49,48,48,48,47,47,47,47,46,46,46,46,46,45,45,45,45,45,45,44,44,44,44,44,44,44,43,43,43,43,43,43,43,43,42,42,42,42,42,42,42,42,42,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,41,41,41,41,41,41,41,41,41,41,41,41,40,40,40,40,40,40,40,40,40,40,40,40,40,39,39,39,39,39,39,39,39,39,39,39,39,39,39,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"}
										{VARIABLE_OP value_dmg2 rand 0..$turn_number}
										{VARIABLE_OP value_dmg add $value_dmg2}
										{VARIABLE_OP type_dmg rand (blade,pierce,impact,cold,fire,arcane)}
										[harm_unit]
											[filter]
												id=$jumper_to_harm[$i].id
											[/filter]
											amount=$value_dmg
											slowed=no
											damage_type=$type_dmg
											fire_event=yes
											experience=no
											animate=no
											kill=no
										[/harm_unit]
										{CLEAR_VARIABLE value_dmg2}
										{CLEAR_VARIABLE value_dmg,type_dmg,temp_rand_2,red,green,blue,value_dmg2}
									[/then]
								[/if]
							{NEXT i}
							{CLEAR_VARIABLE jumper_to_harm}
						[/else]
					[/if]
				[/else]
			[/if]
			{CLEAR_VARIABLE temp_rand}
		{NEXT k}
		{CLEAR_VARIABLE all_jumpers}
	[/event]
#enddef

#define INCREASE_GOLD_FOR_GOLD_COLLECTORS
	[event]
		name=side turn
		first_time_only=no
		id=igfgc
		[store_unit]
			[filter]
				ability=cr_gold_collector,gold_collector
				side=$side_number
			[/filter]
			kill=no
			variable=all_gold_collectors
		[/store_unit]
		{FOREACH all_gold_collectors i}
			{VARIABLE_OP temp_gold_coins rand "3,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"}
			[scroll_to]
				x,y=$all_gold_collectors[$i].x,$all_gold_collectors[$i].y
				check_fogged=false
			[/scroll_to]
			[gold]
				amount=$temp_gold_coins
				side=$side_number
			[/gold]
			[sound]
				name=gold.ogg
			[/sound]
			[if]
				[variable]
					name=temp_gold_coins
					equals=1
				[/variable]
				[then]
					[unstore_unit]
						variable=all_gold_collectors[$i]
						text="I found 1 gold coin!!!"
						red,green,blue=255,215,0
					[/unstore_unit]
				[/then]
				[else]
					[unstore_unit]
						variable=all_gold_collectors[$i]
						text="I found $temp_gold_coins gold coins!!!"
						red,green,blue=255,215,0
					[/unstore_unit]
				[/else]
			[/if]
			{CLEAR_VARIABLE temp_gold_coins}
		{NEXT i}
		{CLEAR_VARIABLE all_gold_collectors}
	[/event]
#enddef

#define CHECK_DEPOSITS_TURNS_1 NAME
	[if]
		[variable]
			name=gold_in_deposit_{NAME}_turns_$side_number
			not_equals=$null
		[/variable]
		[and]
			[variable]
				name=gold_in_deposit_{NAME}_turns_$side_number
				not_equals=0
			[/variable]
		[/and]
		[then]
			{VARIABLE_OP gold_in_deposit_{NAME}_turns_$side_number sub 1}
			{VARIABLE_OP some_random_for_deposits rand "1,1,1,1,1,2,2,2,2,3,3,3,4,4,5"}
			[switch]
				variable=some_random_for_deposits
				[case]
					value=1
					{VARIABLE_OP some_random_for_deposits rand "1,1,1,1,2,2,2,3,3,4"}
				[/case]
				[case]
					value=2
					{VARIABLE_OP some_random_for_deposits rand "5,5,5,5,6,6,6,7,7,8"}
				[/case]
				[case]
					value=3
					{VARIABLE_OP some_random_for_deposits rand "9,9,9,9,10,10,10,11,11,12"}
				[/case]
				[case]
					value=4
					{VARIABLE_OP some_random_for_deposits rand "13,13,13,13,14,14,14,15,15,16"}
				[/case]
				[case]
					value=5
					{VARIABLE_OP some_random_for_deposits rand "17,17,17,17,18,18,18,19,19,20"}
				[/case]
			[/switch]
			{VARIABLE_OP some_random_for_deposits_2 rand "1..4"}
			[if]
				[variable]
					name=some_random_for_deposits_2
					equals=1
				[/variable]
				[then]
					{VARIABLE_OP some_random_for_deposits_2 value 100}
					{VARIABLE_OP some_random_for_deposits_2 sub $some_random_for_deposits}
					{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number multiply 100}
					{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number divide $some_random_for_deposits_2}
				[/then]
				[else]
					[if]
						[variable]
							name=some_random_for_deposits_2
							equals=2
						[/variable]
						[then]
							{VARIABLE_OP some_random_for_deposits_2 value 100}
							{VARIABLE_OP some_random_for_deposits_2 sub $some_random_for_deposits}
							{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number multiply $some_random_for_deposits_2}
							{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number divide 100}
						[/then]
						[else]
							[if]
								[variable]
									name=some_random_for_deposits_2
									equals=3
								[/variable]
								[then]
									{VARIABLE_OP some_random_for_deposits add 100}
									{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number multiply $some_random_for_deposits}
									{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number divide 100}
								[/then]
								[else]
									{VARIABLE_OP some_random_for_deposits add 100}
									{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number multiply 100}
									{VARIABLE_OP gold_in_deposit_{NAME}_amount_$side_number divide $some_random_for_deposits}
								[/else]
							[/if]
						[/else]
					[/if]
				[/else]
			[/if]
			{CLEAR_VARIABLE some_random_for_deposits,some_random_for_deposits_2}
		[/then]
	[/if]
#enddef

#define CHECK_DEPOSITS_TURNS_2 NAME
	[if]
		[variable]
			name=gold_in_deposit_{NAME}_turns_$side_number
			equals=0
		[/variable]
		[then]
			{VARIABLE_OP random_variable_for_gold add $gold_in_deposit_{NAME}_amount_$side_number}
			{CLEAR_VARIABLE gold_in_deposit_{NAME}_turns_$side_number,gold_in_deposit_{NAME}_amount_$side_number}
		[/then]
	[/if]
#enddef

#define WEAPON_SPECIAL_CYCLOPS_LUCK
    [chance_to_hit]
        id=cyclops_luck
        name= _ "cyclops luck"
        description= _ "When used offensively, this attack always has at least a 40% chance to hit."
        value=40
        cumulative=yes
        active_on=offense
    [/chance_to_hit]
#enddef

#define WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START VARIABLE_NAME
	[if]
		[variable]
			name=extra_special_abilities_inside[$z].variables.{VARIABLE_NAME}_time
			equals=-1
		[/variable]
		[then]
#enddef
#define WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END VARIABLE_NAME
			{MODIFY_UNIT id=$extra_special_abilities_inside[$z].id variables.{VARIABLE_NAME}_time $extra_special_abilities_inside[$z].variables.{VARIABLE_NAME}_time_max}
		[/then]
	[/if]
#enddef

#define WEAPON_SPECIAL_SPECIAL_BLESSED_WEAKER_MELEE
    [attacks]
        id=special_blessed_weaker_melee
        name= _ "special blessed weaker"
        description= _ "When used offensively, weaker blessed weapons do 1 more STRIKES than usual. This weapon special isn't activiated on defense."
        add=1
        apply_to=self
        active_on=offense
    [/attacks]
#enddef

#define WEAPON_SPECIAL_SPECIAL_BLESSED_WEAKER_RANGED
    [attacks]
        id=special_blessed_weaker_ranged
        name= _ "special blessed weaker"
        description= _ "When used offensively, weaker blessed weapons do 1 more STRIKES than usual. This weapon special isn't activiated on defense."
        add=1
        apply_to=self
        active_on=offense
    [/attacks]
#enddef

#define WEAPON_SPECIAL_SPECIAL_VICIOUS_MELEE_VALUE VALUE
	[damage]
		id=special_vicious_melee_{VALUE}
		name=_"special vicious {VALUE} dmg"
		description="+" + {VALUE} +" damage when attacking."
		add={VALUE}
		cumulative=yes
		active_on=offense
		apply_to=self
	[/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_VICIOUS_RANGED_VALUE VALUE
	[damage]
		id=special_vicious_ranged_{VALUE}
		name=_"special vicious {VALUE} dmg"
		description="+" + {VALUE} +" damage when attacking."
		add={VALUE}
		cumulative=yes
		active_on=offense
		apply_to=self
	[/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_UNDAUNTED_MELEE_VALUE VALUE
	[damage]
		id=special_undaunted1_melee_{VALUE}
		add={VALUE}
		cumulative=yes
		active_on=defense
		apply_to=self
	[/damage]
	[damage]
		id=special_undaunted2_melee_{VALUE}
		name=_"special undaunted {VALUE} dmg"
		description="+" + {VALUE} +" damage when defending."
		add=0
		cumulative=yes
		apply_to=self
	[/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_UNDAUNTED_RANGED_VALUE VALUE
	[damage]
		id=special_undaunted1_ranged_{VALUE}
		add={VALUE}
		cumulative=yes
		active_on=defense
		apply_to=self
	[/damage]
	[damage]
		id=special_undaunted2_ranged_{VALUE}
		name=_"special undaunted {VALUE} dmg"
		description="+" + {VALUE} +" damage when defending."
		add=0
		cumulative=yes
		apply_to=self
	[/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_CHARGE_MELEE
    [damage]
        id=special_charge_melee
        name= _ "special charge"
        description= _ "When used offensively, this attack deals double damage to the target. It also causes this unit to take double damage from the target's counterattack."
        multiply=2
        apply_to=both
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_CHARGE_RANGED
    [damage]
        id=special_charge_ranged
        name= _ "special charge"
        description= _ "When used offensively, this attack deals double damage to the target. It also causes this unit to take double damage from the target's counterattack."
        multiply=2
        apply_to=both
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_FOCUS_MELEE
    [damage]
        id=special_focus_melee
        name= _ "special focus"
        description= _ "When used offensively, this attack deals x1.5 damage more to the target. It also causes this unit to take x1.5 damage more from the target's counterattack."
        multiply=1.5
        apply_to=both
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_FOCUS_RANGED
    [damage]
        id=special_focus_ranged
        name= _ "special focus"
        description= _ "When used offensively, this attack deals x1.5 damage more to the target. It also causes this unit to take x1.5 damage more from the target's counterattack."
        multiply=1.5
        apply_to=both
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_DRAIN_MELEE
    [drains]
        id=special_drain_melee
        name= _ "special drains"
        description= _ "This unit drains health from living units, healing itself for half the amount of damage it deals (rounded down)."
    [/drains]
#enddef

#define WEAPON_SPECIAL_SPECIAL_DRAIN_RANGED
    [drains]
        id=special_drain_ranged
        name= _ "special drains"
        description= _ "This unit drains health from living units, healing itself for half the amount of damage it deals (rounded down)."
    [/drains]
#enddef

#define WEAPON_SPECIAL_SPECIAL_SLOW_MELEE
    [slow]
        id=special_slow_melee
        name= _ "special slows"
        description= _ "This attack slows the target until it ends a turn. Slow halves the damage caused by attacks and the movement cost for a slowed unit is doubled. A unit that is slowed will feature a snail icon in its sidebar information when it is selected."
    [/slow]
#enddef

#define WEAPON_SPECIAL_SPECIAL_SLOW_RANGED
    [slow]
        id=special_slow_ranged
        name= _ "special slows"
        description= _ "This attack slows the target until it ends a turn. Slow halves the damage caused by attacks and the movement cost for a slowed unit is doubled. A unit that is slowed will feature a snail icon in its sidebar information when it is selected."
    [/slow]
#enddef

#define WEAPON_SPECIAL_SPECIAL_POISON_MELEE
    [poison]
        id=special_poison_melee
        name= _ "special poison"
        description= _ "This attack poisons living targets. Poisoned units lose 8 HP every turn until they are cured or are reduced to 1 HP. Poison can not, of itself, kill a unit."
    [/poison]
#enddef

#define WEAPON_SPECIAL_SPECIAL_POISON_RANGED
    [poison]
        id=special_poison_ranged
        name= _ "special poison"
        description= _ "This attack poisons living targets. Poisoned units lose 8 HP every turn until they are cured or are reduced to 1 HP. Poison can not, of itself, kill a unit."
    [/poison]
#enddef

#define WEAPON_SPECIAL_SPECIAL_DUEL2_MELEE
    [berserk]
        id=special_duel2_melee
        name= _ "special duel"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 2 rounds of attacks have occurred."
        value=2
		active_on=offense
    [/berserk]
#enddef

#define WEAPON_SPECIAL_SPECIAL_DUEL2_RANGED
    [berserk]
        id=special_duel2_ranged
        name= _ "special duel"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 2 rounds of attacks have occurred."
        value=2
		active_on=offense
    [/berserk]
#enddef

#define WEAPON_SPECIAL_SPECIAL_MARKSMAN_MELEE
    [chance_to_hit]
        id=special_marksman_melee
        name= _ "special marksman"
        description= _ "When used offensively, this attack always has at least a 60% chance to hit."
        value=60
        cumulative=yes
        active_on=offense
    [/chance_to_hit]
#enddef

#define WEAPON_SPECIAL_SPECIAL_MARKSMAN_RANGED
    [chance_to_hit]
        id=special_marksman_ranged
        name= _ "special marksman"
        description= _ "When used offensively, this attack always has at least a 60% chance to hit."
        value=60
        cumulative=yes
        active_on=offense
    [/chance_to_hit]
#enddef

#define WEAPON_SPECIAL_SPECIAL_BACKSTAB_MELEE
    [damage]
        id=special_backstab_melee
        name= _ "special backstab"
        description= _ "When used offensively, this attack deals double damage if there is an enemy of the target on the opposite side of the target, and that unit is not incapacitated (turned to stone or otherwise paralyzed)."
        multiply=2
        backstab=yes
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_SPECIAL_BACKSTAB_RANGED
    [damage]
        id=special_backstab_ranged
        name= _ "special backstab"
        description= _ "When used offensively, this attack deals double damage if there is an enemy of the target on the opposite side of the target, and that unit is not incapacitated (turned to stone or otherwise paralyzed)."
        multiply=2
        backstab=yes
        active_on=offense
    [/damage]
#enddef

#define ABILITY_SPECIAL_SKIRMISHER
    [skirmisher]
        id=special_skirmisher
        name= _ "special skirmisher"
        female_name= _ "female^special skirmisher"
        description= _ "This unit is skilled in moving past enemies quickly, and ignores all enemy Zones of Control."
        affect_self=yes
    [/skirmisher]
#enddef

#define ABILITY_SPECIAL_TELEPORT
    [teleport]
        id=special_teleport
        name= _ "special teleport"
        female_name= _ "female^special teleport"
        description= _ "This unit may teleport between any two empty villages owned by its side using one of its moves."
        [tunnel]
            id=village_teleport
            [source]
                terrain=*^V*
                owner_side=$teleport_unit.side
                [not]
                    [filter]
                        [not]
                            id=$teleport_unit.id
                        [/not]
                    [/filter]
                [/not]
            [/source]

            [target]
                terrain=*^V*
                owner_side=$teleport_unit.side
                [not]
                    [filter]
                    [/filter]
                [/not]
            [/target]

            [filter]
                ability=special_teleport
            [/filter]
        [/tunnel]
		[filter_self]
		[/filter_self]
    [/teleport]
#enddef


#define DECREASE_VARIABLES_FOR_SPECIAL_ABILITY VARIABLE_NAME
	[if]
		[variable]
			name=extra_special_abilities_inside[$z].variables.{VARIABLE_NAME}_time
			greater_than=0
		[/variable]
		[then]
			{VARIABLE some_variable_for_moment $extra_special_abilities_inside[$z].variables.{VARIABLE_NAME}_time}
			{VARIABLE_OP some_variable_for_moment sub 1}
			{MODIFY_UNIT id=$extra_special_abilities_inside[$z].id variables.{VARIABLE_NAME}_time $some_variable_for_moment}
			{CLEAR_VARIABLE some_variable_for_moment}
		[/then]
	[/if]
#enddef

#define ABILITY_MWC_GOLD_DEFENDER
    [resistance]
        id=gold defender
        add=25
        max_value=60
        #apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=-1000
            less_than=60
        [/filter_base_value]
        name= _ "gold defender"
        description= _ "Adjacent friendly units receive a +25% bonus to all resistances (up to a maximum of 60%)."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef

#define ABILITY_MWC_HEAVY_DEFENDER
    [resistance]
        id=heavy defender
        add=20
        max_value=60
        #apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=-1000
            less_than=60
        [/filter_base_value]
        name= _ "heavy defender"
        description= _ "Adjacent friendly units receive a +20% bonus to all resistances (up to a maximum of 60%)."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef

#define WEAPON_SPECIAL_01_FORGOTTEN_BEASTS
    [dummy]
        id=plague_forgotten_beasts_01
        name= _ "forgotten beasts plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Forgotten Beasts faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_FALLEN_LEGIONS
    [dummy]
        id=plague_fallen_legions_01
        name= _ "fallen legions plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Fallen Legions faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_CHOSEN_OF_MAGIC
    [dummy]
        id=plague_chosen_of_magic_01
        name= _ "chosen of magic plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Chosen Of Magic faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_DRAKES
    [dummy]
        id=plague_drakes_01
        name= _ "drakes plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Drakes faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_KNALGAN_ALLIANCE
    [dummy]
        id=plague_knalgan_alliance_01
        name= _ "knalgan alliance plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Knalgan Alliance faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_REBELS
    [dummy]
        id=plague_rebels_01
        name= _ "rebels plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Rebels faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_NORTHERNERS
    [dummy]
        id=plague_northerners_01
        name= _ "northerners plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Northerners faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_LOYALISTS
    [dummy]
        id=plague_loyalists_01
        name= _ "loyalists plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Loyalists faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef
#define WEAPON_SPECIAL_01_UNDEAD_PLAGUE
    [dummy]
        id=plague_undead_01
        name= _ "undead plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from udnead faction. This doesnt work on Undead or units in villages."
    [/dummy]
#enddef

#define WEAPON_SPECIAL_BERSERKSXRPG
    # Canned definition of the Berserk ability to be included in a
    # [specials] clause.
    [berserk]
        id=berserkss
        name= _ "berserk"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 15 rounds of attacks have occurred."
        value=15
        active_on=offense
    [/berserk]
#enddef

#define WEAPON_SPECIAL_BERSERKSXRPG2
    # Canned definition of the Berserk ability to be included in a
    # [specials] clause.
    [berserk]
        id=berserkss2
        name= _ "brutal berserk"
        description= _ "When used offensively, this attack presses the engagement until one of the combatants is slain, or 6 rounds of attacks have occurred. Both combatants deal 2.5 times more damage."
        value=6
        active_on=offense
    [/berserk]
    [damage]
        id=brutalsx
        multiply=2.5
        apply_to=both
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_DREAD2
	[damage]
		id=dread2
		name= _ "dreadful sight"
		name_inactive= _ "dreadful sight"
		description= _ "When this attack is used defensively, the attacker deals one third less damage." 
		description_inactive= _ "When this attack is used defensively, the attacker deals one third less damage."
		active_on=defense
		apply_to=opponent
		multiply=0.67
	[/damage]
#enddef

#define WEAPON_SPECIAL_SUPERIORITYS
   [chance_to_hit]
        id=superiority
        name= _ "superiority"
        description= _ "This attack always has at least a 60% chance to hit."
        value=60
        cumulative=yes
    [/chance_to_hit]
#enddef

#define WEAPON_SPECIAL_GUARDINGS
	[damage]
		id=guardings
		name= _ "vigilance"
        name_inactive= _ "vigilance"
		description= _ "when guarding this unit takes 3/4 damage" 
		active_on=defense
		apply_to=opponent
		multiply=0.75
	[/damage]
#enddef

#define WEAPON_SPECIAL_DEFENSIVE_GAINS
	[damage]
		id=defensive_gains
		name= _ "caution"
        name_inactive= _ "caution"
		description= _ "When this attack is used in defense the unit takes 25% less damage and deals 25% less damage" 
		active_on=defense
		apply_to=both
		multiply=0.75
	[/damage]
#enddef

#define WEAPON_SPECIAL_RAGE2
	[berserk]
		id=aggression2
		name= _ "aggression"
		description= _ "When used offensively, this attack presses the engagement until one of the combatants is slain, or 2 rounds of attacks have occurred."
		active_on=offense
		value=2
	[/berserk]
#enddef

#define WEAPON_SPECIAL_HAIL2
	[berserk]
		id=hail2
		name= _ "hail of arrows"
		description= _ "When used offensively, this attack presses the engagement until one of the combatants is slain, or 2 rounds of attacks have occurred."
		active_on=offense
		value=2
	[/berserk]
#enddef

#define WEAPON_SPECIAL_RAGE3
	[berserk]
		id=frenzy3
		name= _ "frenzy"
		description= _ "When used offensively, this attack presses the engagement until one of the combatants is slain, or 3 rounds of attacks have occurred."
		active_on=offense
		value=3
	[/berserk]
#enddef

#define WEAPON_SPECIAL_RAGE5
	[berserk]
		id=fury5
		name= _ "fury"
		description= _ "When used offensively, this attack presses the engagement until one of the combatants is slain, or 5 rounds of attacks have occurred."
		active_on=offense
		value=5
	[/berserk]
#enddef

#define WEAPON_SPECIAL_RETALIATIONS
    [chance_to_hit]
        id=retaliations
        name= _ "retaliation"
        description= _ "This attack always has a 70% chance to hit regardless of the defensive ability of the unit being attacked when used in defense."
        value=70
        cumulative=no
	  active_on=defense
    [/chance_to_hit]
#enddef

#define WEAPON_SPECIAL_OFFENSIVE_GAINS
	[damage]
		id=offensive_gains
		name= _ "brutality"
        name_inactive= _ "brutality"
		description= _ "When this attack is used in offense the unit deals 25% more damage and takes 25% more damage." 
		active_on=offense
		apply_to=both
		multiply=1.25
	[/damage]
#enddef

#define ABILITY_THE_GOBLINS_KING
    [dummy]
        id=the_goblins_king
        name= _ "the goblins king"
        female_name= _ "female^the goblins king"
        description=_ "This goblins king can convince all each adjected goblins at his own turn start, his chances depend of adjected goblins levels, lower levels are easier to change their side (it works for each adjected enemy goblins at each goblin king turn start). 100% for 0 lvl, 50% for 1 lvl, 25% for 2 lvl, 12.5% for 3 lvl, 6.25% for 4 lvl, 3.125% for 5 lvl goblin enemies (in each turn start of each goblin king side!!!)."
    [/dummy]
[/abilities]
[event]
    id=stealing_goblins_by_king
    name=side turn
    first_time_only=no
	[store_unit]
		[filter]
			ability=the_goblins_king
			side=$side_number
		[/filter]
		kill=no
		variable=stealing_goblin_king
	[/store_unit]
	{FOREACH stealing_goblin_king b}
		[store_unit]
			[filter]
				[filter_adjacent]
					#ability=the_goblins_king
					id=$stealing_goblin_king[$b].id
					is_enemy=yes
				[/filter_adjacent]
			[/filter]
			kill=no
			variable=stealed_goblins
		[/store_unit]
		{FOREACH stealed_goblins a}
			[set_variable]
				name=checked_level
				value=$stealed_goblins[$a].level
			[/set_variable]
			[switch]
				variable=checked_level
				[case]
					value=0
					[if]
						[variable]
							name=stealed_goblins[$a].race
							equals="goblin"
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_goblins[$a].x,$stealed_goblins[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=1
					[set_variable]
						name=random_goblin_king_value
						rand=1..2
					[/set_variable]
					[if]
						[variable]
							name=random_goblin_king_value
							equals=1
						[/variable]
						[and]
							[variable]
								name=stealed_goblins[$a].race
								equals="goblin"
							[/variable]
						[/and]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_goblins[$a].x,$stealed_goblins[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=2
					[set_variable]
						name=random_goblin_king_value
						rand=1..4
					[/set_variable]
					[if]
						[variable]
							name=random_goblin_king_value
							equals=1
						[/variable]
						[and]
							[variable]
								name=stealed_goblins[$a].race
								equals="goblin"
							[/variable]
						[/and]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_goblins[$a].x,$stealed_goblins[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=3
					[set_variable]
						name=random_goblin_king_value
						rand=1..8
					[/set_variable]
					[if]
						[variable]
							name=random_goblin_king_value
							equals=1
						[/variable]
						[and]
							[variable]
								name=stealed_goblins[$a].race
								equals="goblin"
							[/variable]
						[/and]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_goblins[$a].x,$stealed_goblins[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=4
					[set_variable]
						name=random_goblin_king_value
						rand=1..16
					[/set_variable]
					[if]
						[variable]
							name=random_goblin_king_value
							equals=1
						[/variable]
						[and]
							[variable]
								name=stealed_goblins[$a].race
								equals="goblin"
							[/variable]
						[/and]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_goblins[$a].x,$stealed_goblins[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=5
					[set_variable]
						name=random_goblin_king_value
						rand=1..32
					[/set_variable]
					[if]
						[variable]
							name=random_goblin_king_value
							equals=1
						[/variable]
						[and]
							[variable]
								name=stealed_goblins[$a].race
								equals="goblin"
							[/variable]
						[/and]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_goblins[$a].x,$stealed_goblins[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
			[/switch]
		{NEXT a}
		{CLEAR_VARIABLE stealed_goblins,checked_level,random_goblin_king_value}
	{NEXT b}
	{CLEAR_VARIABLE stealing_goblin_king}
[/event]
[+abilities]
#enddef

#define ABILITY_LATENT_CURES_VALUE VALUE
    # Canned definition of the cure ability (which entails heal+8) to be
    # included in an [abilities] clause..
    {ABILITY_LATENT_UNPOISON_VALUE {VALUE}}
    {ABILITY_LATENT_HEAL_VALUE {VALUE}}
#enddef


#define ABILITY_LATENT_UNPOISON_VALUE VALUE
    # Canned definition of the cure-poison ability to be included
    # in an [abilities] clause.
    [heals]
        affect_allies=yes
        id=curing_forced_{VALUE}
        name= _ "cures"
        female_name= _ "female^cures"
        description= _ "A curer can cure a unit of poison, although that unit will receive no additional healing on the turn it is cured of the poison."
        affect_self=no
        poison=cured
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
		[filter_self]
			[filter_adjacent]
				ability=healing_leadership_{VALUE}
			[/filter_adjacent]
		[/filter_self]
    [/heals]
#enddef


#define ABILITY_LATENT_HEAL_VALUE VALUE
    [heals]
        value={VALUE}
        id=healing_forced_{VALUE}
        affect_allies=yes
        name= _ "heals " + {VALUE}
        female_name= _ "female^heals " + {VALUE} + "hp"
        description= _ "This unit combines herbal remedies with magic to heal units more quickly than is normally possible on the battlefield. A unit cared for by this healer may heal up to " + {VALUE} + "HP per turn, or stop poison from taking effect for that turn. A poisoned unit cannot be cured of its poison by a healer, and must seek the care of a village or a unit that can cure."
        affect_self=no
        poison=slowed
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
		[filter_self]
			[filter_adjacent]
				ability=healing_leadership_{VALUE}
			[/filter_adjacent]
		[/filter_self]
    [/heals]
#enddef



#define ABILITY_MWC_HEALING_LEADERSHIP_VALUE VALUE
    [dummy]
        id=healing_leadership_{VALUE}
        name= _ "aura of healing (+" + {VALUE} +")"
        female_name= _ "female^aura of healing (+" + {VALUE} +")"
        description=_ "This unit can make adjected friendly units learn heals and cures skills, they can use them only in the vicinity of this unit."
    [/dummy]
#enddef

#define ABILITY_LATENT_SKIRMISHER
    # Canned definition of the Skirmisher ability to be included in an [abilities]
    # clause.
    [skirmisher]
        id=skirmisher_forced
        name= _ "skirmisher"
        female_name= _ "female^skirmisher"
        description= _ "This unit is skilled in moving past enemies quickly, and ignores all enemy Zones of Control."
        affect_self=yes
		[filter_self]
			[filter_adjacent]
				ability=skimirsher_leadership
			[/filter_adjacent]
		[/filter_self]
    [/skirmisher]
#enddef



#define ABILITY_MWC_SKIRMISHER_LEADERSHIP
    [dummy]
        id=skimirsher_leadership
        name= _ "aura of skirmisher"
        female_name= _ "female^aura of skirmisher"
        description=_ "This unit can inspire adjacent units to moves as human fencers or saurian skirmishers, all adjected friendly units (at turn start) gain ability to past enemies quickly, and ignores all enemy Zones of Control."
    [/dummy]
#enddef

#define WEAPON_SPECIAL_MWC_BLESSED_WEAKER
    [attacks]
        id=mwc_blessed_weaker
        name= _ "blessed weaker"
        description= _ "When used offensively, weaker blessed weapons do 1 more STRIKES than usual. This weapon special isn't activiated on defense."
        add=1
        apply_to=self
        active_on=offense
    [/attacks]
#enddef


#define WEAPON_SPECIAL_MWC_BLESSED
    [attacks]
        id=mwc_blessed
        name= _ "blessed"
        description= _ "When used offensively, weaker blessed weapons do 2 more STRIKES than usual. This weapon special isn't activiated on defense."
        add=2
        apply_to=self
        active_on=offense
    [/attacks]
#enddef


#define WEAPON_SPECIAL_MWC_BLESSED_STRONGER
    [attacks]
        id=mwc_blessed_stronger
        name= _ "blessed stronger"
        description= _ "When used offensively, stronger blessed weapons do 3 more STRIKES than usual. This weapon special isn't activiated on defense."
        add=3
        apply_to=self
        active_on=offense
    [/attacks]
#enddef

#define ABILITY_MWC_DESECRATION
    [heals]
        value=8
        id=mwc_desecration
        affect_allies=yes
        name= _ "desecration"
        description= _ "Allows the unit to desecrate adjacent friendly undead units at the beginning of each turn. A unit cared for by this healer may heal up to 8 HP per turn."
        affect_self=no
        poison=cured
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                race=undead
            [/filter]
        [/affect_adjacent]
    [/heals]
#enddef

#define ABILITY_MWC_DELLUMINATES
    # Canned definition of the Illuminates ability to be included in an
    # [abilities] clause.
    [illuminates]
        id=dellumination
        value=-25
        min_value=-25
        cumulative=no
        name= _ "delluminates"
        female_name= _ "female^delluminates"
        description= _ "This unit delluminates the surrounding area, making lawful units fight worse, and chaotic units fight better. Any units adjacent to this unit will fight as if it were night when it is dusk, and as if it were dusk when it is day."
        affect_self=yes
    [/illuminates]
#enddef

#define WEAPON_SPECIAL_WHIRLWIND
    [attacks]
        id=whirlwind
        name= _ "whirlwind"
        name_inactive= _ "whirlwind"
        description= _ "When this attack is used, all units adjacent the attacker take the half damage(max 15), and cannot be countered."
        cumulative=no
        active_on=offense
        value=0
        apply_to=opponent
    [/attacks]
#enddef

#define WEAPON_SPECIAL_MWC_GROWING_FURY
    [damage]
        id=growingfury
        name= _ "growing fury"
        name_inactive= _ "growing fury"
        description= _ "When this attack is used, this units damage increases after each successful hit (+3)."
    [/damage]
#enddef

#define WEAPON_SPECIAL_VICIOUS_VALUE VALUE
	[damage]
		id=vicious{VALUE}
		name=_"vicious " + {VALUE} +"dmg"
		description="+" + {VALUE} +" damage when attacking."
		add={VALUE}
		cumulative=yes
		active_on=offense
		apply_to=self
	[/damage]
#enddef


#define ABILITY_BLOODY_RULER_MWC
    [dummy]
        id=bloody_ruler_mwc
        name= _ "bloody ruler"
        female_name= _ "female^bloody ruler"
        description=_ "This unit has a scary leadership skills so that easy to convince the weaker enemies to betray their rulers (it works for each adjected enemy units at turn start). 100% for 0 lvl, 33,3% for 1 lvl, 16,7% for 2 lvl, 8,3% for 3 lvl, 4,2% for 4 lvl, 2,1% for 5 lvl enemies (in each turn start of this unit side!!!)."
    [/dummy]
#enddef

#define ABILITY_IRON_RULER
    [dummy]
        id=iron_ruler
        name= _ "iron ruler"
        female_name= _ "female^iron ruler"
        description=_ "This unit has a scary leadership skills so that easy to convince the weaker enemies to betray their rulers (it works for each adjected enemy units at turn start). 100% for 0 lvl, 25% for 1 lvl, 12.5% for 2 lvl, 6.25% for 3 lvl, 3.125% for 4 lvl, 1.5625% for 5 lvl enemies (in each turn start of this unit side!!!)."
    [/dummy]
[/abilities]
[event]
    id=stealing_enemies
    name=side turn
    first_time_only=no
	[store_unit]
		[filter]
			ability=iron_ruler
			side=$side_number
		[/filter]
		kill=no
		variable=stealing_unit
	[/store_unit]
	{FOREACH stealing_unit b}
		[store_unit]
			[filter]
				[filter_adjacent]
					#ability=iron_ruler
					id=$stealing_unit[$b].id
					is_enemy=yes
				[/filter_adjacent]
			[/filter]
			kill=no
			variable=stealed_enemies
		[/store_unit]
		{FOREACH stealed_enemies a}
			[set_variable]
				name=checked_level
				value=$stealed_enemies[$a].level
			[/set_variable]
			[switch]
				variable=checked_level
				[case]
					value=0
					[modify_unit]
						[filter]
							x,y=$stealed_enemies[$a].x,$stealed_enemies[$a].y
						[/filter]
						side=$side_number
					[/modify_unit]
				[/case]
				[case]
					value=1
					[set_variable]
						name=random_iron_value
						rand=1..4
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies[$a].x,$stealed_enemies[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=2
					[set_variable]
						name=random_iron_value
						rand=1..8
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies[$a].x,$stealed_enemies[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=3
					[set_variable]
						name=random_iron_value
						rand=1..16
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies[$a].x,$stealed_enemies[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=4
					[set_variable]
						name=random_iron_value
						rand=1..32
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies[$a].x,$stealed_enemies[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=5
					[set_variable]
						name=random_iron_value
						rand=1..64
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies[$a].x,$stealed_enemies[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
			[/switch]
		{NEXT a}
		{CLEAR_VARIABLE stealed_enemies,checked_level,random_iron_value}
	{NEXT b}
	{CLEAR_VARIABLE stealing_unit}
[/event]
[+abilities]
#enddef

#define ABILITY_MWC_MAGICAL_POWERS
    [dummy]
        id=magical_powers
        name= _ "magical powers"
        female_name= _ "female^magical powers"
        description= _ "This unit have 30% to in each turn make stronger adjected units by adding them more hit points, more damage points to their attacks, more movement points, increasing resistances, or adding new attacks."
    [/dummy]
#enddef

#define ABILITY_MWC_POWERS_OF_NATURE
    [dummy]
        id=powers_of_nature
        name= _ "powers of nature"
        female_name= _ "female^powers of nature"
        description= _ "This unit have 10% to in each turn make stronger adjected units by adding them more hit points, more damage points to their attacks, more movement points, increasing resistances, or adding new attacks."
    [/dummy]
[/abilities]
[event]
    id=powers_of_nature_event
    name=side turn
    first_time_only=no
	[store_unit]
		[filter]
			ability=powers_of_nature
			side=$side_number
		[/filter]
		kill=no
		variable=powers_of_nature_owner
	[/store_unit]
	{FOREACH powers_of_nature_owner j}
		[store_unit]
			[filter]
				[filter_adjacent]
					id=$powers_of_nature_owner[$j].id
					is_enemy=no
				[/filter_adjacent]	
			[/filter]
			kill=no
			variable=powers_of_nature_units
		[/store_unit]
		{FOREACH powers_of_nature_units i}
		[set_variable]
			name=some_random
			rand=1..10
		[/set_variable]
		[if]
			[variable]
				name=some_random
				less_than=2
			[/variable]
			[then]
				[set_variable]
					name=some_random_2
					rand=1..100
				[/set_variable]
				[switch]
					variable=some_random_2
					[case]
						value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40
						[set_variable]
							name=some_random_3
							rand=1..30
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=2
										increase_total=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=16,17,18,19,20,21,22,23,24
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=4
										increase_total=4
									[/effect]
								[/object]
							[/case]
							[case]
								value=25,26,27
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=6
										increase_total=6
									[/effect]
								[/object]
							[/case]
							[case]
								value=28,29
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=8
										increase_total=8
									[/effect]
								[/object]
							[/case]
							[case]
								value=30
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=10
										increase_total=10
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64
						[set_variable]
							name=some_random_3
							rand=1..40
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=16,17,18,19,20,21,22,23
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=24,25,26
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=27,28
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=29
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=30,31,32
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.cold
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.fire
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.arcane
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=33,34,35
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.pierce
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.blade
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.impact
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=36,37
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.cold
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.fire
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.arcane
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=38,39
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.pierce
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.blade
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.impact
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=40
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.cold
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.fire
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.arcane
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.pierce
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.blade
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.impact
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
						[/switch]
					[/case]
					[case]
						value=65,66,67,68,69,70,71,72,73,74,75,76
						[set_variable]
							name=some_random_3
							rand=1..10
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=7,8,9
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=10
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=3
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=77,78,79,80
						[set_variable]
							name=some_random_3
							rand=1..2
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_attacks=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=2
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_attacks=1
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=81,82,83,84,85,86,87,88,89,90,91,92
						[set_variable]
							name=some_random_3
							rand=1..10
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_damage=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=5,6,7,8
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_damage=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=9
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_damage=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=10
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_damage=2
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=93,94,95,96,97,98,99,100
						[set_variable]
							name=some_random_3
							rand=1..4
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack1a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack1b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack1c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack1d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack1e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack1f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack2a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack2b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack2c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack2d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack2e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack2f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=2
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack3a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack3b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack3c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack3d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack3e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack3f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack4a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack4b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack4c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack4d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack4e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack4f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=3
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack5a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack5b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack5c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack5d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack5e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack5f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack6a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack6b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack6c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack6d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack6e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack6f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=4
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack7a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack7b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack7c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack7d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack7e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack7f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack8a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack8b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack8c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack8d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack8e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack8f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
						[/switch]
					[/case]
				[/switch]
			[/then]
		[/if]
		[clear_variable]
			name=some_random,some_random_2,some_random_3,some_random_4,some_random_5
		[/clear_variable]
		{CLEAR_VARIABLE powers_of_nature_units[$i].underlying_id,powers_of_nature_units[$i].id}    
		{NEXT i}
		{CLEAR_VARIABLE powers_of_nature_units}
		[unstore_unit]
			variable=powers_of_nature_owner[$j]
			find_vacant=no
		[/unstore_unit]
	{NEXT j}
	{CLEAR_VARIABLE powers_of_nature_owner}
[/event]
[+abilities]
#enddef


#define ABILITY_MWC_REGENERATES_20%
    [dummy]
        id=regenerates 20%
        name= _ "regenerates 20% of max hp"
        female_name= _ "female^regenerates 20% of max hp"
        description= _ "The unit will heal itself 20% of max hp per turn. If it is poisoned, it will remove the poison instead of healing."
    [/dummy]
#enddef


# wmllint: unbalanced-on
#define ABILITY_FEEDING_2
    # Canned definition of the Feeding ability to be included in an
    # [abilities] clause.  Note: this is deliberately unbalanced WML,
    # in order to close the abilities clause then insert the event
    # then reopen the abilities clause.
    [dummy]
        id=feeding 2
        name= _ "feeding 2"
        female_name= _ "female^feeding 2"
        description=_ "This unit gains 2 hitpoint added to its maximum whenever it kills a living unit."
    [/dummy] # a hack to please wmlxgettext (using a bug in wmlxgettext!): dummy tag start: [abilities]
[/abilities]
[event]
    id=ability_feeding_2_die
    name=die
    first_time_only=no

    [filter]
        [not]
            [filter_wml]
                [status]
                    not_living="yes"
                [/status]
            [/filter_wml]
        [/not]
    [/filter]

    [filter_second]
        ability=feeding 2
    [/filter_second]

    [unstore_unit]
        variable=second_unit
        {COLOR_HEAL}
        text= _ "+2 max HP"
        find_vacant=no
    [/unstore_unit]

    [object]
        silent=yes
        duration=forever

        [filter]
            x,y=$x2,$y2
        [/filter]

        [effect]
            apply_to=hitpoints
            increase_total=2
            increase=2
        [/effect]
    [/object]
[/event]
[+abilities] # a hack to please wmlxgettext (using a bug in wmlxgettext!): dummy tag end: [/abilities]
#enddef
# wmllint: unbalanced-off

#define ABILITY_SNOW_COVER
    [hides]
        id=snow_cover
        name= _ "snow cover"
        female_name= _ "female^snow cover"
        description= _ "Snow Cover: this unit is invisible when standing on snow."
        affect_self=yes
        [filter_self]
            [filter_location]
                terrain=Ai*,Ai^*,Aa*,Aa^*,Ha*,Ha^*,Ms*,Ms^*,Cea*,Cea^*,Kea*,Kea^*,Cha*,Cha^*,Coa*,Coa^*
            [/filter_location]
        [/filter_self]
    [/hides]
#enddef

#define ABILITY_FROZENHOME_VALUE VALUE
    [regenerate]
        [filter_self]
            [filter_location]
                terrain=Ai*,Ai^*,Aa*,Aa^*,Ha*,Ha^*,Ms*,Ms^*,Cea*,Cea^*,Kea*,Kea^*,Cha*,Cha^*,Coa*,Coa^*
            [/filter_location]
        [/filter_self]
        value={VALUE}
        id=frozen_regenerates{VALUE}
        name= _ "frozen " + {VALUE} + "hp"
        description= _ "This unit will regenerate " + {VALUE} + "hp when in frozen, snow, ice terrain."
        name_inactive= _ "frozen " + {VALUE} + "hp"
        description_inactive= _ "This unit will regenerate " + {VALUE} + " hp when in frozen, snow, ice terrain."
        affect_self=yes
    [/regenerate] 
#enddef

#define ABILITY_MWC_DEFENDER
    [resistance]
        id=defender
        add=15
        max_value=60
        #apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=-1000
            less_than=60
        [/filter_base_value]
        name= _ "defender"
        description= _ "Adjacent friendly units receive a +15% bonus to all resistances (up to a maximum of 60%)."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef

#define KIRIOS_OPPOSITE_SIDE CENTER_X CENTER_Y X Y VAR
    {VARIABLE x_odd {X}}

    {VARIABLE_OP x_odd modulo 2}

    {VARIABLE c_x {CENTER_X}}
    {VARIABLE c_y {CENTER_Y}}
    {VARIABLE s_x {X}}
    {VARIABLE s_y {Y}}

    {VARIABLE result_x {CENTER_X}}
    {VARIABLE result_y {CENTER_Y}}

    {IF_VAR s_x greater_than $c_x (
        [then]
            {VARIABLE_OP result_x add -1}
        [/then]
    )}

    {IF_VAR s_x less_than $c_x (
        [then]
            {VARIABLE_OP result_x add 1}
        [/then]
    )}

    {IF_VAR s_x equals $c_x (
        [then]
            {IF_VAR s_y less_than $c_y (
                [then]
                    {VARIABLE_OP result_y add 1}
                [/then]
            )}

            {IF_VAR s_y greater_than $c_y (
                [then]
                    {VARIABLE_OP result_y add -1}
                [/then]
            )}
        [/then]
    )}

    {IF_VAR x_odd equals 1 (
        [then]
            {IF_VAR s_y equals $c_y (
                [then]
                    {VARIABLE_OP result_y add 1}
                [/then]
            )}
        [/then]

        [else]
            {IF_VAR s_y equals $c_y (
                [then]
                    {VARIABLE_OP result_y add -1}
                [/then]
            )}
        [/else]
    )}
    {VARIABLE {VAR}.x $result_x}
    {VARIABLE {VAR}.y $result_y}

    {CLEAR_VARIABLE c_x}
    {CLEAR_VARIABLE c_y}
    {CLEAR_VARIABLE s_x}
    {CLEAR_VARIABLE s_y}
    {CLEAR_VARIABLE result_x}
    {CLEAR_VARIABLE result_y}
    {CLEAR_VARIABLE x_odd}
#enddef

#define KIRIOS_BEAM WEAPON DMG
    [event]
        name=attacker hits
        first_time_only=no

        [filter_attack]
            name={WEAPON}
        [/filter_attack]

        {KIRIOS_OPPOSITE_SIDE $x2 $y2 $x1 $y1 target_hex}

        [store_unit]
            [filter]
                x,y=$target_hex.x,$target_hex.y
            [/filter]
            variable=third
        [/store_unit]

        [if]
            [variable]
                name=third.hitpoints
                less_than_equal_to={DMG}
            [/variable]
            [then]
                [if]
                    [have_unit]
                        x=$third.x
                        y=$third.y
                    [/have_unit]
                    [then]
                        [unstore_unit]
                            variable=third
                            {COLOR_HARM}
                            text="{DMG}"
                        [/unstore_unit]
                        [kill]
                            x=$third.x
                            y=$third.y
                            fire_event=yes
                            animate=yes
                        [/kill]
                    [/then]
                [/if]
            [/then]
            [else]
                {VARIABLE dmgpuffer {DMG}}
                {VARIABLE_OP dmgpuffer multiply -1}
                {VARIABLE_OP third.hitpoints add $dmgpuffer}
                [unstore_unit]
                    variable=third
                    {COLOR_HARM}
                    text="{DMG}"
                [/unstore_unit]
            [/else]
        [/if]

        {CLEAR_VARIABLE target_hex}
        {CLEAR_VARIABLE third}
    [/event]
#enddef



#define MWC_ABILITY_ENERGY_DRAINING EXPERIENCE
# wmlxgettext: [abilities]
    [energy_draining]
        id=energy_draining
        name=_ "energy draining"
        description=_ "This unit won't advance by training his combat skills and magical influence. It'll only get experience by draining the energy of a magical or living object. Therefore this unit won't get experience in another way than killing."
    [/energy_draining]
[/abilities]
[event]
    name=start
    [store_unit]
        [filter]
        [/filter]
        variable=unit
    [/store_unit]
    {FOREACH unit a}
        [fire_event]
            name=Mwc_appear
            [primary_unit]
                x,y=$unit.x,$unit.y
            [/primary_unit]
        [/fire_event]
    {NEXT a}
    [clear_variable]
        name=unit
    [/clear_variable]
[/event]
[event]
    name=prerecruit
    first_time_only=no
    [fire_event]
        name=Mwc_appear
        [primary_unit]
            x,y=$x1,$y1
        [/primary_unit]
    [/fire_event]
[/event]
[event]
    name=prerecall
    first_time_only=no
    [fire_event]
        name=Mwc_appear
        [primary_unit]
            x,y=$x1,$y1
        [/primary_unit]
    [/fire_event]
[/event]
[event]
    name=post advance
    first_time_only=no
    [fire_event]
        name=Mwc_appear
        [primary_unit]
            x,y=$x1,$y1
        [/primary_unit]
    [/fire_event]
[/event]
[event]
    name=Mwc_appear
    [filter]
        ability=energy_draining
    [/filter]
    {VARIABLE unit.max_experience "{EXPERIENCE}"}
    [unstore_unit]
        variable=unit
    [/unstore_unit]
[/event]

[event]
    name=attack_end
    first_time_only=no
    [filter]
        ability=energy_draining
    [/filter]
    {VARIABLE_OP unit.experience sub $second_unit.level}
    [unstore_unit]
        variable=unit
    [/unstore_unit]
[/event]

[event]
    name=attack_end
    first_time_only=no
    [filter_second]
        ability=energy_draining
    [/filter_second]
    {VARIABLE_OP second_unit.experience sub $unit.level}
    [unstore_unit]
        variable=second_unit
    [/unstore_unit]
[/event]

[event]
    name=die
    first_time_only=no
    [filter_second]
        ability=energy_draining
    [/filter_second]
    {VARIABLE_OP second_unit.experience add $unit.level}
    [unstore_unit]
        variable=second_unit
    [/unstore_unit]
[/event]
[+abilities]
# wmlxgettext: [/abilities]
#enddef





#define WEAPON_SPECIAL_MWC_REVENGE
    [chance_to_hit]
        id=Mwc_revenge
        value=100
        cumulative=no
        active_on=defense
        apply_to=self
    [/chance_to_hit]
    [chance_to_hit]
        id=Mwc_revenge
        name= _ "revenge"
        description= _ "The unit has always a 100% chance to hit, during retalitation."
        cumulative=no
        apply_to=self
    [/chance_to_hit]
#enddef

#define ABILITY_REGENERATES_12
    # Canned definition of the Regenerate ability to be included in an [abilities]
    # clause.
    [regenerate]
        value=12
        id=regenerates_12
        name= _ "regenerates 12"
        female_name= _ "female^regenerates 12"
        description= _ "The unit will heal itself 12 HP per turn. If it is poisoned, it will remove the poison instead of healing."
        affect_self=yes
        poison=cured
    [/regenerate]
#enddef

#define ABILITY_REGENERATES_VALUE VALUE
    [regenerate]
        value={VALUE}
        id=regenerates{VALUE}
        name= _ "regenerates " + {VALUE} + "hp"
        description= _ "The unit will heal itself " + {VALUE} + _ " HP per turn. If it is poisoned, it will remove the poison instead of healing."
        affect_self=yes
        poison=cured
    [/regenerate]
#enddef


#define ABILITY_EXTRA_HEAL_VALUE VALUE
    [heals]
        value={VALUE}
        id=healing_{VALUE}
        affect_allies=yes
        name= _ "heals " + {VALUE}
        female_name= _ "female^heals " + {VALUE} + "hp"
        description= _ "This unit combines herbal remedies with magic to heal units more quickly than is normally possible on the battlefield. A unit cared for by this healer may heal up to " + {VALUE} + "HP per turn, or stop poison from taking effect for that turn. A poisoned unit cannot be cured of its poison by a healer, and must seek the care of a village or a unit that can cure."
        affect_self=no
        poison=slowed
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/heals]
#enddef

#define WEAPON_SPECIAL_CIRCLE
    [chance_to_hit]
        id=circle
        name= _ "always hits"
        description= _ "This attack always has a 100% chance to hit"
        value=100
        cumulative=no
    [/chance_to_hit]
#enddef

#define ABILITY_MWC_CAVEAMBUSH
    [hides]
        id=caveambush
        name= _ "cave ambush"
        name_inactive= _ "cave ambush"
        description= _ "This unit can hide in cave, and remain undetected by its enemies. Enemy units cannot see this unit while it is in cave, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        description_inactive= _ "This unit can hide in cave, and remain undetected by its enemies. Enemy units cannot see this unit while it is in cave, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        affect_self=yes
        [filter_self]
            [filter_location]
                terrain=U*,U^*
            [/filter_location]
        [/filter_self]
    [/hides]
#enddef




#define ABILITY_MWC_DARKAURA
    [leadership]
        id=mwc_darkaura
        value=-35
        cumulative=yes
        name= _ "dark aura"
        description= _ "Dark aura makes all enemy units fight worse (-35% for attack)."
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/leadership]
#enddef


#define WEAPON_SPECIAL_EVASION
    [damage]
        id=evasion
        name= _ "evasion"
        name_inactive= _ "evasion"
        description= _ "When this attack is used offensively, this unit takes one third less damage in retaliation." 
        description_inactive= _ "When this attack is used offensively, this unit takes one third less damage in retaliation."
        active_on=offense
        apply_to=opponent
        multiply=0.66
    [/damage]
#enddef


#define WEAPON_SPECIAL_MAGICAL_PRECISION
    # Canned definition of the precision (targeting) ability to be included in a
    # [specials] clause.
    [chance_to_hit]
        id=magical precision
        name= _ "magical precision"
        description= _ "This attack always has a 80% chance to hit regardless of the defensive ability of the unit being attacked."
        value=80
        cumulative=no
    [/chance_to_hit]
#enddef

#define ABILITY_MWC_FREEZING_AURA
	[dummy]
		id=freezing aura
		name= _ "freezing aura"
		female_name= _ "female^freezing aura"
		description= _ "All adjacent units except units of the same side as this unit will be slowed at the beginning of their turn."
		affect_self=no
	[/dummy]
#enddef

#define PK_ABILITY_MWC_FURY
    [dummy]
        id=fury_mwc
        name= _ "fury"
        description= _ "This unit gains all 2 moves back and can attack another after killing an enemy."
    [/dummy]
#enddef

#define WEAPON_SPECIAL_SHOCKWAVE
   [slow]
        id=shockwave
        name= _ "shockwave"
        description= _ "This attack is so strong that it slows the target, and creates a shock wave that knocks all units adjacent to the attacker back, slows them too and damages them for 10 impact damage. Works only offensively."
    [/slow]
#enddef

#define WEAPON_SPECIAL_LATENT_PLAGUE
    [plague]
        id=plague forced
        name= _ "plague"
        description= _ "When a unit is killed by a Plague attack, that unit is replaced with a Walking Corpse on the same side as the unit with the Plague attack. This doesn't work on Undead or units in villages."
        type=Mwc_Walking Corpse
		[filter_self]
			[filter_adjacent]
				ability=plague leadership
			[/filter_adjacent]
		[/filter_self]
    [/plague]
#enddef

#define WEAPON_SPECIAL_LATENT_POISON
    [poison]
        id=poison forced
        name= _ "poison"
        description= _ "This attack poisons living targets. Poisoned units lose 8 HP every turn until they are cured or are reduced to 1 HP. Poison can not, of itself, kill a unit."
		[filter_self]
			[filter_adjacent]
				ability=poison leadership
			[/filter_adjacent]
		[/filter_self]
    [/poison]
#enddef


#define WEAPON_SPECIAL_LATENT_WEAKER_FURY
    [berserk]
        id=weaker fury forced
        name= _ "weaker fury"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 5 rounds of attacks have occurred."
        value=5
		active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=weaker fury leadership
			[/filter_adjacent]
		[/filter_self]
    [/berserk]
#enddef

#define WEAPON_SPECIAL_LATENT_FURY
    [berserk]
        id=fury forced
        name= _ "fury"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 10 rounds of attacks have occurred."
        value=10
		active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=fury leadership
			[/filter_adjacent]
		[/filter_self]
    [/berserk]
#enddef


#define WEAPON_SPECIAL_LATENT_STRONGER_FURY
    [berserk]
        id=stronger fury forced
        name= _ "stronger fury"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 15 rounds of attacks have occurred."
        value=15
		active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=stronger fury leadership
			[/filter_adjacent]
		[/filter_self]
    [/berserk]
#enddef


#define WEAPON_SPECIAL_WEAKER_FURY
    [berserk]
        id=weaker fury
        name= _ "weaker fury"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 5 rounds of attacks have occurred."
        value=5
		active_on=offense
    [/berserk]
#enddef

#define WEAPON_SPECIAL_FURY
    [berserk]
        id=fury
        name= _ "fury"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 10 rounds of attacks have occurred."
        value=10
		active_on=offense
    [/berserk]
#enddef


#define WEAPON_SPECIAL_STRONGER_FURY
    [berserk]
        id=stronger fury
        name= _ "stronger fury"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 15 rounds of attacks have occurred."
        value=15
		active_on=offense
    [/berserk]
#enddef


#define WEAPON_SPECIAL_LATENT_BERSERK
    [berserk]
        id=berserk forced
        name= _ "berserk"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 30 rounds of attacks have occurred."
        value=30
		active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=berserk leadership
			[/filter_adjacent]
		[/filter_self]
    [/berserk]
#enddef






#define WEAPON_SPECIAL_LATENT_MARKSMAN
    [chance_to_hit]
        id=marksman forced
        name= _ "marksman"
        description= _ "When used offensively, this attack always has at least a 60% chance to hit."
        value=60
        cumulative=yes
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=marksman leadership
			[/filter_adjacent]
		[/filter_self]
    [/chance_to_hit]
#enddef


#define WEAPON_SPECIAL_LATENT_WEAKER_BACKSTAB
    [damage]
        id=weaker backstab forced
        name= _ "weaker backstab"
        description= _ "When used offensively, this attack deals x1.5 damage more if there is an enemy of the target on the opposite side of the target, and that unit is not incapacitated (turned to stone or otherwise paralyzed)."
        multiply=1.5
        backstab=yes
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=weaker backstab leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_BACKSTAB
    [damage]
        id=backstab forced
        name= _ "backstab"
        description= _ "When used offensively, this attack deals double damage if there is an enemy of the target on the opposite side of the target, and that unit is not incapacitated (turned to stone or otherwise paralyzed)."
        multiply=2
        backstab=yes
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=backstab leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_STRONGER_BACKSTAB
    [damage]
        id=stronger backstab forced
        name= _ "stronger backstab"
        description= _ "When used offensively, this attack deals x2.5 damage more if there is an enemy of the target on the opposite side of the target, and that unit is not incapacitated (turned to stone or otherwise paralyzed)."
        multiply=2.5
        backstab=yes
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=stronger backstab leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef



#define WEAPON_SPECIAL_LATENT_SLOW_MELEE
    [slow]
        id=slow forced melee
        name= _ "slows"
        description= _ "This attack slows the target until it ends a turn. Slow halves the damage caused by attacks and the movement cost for a slowed unit is doubled. A unit that is slowed will feature a snail icon in its sidebar information when it is selected."
		[filter_self]
			[filter_adjacent]
				ability=slow leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/slow]
#enddef

#define WEAPON_SPECIAL_LATENT_SLOW_RANGED
    [slow]
        id=slow forced ranged
        name= _ "slows"
        description= _ "This attack slows the target until it ends a turn. Slow halves the damage caused by attacks and the movement cost for a slowed unit is doubled. A unit that is slowed will feature a snail icon in its sidebar information when it is selected."
		[filter_self]
			[filter_adjacent]
				ability=slow leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/slow]
#enddef



#define WEAPON_SPECIAL_LATENT_MAGICAL_MELEE
    [chance_to_hit]
        id=magical forced melee
        name= _ "magical"
        description= _ "This attack always has a 70% chance to hit regardless of the defensive ability of the unit being attacked."
        value=70
        cumulative=no
		[filter_self]
			[filter_adjacent]
				ability=magical leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/chance_to_hit]
#enddef


#define WEAPON_SPECIAL_LATENT_MAGICAL_RANGED
    [chance_to_hit]
        id=magical forced ranged
        name= _ "magical"
        description= _ "This attack always has a 70% chance to hit regardless of the defensive ability of the unit being attacked."
        value=70
        cumulative=no
		[filter_self]
			[filter_adjacent]
				ability=magical leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/chance_to_hit]
#enddef


#define WEAPON_SPECIAL_MWC_HORROR
    [damage]
        id=mwc_horror
        multiply=0.6
        apply_to=defender
        active_on=offense
    [/damage]
    [damage]
        id=mwc_horror
        name= _ "horror"
        description= _ "When this unit is melee attacking, the defender's damage is reduced by 40%."
        multiply=1
        apply_to=attacker
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_WEAKER_HORROR_MELEE
    [damage]
        id=weaker horror forced melee
        multiply=0.7
        apply_to=defender
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=weaker horror leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker horror forced melee
        name= _ "weaker horror"
        description= _ "When this unit is melee attacking, the defender's damage is reduced by 30%."
        multiply=1
        apply_to=attacker
		[filter_self]
			[filter_adjacent]
				ability=weaker horror leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_HORROR_MELEE
    [damage]
        id=horror forced melee
        multiply=0.6
        apply_to=defender
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=horror leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=horror forced melee
        name= _ "horror"
        description= _ "When this unit is melee attacking, the defender's damage is reduced by 40%."
        multiply=1
        apply_to=attacker
		[filter_self]
			[filter_adjacent]
				ability=horror leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_STRONGER_HORROR_MELEE
    [damage]
        id=stronger horror forced melee
        multiply=0.5
        apply_to=defender
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=stronger horror leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger horror forced melee
        name= _ "stronger horror"
        description= _ "When this unit is melee attacking, the defender's damage is reduced by 50%."
        multiply=1
        apply_to=attacker
		[filter_self]
			[filter_adjacent]
				ability=stronger horror leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_WEAKER_HORROR_RANGED
    [damage]
        id=weaker horror forced ranged
        multiply=0.7
        apply_to=defender
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=weaker horror leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker horror forced ranged
        name= _ "weaker horror"
        description= _ "When this unit is ranged attacking, the defender's damage is reduced by 30%."
        multiply=1
        apply_to=attacker
		[filter_self]
			[filter_adjacent]
				ability=weaker horror leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_HORROR_RANGED
    [damage]
        id=horror forced ranged
        multiply=0.6
        apply_to=defender
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=horror leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=horror forced ranged
        name= _ "horror"
        description= _ "When this unit is ranged attacking, the defender's damage is reduced by 40%."
        multiply=1
        apply_to=attacker
		[filter_self]
			[filter_adjacent]
				ability=horror leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_STRONGER_HORROR_RANGED
    [damage]
        id=stronger horror forced ranged
        multiply=0.5
        apply_to=defender
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=stronger horror leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger horror forced ranged
        name= _ "stronger horror"
        description= _ "When this unit is ranged attacking, the defender's damage is reduced by 50%."
        multiply=1
        apply_to=attacker
		[filter_self]
			[filter_adjacent]
				ability=stronger horror leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_STRONGER_VICIOUS_MELEE
	[damage]
		id=stronger vicious forced melee
		name= _ "stronger vicious - 6 dmg"
		description= _ "When used offensively, this attack deals 6 damage more."
		add=6
		cumulative=yes
		active_on=offense
		apply_to=self
		[filter_self]
			[filter_adjacent]
				ability=stronger vicious leadership melee
			[/filter_adjacent]
		[/filter_self]
	[/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_VICIOUS_MELEE
	[damage]
		id=vicious forced melee
		name= _ "vicious - 4 dmg"
		description= _ "When used offensively, this attack deals 4 damage more."
		add=4
		cumulative=yes
		active_on=offense
		apply_to=self
		[filter_self]
			[filter_adjacent]
				ability=vicious leadership melee
			[/filter_adjacent]
		[/filter_self]
	[/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_WEAKER_VICIOUS_MELEE
	[damage]
		id=weaker vicious forced melee
		name= _ "weaker vicious - 2 dmg"
		description= _ "When used offensively, this attack deals 2 damage more."
		add=2
		cumulative=yes
		active_on=offense
		apply_to=self
		[filter_self]
			[filter_adjacent]
				ability=weaker vicious leadership melee
			[/filter_adjacent]
		[/filter_self]
	[/damage]
#enddef



#define WEAPON_SPECIAL_LATENT_STRONGER_VICIOUS_RANGED
	[damage]
		id=stronger vicious forced ranged
		name= _ "stronger vicious - 6 dmg"
		description= _ "When used offensively, this attack deals 6 damage more."
		add=6
		cumulative=yes
		active_on=offense
		apply_to=self
		[filter_self]
			[filter_adjacent]
				ability=stronger vicious leadership ranged
			[/filter_adjacent]
		[/filter_self]
	[/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_VICIOUS_RANGED
	[damage]
		id=vicious forced ranged
		name= _ "vicious - 4 dmg"
		description= _ "When used offensively, this attack deals 4 damage more."
		add=4
		cumulative=yes
		active_on=offense
		apply_to=self
		[filter_self]
			[filter_adjacent]
				ability=vicious leadership ranged
			[/filter_adjacent]
		[/filter_self]
	[/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_WEAKER_VICIOUS_RANGED
	[damage]
		id=weaker vicious forced ranged
		name= _ "weaker vicious - 2 dmg"
		description= _ "When used offensively, this attack deals 2 damage more."
		add=2
		cumulative=yes
		active_on=offense
		apply_to=self
		[filter_self]
			[filter_adjacent]
				ability=weaker vicious leadership ranged
			[/filter_adjacent]
		[/filter_self]
	[/damage]
#enddef


#define WEAPON_SPECIAL_WEAKER_FOCUS
    [damage]
        id=weaker focus
        name= _ "weaker focus"
        description= _ "When used offensively, this attack deals x1.25 damage more to the target. It also causes this unit to take x1.25 damage more from the target's counterattack."
        multiply=1.25
        apply_to=both
        active_on=offense
    [/damage]
#enddef


#define WEAPON_SPECIAL_FOCUS
    [damage]
        id=focus
        name= _ "focus"
        description= _ "When used offensively, this attack deals x1.5 damage more to the target. It also causes this unit to take x1.5 damage more from the target's counterattack."
        multiply=1.5
        apply_to=both
        active_on=offense
    [/damage]
#enddef


#define WEAPON_SPECIAL_STRONGER_FOCUS
    [damage]
        id=stronger focus
        name= _ "stronger focus"
        description= _ "When used offensively, this attack deals x1.75 damage more to the target. It also causes this unit to take x1.75 damage more from the target's counterattack."
        multiply=1.75
        apply_to=both
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_WEAKER_FOCUS
    [damage]
        id=weaker focus forced
        name= _ "weaker focus"
        description= _ "When used offensively, this attack deals x1.25 damage more to the target. It also causes this unit to take x1.25 damage more from the target's counterattack."
        multiply=1.25
        apply_to=both
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=weaker focus leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef



#define WEAPON_SPECIAL_LATENT_FOCUS
    [damage]
        id=focus forced
        name= _ "focus"
        description= _ "When used offensively, this attack deals x1.5 damage more to the target. It also causes this unit to take x1.5 damage more from the target's counterattack."
        multiply=1.50
        apply_to=both
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=focus leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef



#define WEAPON_SPECIAL_LATENT_STRONGER_FOCUS
    [damage]
        id=stronger focus forced
        name= _ "stronger focus"
        description= _ "When used offensively, this attack deals x1.75 damage more to the target. It also causes this unit to take x1.75 damage more from the target's counterattack."
        multiply=1.75
        apply_to=both
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=stronger focus leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_WEAKER_CHARGE
    [damage]
        id=weaker charge forced
        name= _ "weaker charge"
        description= _ "When used offensively, this attack deals x1.5 damage more to the target. It also causes this unit to take x1.5 damage more from the target's counterattack."
        multiply=1.5
        apply_to=both
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=weaker charge leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef




#define WEAPON_SPECIAL_LATENT_CHARGE
    [damage]
        id=charge forced
        name= _ "charge"
        description= _ "When used offensively, this attack deals double damage to the target. It also causes this unit to take double damage from the target's counterattack."
        multiply=2
        apply_to=both
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=charge leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_STRONGER_CHARGE
    [damage]
        id=stronger charge forced
        name= _ "stronger charge"
        description= _ "When used offensively, this attack deals x2.5 damage more to the target. It also causes this unit to take x2.5 damage more from the target's counterattack."
        multiply=2.5
        apply_to=both
        active_on=offense
		[filter_self]
			[filter_adjacent]
				ability=stronger charge leadership
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_FIRSTSTRIKE
    [firststrike]
        id=firststrike forced
        name= _ "firststrike"
        description= _ "This unit always strikes first with this attack, even if they are defending."
	[filter_self]
		[filter_adjacent]
			ability=firststrike leadership
		[/filter_adjacent]
	[/filter_self]
    [/firststrike]
#enddef

#define WEAPON_SPECIAL_LATENT_DRAIN_MELEE
    [drains]
        id=drain forced melee
        name= _ "drains"
        description= _ "This unit drains health from living units, healing itself for half the amount of damage it deals (rounded down)."
		[filter_self]
			[filter_adjacent]
				ability=drain leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/drains]
#enddef


#define WEAPON_SPECIAL_LATENT_DRAIN_RANGED
    [drains]
        id=drain forced ranged
        name= _ "drains"
        description= _ "This unit drains health from living units, healing itself for half the amount of damage it deals (rounded down)."
		[filter_self]
			[filter_adjacent]
				ability=drain leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/drains]
#enddef


#define WEAPON_SPECIAL_LATENT_WEAKER_HOLY_MELEE
    [damage]
        id=weaker holy forced melee
        multiply=1.35
        apply_to=self
        [filter_opponent]
			race=undead
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker holy forced melee
        multiply=1.35
        apply_to=self
        [filter_opponent]
			race=Mwc_demon
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker holy forced melee
        multiply=1.35
        apply_to=self
        [filter_opponent]
			race=Mwc_elemental
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker holy forced melee
        name= _ "weaker holy"
        description= _ "This attack deals 35% extra damage to undead, demons and elementals."
        multiply=1.0
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_HOLY_MELEE
    [damage]
        id=holy forced melee
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=undead
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=holy forced melee
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=Mwc_demon
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=holy forced melee
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=Mwc_elemental
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=holy forced melee
        name= _ "holy"
        description= _ "This attack deals 50% extra damage to undead, demons and elementals."
        multiply=1.0
		[filter_self]
			[filter_adjacent]
				ability=holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_STRONGER_HOLY_MELEE
    [damage]
        id=stronger holy forced melee
        multiply=1.65
        apply_to=self
        [filter_opponent]
			race=undead
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger holy forced melee
        multiply=1.65
        apply_to=self
        [filter_opponent]
			race=Mwc_demon
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger holy forced melee
        multiply=1.65
        apply_to=self
        [filter_opponent]
			race=Mwc_elemental
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger holy forced melee
        name= _ "stronger holy"
        description= _ "This attack deals 65% extra damage to undead, demons and elementals."
        multiply=1.0
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership melee
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_WEAKER_HOLY_RANGED
    [damage]
        id=weaker holy forced ranged
        multiply=1.35
        apply_to=self
        [filter_opponent]
			race=undead
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker holy forced ranged
        multiply=1.35
        apply_to=self
        [filter_opponent]
			race=Mwc_demon
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker holy forced ranged
        multiply=1.35
        apply_to=self
        [filter_opponent]
			race=Mwc_elemental
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=weaker holy forced ranged
        name= _ "weaker holy"
        description= _ "This attack deals 35% extra damage to undead, demons and elementals."
        multiply=1.0
		[filter_self]
			[filter_adjacent]
				ability=weaker holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef

#define WEAPON_SPECIAL_LATENT_HOLY_RANGED
    [damage]
        id=holy forced ranged
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=undead
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=holy forced ranged
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=Mwc_demon
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=holy forced ranged
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=Mwc_elemental
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=holy forced ranged
        name= _ "holy"
        description= _ "This attack deals 50% extra damage to undead, demons and elementals."
        multiply=1.0
		[filter_self]
			[filter_adjacent]
				ability=holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef


#define WEAPON_SPECIAL_LATENT_STRONGER_HOLY_RANGED
    [damage]
        id=stronger holy forced ranged
        multiply=1.65
        apply_to=self
        [filter_opponent]
			race=undead
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger holy forced ranged
        multiply=1.65
        apply_to=self
        [filter_opponent]
			race=Mwc_demon
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger holy forced ranged
        multiply=1.65
        apply_to=self
        [filter_opponent]
			race=Mwc_elemental
        [/filter_opponent]
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
    [damage]
        id=stronger holy forced ranged
        name= _ "stronger holy"
        description= _ "This attack deals 65% extra damage to undead, demons and elementals."
        multiply=1.0
		[filter_self]
			[filter_adjacent]
				ability=stronger holy leadership ranged
			[/filter_adjacent]
		[/filter_self]
    [/damage]
#enddef



#define ABILITY_MWC_FIRSTSTRIKE_LEADERSHIP
    [dummy]
        id=firststrike leadership
        name= _ "aura of firststrike"
        female_name= _ "female^aura of firststrike"
        description=_ "This unit can inspire adjacent units to attack with the firststrike frenzy when in melee combat."
    [/dummy]
#enddef


#define ABILITY_MWC_PLAGUE_LEADERSHIP
    [dummy]
        id=plague leadership
        name= _ "plague aura"
        female_name= _ "female^plague aura"
        description=_ "This unit can make adjacent units deal plague with all their melee attacks."
    [/dummy]
#enddef


#define ABILITY_MWC_POISON_LEADERSHIP
    [dummy]
        id=poison leadership
        name= _ "poison aura"
        female_name= _ "female^poison aura"
        description=_ "This unit can make adjacent units deal poison with all their attacks."
    [/dummy]
#enddef




#define ABILITY_MWC_WEAKER_FURY_LEADERSHIP
    [dummy]
        id=weaker fury leadership
        name= _ "aura of weaker fury"
        female_name= _ "female^aura of weaker fury"
        description=_ "This unit can inspire adjacent units to attack with the weaker fury frenzy when in melee combat."
    [/dummy]
#enddef


#define ABILITY_MWC_FURY_LEADERSHIP
    [dummy]
        id=fury leadership
        name= _ "aura of fury"
        female_name= _ "female^aura of fury"
        description=_ "This unit can inspire adjacent units to attack with the fury frenzy when in melee combat."
    [/dummy]
#enddef



#define ABILITY_MWC_STRONGER_FURY_LEADERSHIP
    [dummy]
        id=stronger fury leadership
        name= _ "aura of stronger fury"
        female_name= _ "female^aura of stronger fury"
        description=_ "This unit can inspire adjacent units to attack with the stronger fury frenzy when in melee combat."
    [/dummy]
#enddef




#define ABILITY_MWC_BERSERK_LEADERSHIP
    [dummy]
        id=berserk leadership
        name= _ "aura of berserk"
        female_name= _ "female^aura of berserk"
        description=_ "This unit can inspire adjacent units to attack with the berserker frenzy when in melee combat."
    [/dummy]
#enddef




#define ABILITY_MWC_MARKSMAN_LEADERSHIP
    [dummy]
        id=marksman leadership
        name= _ "aura of marksman"
        female_name= _ "female^aura of marksman"
        description=_ "This unit can reveal all enemies' prepared defensive tricks, making all adjacent units gain the marksman weapon special on their weapons."
    [/dummy]
#enddef



#define ABILITY_MWC_WEAKER_BACKSTAB_LEADERSHIP
    [dummy]
        id=weaker backstab leadership
        name= _ "aura of weaker backstab"
        female_name= _ "female^aura of weaker backstab"
        description=_ "This unit can maze all enemies' prepared defensive tricks, making all adjacent units gain the weaker backstab weapon special on their weapons."
    [/dummy]
#enddef


#define ABILITY_MWC_BACKSTAB_LEADERSHIP
    [dummy]
        id=backstab leadership
        name= _ "aura of backstab"
        female_name= _ "female^aura of backstab"
        description=_ "This unit can maze all enemies' prepared defensive tricks, making all adjacent units gain the backstab weapon special on their weapons."
    [/dummy]
#enddef


#define ABILITY_MWC_STRONGER_BACKSTAB_LEADERSHIP
    [dummy]
        id=stronger backstab leadership
        name= _ "aura of stronger backstab"
        female_name= _ "female^aura of stronger backstab"
        description=_ "This unit can maze all enemies' prepared defensive tricks, making all adjacent units gain the stronger backstab weapon special on their weapons."
    [/dummy]
#enddef



#define ABILITY_MWC_SLOW_LEADERSHIP_MELEE
    [dummy]
        id=slow leadership melee
        name= _ "aura of slow(melee)"
        female_name= _ "female^aura of slow(melee)"
        description=_ "This unit can stun all enemies' prepared defensive tricks, making all adjacent units gain the slow weapon special on their weapons(melee)."
    [/dummy]
#enddef


#define ABILITY_MWC_SLOW_LEADERSHIP_RANGED
    [dummy]
        id=slow leadership ranged
        name= _ "aura of slow(ranged)"
        female_name= _ "female^aura of slow(ranged)"
        description=_ "This unit can stun all enemies' prepared defensive tricks, making all adjacent units gain the slow weapon special on their weapons(ranged)."
    [/dummy]
#enddef




#define ABILITY_MWC_MAGICAL_LEADERSHIP_MELEE
    [dummy]
        id=magical leadership melee
        name= _ "aura of magical(melee)"
        female_name= _ "female^aura of magical(melee)"
        description=_ "This unit can enchant all enemies' prepared offensive tricks, making all adjacent units gain the magical weapon special on their melee weapons."
    [/dummy]
#enddef


#define ABILITY_MWC_MAGICAL_LEADERSHIP_RANGED
    [dummy]
        id=magical leadership ranged
        name= _ "aura of magical(ranged)"
        female_name= _ "female^aura of magical(ranged)"
        description=_ "This unit can enchant all enemies' prepared offensive tricks, making all adjacent units gain the magical weapon special on their ranged weapons."
    [/dummy]
#enddef


#define ABILITY_MWC_WEAKER_HORROR_LEADERSHIP_MELEE
    [dummy]
        id=weaker horror leadership melee
        name= _ "aura of weaker horror(melee)"
        female_name= _ "female^aura of weaker horror(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range in such horrific way, that the defender's recoil damage is reduced by 30%."
    [/dummy]
#enddef

#define ABILITY_MWC_HORROR_LEADERSHIP_MELEE
    [dummy]
        id=horror leadership melee
        name= _ "aura of horror(melee)"
        female_name= _ "female^aura of horror(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range in such horrific way, that the defender's recoil damage is reduced by 40%."
    [/dummy]
#enddef

#define ABILITY_MWC_STRONGER_HORROR_LEADERSHIP_MELEE
    [dummy]
        id=stronger horror leadership melee
        name= _ "aura of stronger horror(melee)"
        female_name= _ "female^aura of stronger horror(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range in such horrific way, that the defender's recoil damage is reduced by 50%."
    [/dummy]
#enddef


#define ABILITY_MWC_WEAKER_HORROR_LEADERSHIP_RANGED
    [dummy]
        id=weaker horror leadership ranged
        name= _ "aura of weaker horror(ranged)"
        female_name= _ "female^aura of weaker horror(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range in such horrific way, that the defender's recoil damage is reduced by 30%."
    [/dummy]
#enddef

#define ABILITY_MWC_HORROR_LEADERSHIP_RANGED
    [dummy]
        id=horror leadership ranged
        name= _ "aura of horror(ranged)"
        female_name= _ "female^aura of horror(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range in such horrific way, that the defender's recoil damage is reduced by 40%."
    [/dummy]
#enddef


#define ABILITY_MWC_STRONGER_HORROR_LEADERSHIP_RANGED
    [dummy]
        id=stronger horror leadership ranged
        name= _ "aura of stronger horror(ranged)"
        female_name= _ "female^aura of stronger horror(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range in such horrific way, that the defender's recoil damage is reduced by 50%."
    [/dummy]
#enddef

#define ABILITY_MWC_WEAKER_FOCUS_LEADERSHIP
    [dummy]
        id=weaker focus leadership
        name= _ "aura of weaker focus"
        female_name= _ "female^aura of weaker focus"
        description=_ "This unit can make adjacent units attack with incredible ferocity, granting them the weaker focus weapon special."
    [/dummy]
#enddef


#define ABILITY_MWC_FOCUS_LEADERSHIP
    [dummy]
        id=focus leadership
        name= _ "aura of focus"
        female_name= _ "female^aura of focus"
        description=_ "This unit can make adjacent units attack with incredible ferocity, granting them the focus weapon special."
    [/dummy]
#enddef


#define ABILITY_MWC_STRONGER_FOCUS_LEADERSHIP
    [dummy]
        id=stronger focus leadership
        name= _ "aura of stronger focus"
        female_name= _ "female^aura of stronger focus"
        description=_ "This unit can make adjacent units attack with incredible ferocity, granting them the stronger focus weapon special."
    [/dummy]
#enddef

#define ABILITY_MWC_WEAKER_CHARGE_LEADERSHIP
    [dummy]
        id=weaker charge leadership
        name= _ "aura of weaker charge"
        female_name= _ "female^aura of weaker charge"
        description=_ "This unit can make adjacent units attack with incredible ferocity, granting them the weaker charge weapon special."
    [/dummy]
#enddef



#define ABILITY_MWC_CHARGE_LEADERSHIP
    [dummy]
        id=charge leadership
        name= _ "aura of charge"
        female_name= _ "female^aura of charge"
        description=_ "This unit can make adjacent units attack with incredible ferocity, granting them the charge weapon special."
    [/dummy]
#enddef



#define ABILITY_MWC_STRONGER_CHARGE_LEADERSHIP
    [dummy]
        id=stronger charge leadership
        name= _ "aura of stronger charge"
        female_name= _ "female^aura of stronger charge"
        description=_ "This unit can make adjacent units attack with incredible ferocity, granting them the stronger charge weapon special."
    [/dummy]
#enddef


#define ABILITY_MWC_DRAIN_LEADERSHIP_MELEE
    [dummy]
        id=drain leadership melee
        name= _ "aura of drain(melee)"
        female_name= _ "female^aura of drain(melee)"
        description=_ "This unit can make adjacent units attack with incredible power, granting them the drain weapon special(melee)."
    [/dummy]
#enddef

#define ABILITY_MWC_DRAIN_LEADERSHIP_RANGED
    [dummy]
        id=drain leadership ranged
        name= _ "aura of drain(ranged)"
        female_name= _ "female^aura of drain(ranged)"
        description=_ "This unit can make adjacent units attack with incredible power, granting them the drain weapon special(ranged)."
    [/dummy]
#enddef



#define ABILITY_MWC_WEAKER_HOLY_LEADERSHIP_MELEE
    [dummy]
        id=weaker holy leadership melee
        name= _ "aura of weaker holy(melee)"
        female_name= _ "female^aura of weaker holy(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range with holy power, they deals higher damages in battle versus undead, elementals and demons."
    [/dummy]
#enddef

#define ABILITY_MWC_HOLY_LEADERSHIP_MELEE
    [dummy]
        id=holy leadership melee
        name= _ "aura of holy(melee)"
        female_name= _ "female^aura of holy(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range with holy power, they deals higher damages in battle versus undead, elementals and demons."
    [/dummy]
#enddef

#define ABILITY_MWC_STRONGER_HOLY_LEADERSHIP_MELEE
    [dummy]
        id=stronger holy leadership melee
        name= _ "aura of stronger holy(melee)"
        female_name= _ "female^aura of stronger holy(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range with holy power, they deals higher damages in battle versus undead, elementals and demons."
    [/dummy]
#enddef

#define ABILITY_MWC_WEAKER_HOLY_LEADERSHIP_RANGED
    [dummy]
        id=weaker holy leadership ranged
        name= _ "aura of weaker holy(ranged)"
        female_name= _ "female^aura of weaker holy(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range with holy power, they deals higher damages in battle versus undead, elementals and demons."
    [/dummy]
#enddef

#define ABILITY_MWC_HOLY_LEADERSHIP_RANGED
    [dummy]
        id=holy leadership ranged
        name= _ "aura of holy(ranged)"
        female_name= _ "female^aura of holy(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range with holy power, they deals higher damages in battle versus undead, elementals and demons."
    [/dummy]
#enddef

#define ABILITY_MWC_STRONGER_HOLY_LEADERSHIP_RANGED
    [dummy]
        id=stronger holy leadership ranged
        name= _ "aura of stronger holy(ranged)"
        female_name= _ "female^aura of stronger holy(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range with holy power, they deals higher damages in battle versus undead, elementals and demons."
    [/dummy]
#enddef


#define ABILITY_MWC_WEAKER_VICIOUS_LEADERSHIP_MELEE
    [dummy]
        id=weaker vicious leadership melee
        name= _ "aura of weaker vicious(melee)"
        female_name= _ "female^aura of weaker vicious(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range with greater power, they will do 2 damage more."
    [/dummy]
#enddef

#define ABILITY_MWC_VICIOUS_LEADERSHIP_MELEE
    [dummy]
        id=vicious leadership melee
        name= _ "aura of vicious(melee)"
        female_name= _ "female^aura of vicious(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range with greater power, they will do 4 damage more."
    [/dummy]
#enddef

#define ABILITY_MWC_STRONGER_VICIOUS_LEADERSHIP_MELEE
    [dummy]
        id=stronger vicious leadership melee
        name= _ "aura of stronger vicious(melee)"
        female_name= _ "female^aura of stronger vicious(melee)"
        description=_ "This unit can inspire adjacent units to strike in melee range with greater power, they will do 6 damage more."
    [/dummy]
#enddef


#define ABILITY_MWC_WEAKER_VICIOUS_LEADERSHIP_RANGED
    [dummy]
        id=weaker vicious leadership ranged
        name= _ "aura of weaker vicious(ranged)"
        female_name= _ "female^aura of weaker vicious(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range with greater power, they will do 2 damage more."
    [/dummy]
#enddef

#define ABILITY_MWC_VICIOUS_LEADERSHIP_RANGED
    [dummy]
        id=vicious leadership ranged
        name= _ "aura of vicious(ranged)"
        female_name= _ "female^aura of vicious(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range with greater power, they will do 4 damage more."
    [/dummy]
#enddef


#define ABILITY_MWC_STRONGER_VICIOUS_LEADERSHIP_RANGED
    [dummy]
        id=stronger vicious leadership ranged
        name= _ "aura of stronger vicious(ranged)"
        female_name= _ "female^aura of stronger vicious(ranged)"
        description=_ "This unit can inspire adjacent units to strike in ranged range with greater power, they will do 6 damage more."
    [/dummy]
#enddef
#define ABILITY_MWC_CHAOTICS_PLAGUE_AURA_MELEE
    [dummy]
        id=chaotics plague 01 aura melee
        name= _ "aura of chaotics plague(melee)"
        female_name= _ "female^aura of chaotics plague(melee)"
        description=_ "This unit can make adjacent units attack with incredible power, granting them the chaotics plague weapon special(melee)."
    [/dummy]
#enddef

#define ABILITY_MWC_LAWFULS_PLAGUE_AURA_MELEE
    [dummy]
        id=lawfuls plague 01 aura melee
        name= _ "aura of lawfuls plague(melee)"
        female_name= _ "female^aura of lawfuls plague(melee)"
        description=_ "This unit can make adjacent units attack with incredible power, granting them the lawfuls plague weapon special(melee)."
    [/dummy]
#enddef

#define ABILITY_MWC_NEUTRALS_PLAGUE_AURA_MELEE
    [dummy]
        id=neutrals plague 01 aura melee
        name= _ "aura of neutrals plague(melee)"
        female_name= _ "female^aura of neutrals plague(melee)"
        description=_ "This unit can make adjacent units attack with incredible power, granting them the neutrals plague weapon special(melee)."
    [/dummy]
#enddef

#define LATENT_WEAPON_SPECIAL_01_LAWFULS
    [dummy]
        id=latent_plague_lawfuls_01
        name= _ "lawfuls plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Loyalists or Chosen Of Magic or Drakes faction. This doesnt work on Undead or units in villages."
		[filter_self]
			[filter_adjacent]
				ability=lawfuls plague 01 aura melee
			[/filter_adjacent]
		[/filter_self]
    [/dummy]
#enddef

#define LATENT_WEAPON_SPECIAL_01_CHAOTICS
    [dummy]
        id=latent_plague_chaotics_01
        name= _ "chaotics plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Undeads or Northerners or Fallen Legions faction. This doesnt work on Undead or units in villages."
		[filter_self]
			[filter_adjacent]
				ability=chaotics plague 01 aura melee
			[/filter_adjacent]
		[/filter_self]
    [/dummy]
#enddef

#define LATENT_WEAPON_SPECIAL_01_NEUTRALS
    [dummy]
        id=latent_plague_neutrals_01
        name= _ "neutrals plague"
        description= _ "Killed enemy is replaced by 0-1 lvl unit from Knalgan Alliance or Rebels or Forgotten Beasts faction. This doesnt work on Undead or units in villages."
		[filter_self]
			[filter_adjacent]
				ability=neutrals plague 01 aura melee
			[/filter_adjacent]
		[/filter_self]
    [/dummy]
#enddef


#define WEAPON_SPECIAL_DUEL DURATION
    [berserk]
        id=duel{DURATION}
        name= _ "duel"
        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or {DURATION} rounds of attacks have occurred."
        value={DURATION}
		active_on=offense
    [/berserk]
#enddef


#define ABILITY_EXTRA_HEAL_12
    [heals]
        value=12
        id=healing_12
        affect_allies=yes
        name= _ "heals +12"
        female_name= _ "female^heals +12"
        description= _ "This unit combines herbal remedies with magic to heal units more quickly than is normally possible on the battlefield. A unit cared for by this healer may heal up to 12 HP per turn, or stop poison from taking effect for that turn. A poisoned unit cannot be cured of its poison by a healer, and must seek the care of a village or a unit that can cure."
        affect_self=no
        poison=slowed
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/heals]
#enddef


#define WEAPON_SPECIAL_PIERCE_ATTACK
   [damage]
      id=pierce_unit_attack
      name= _ "pierce"
       description= _ "Pierce: If this attack is used, the enemy behind the target is hurt as well, for 1/2 of the damage."
    [/damage]
#enddef


#define ABILITY_MWC_DAUNTLESS
    [resistance]
        id=dauntless
        name= _ "dauntless"
        description= _ "While attacking, this unit's resistances are doubled, up to a maximum of 50. Weaknesses are not affected."
        name_inactive= _ "dauntless"
        description_inactive= _ "While attacking, this unit's resistances are doubled, up to a maximum of 50. Weaknesses are not affected."
        multiply=2
        max_value=50
        apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=0
            less_than=50
        [/filter_base_value]
        active_on=offense
    [/resistance]
#enddef


#define ABILITY_MWC_LIGHTAURA
    [leadership]
        id=mwc_lightaura
        value=+35
        cumulative=yes
        name= _ "light aura"
        description= _ "Light aura makes all allies units fight better (+35% for attack)."
        affect_self=no
        affect_allies=yes
        affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            #[filter]
            #	level=0
            #[/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_MWC_BURNING_AURA POWER
    [heals]
        value=-{POWER}
        id=burning_aura
        affect_enemies=yes
        name= _ "burns foes"
        female_name= _ "female^burns foes"
        description=  _ "Allows the unit to damage adjacent enemies at the beginning of our turn. The damage depends on the skill in this aura. Because it specialises on lesser forms of life, it may help a poisoned enemy, or the poison will protect it from the aura, taking only 8 hp. This ability ignores any resistances or weaknesses of enemies, so it`s very powerful against spirits. It never kills, because it always leaves 1hp at least. If the enemy is poisoned, it doesn't cumulate."
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/heals]
#enddef


#define WEAPON_SPECIAL_CHARGE_GREATER
    # Canned definition of the Charge ability to be included in a
    # [specials] clause.
    [damage]
        id=charge greater
        name= _ "charge greater"
        description= _ "When used offensively, this attack deals 3x more damage to the target. It also causes this unit to take 3x more damage from the target's counterattack."
        multiply=3
        apply_to=both
        active_on=offense
    [/damage]
#enddef


#define WEAPON_SPECIAL_CHARGE_WEAKER
    # Canned definition of the Charge ability to be included in a
    # [specials] clause.
    [damage]
        id=charge weaker
        name= _ "charge weaker"
        description= _ "When used offensively, this attack deals 1,5x more damage to the target. It also causes this unit to take 1,5x more damage from the target's counterattack."
        multiply=1.5
        apply_to=both
        active_on=offense
    [/damage]
#enddef


#define WEAPON_SPECIAL_BACKSTAB_GREATER
    # Canned definition of the Backstab ability to be included in a
    # [specials] clause.
    [damage]
        id=backstab greater
        name= _ "backstab greater"
        description= _ "When used offensively, this attack deals 3x more damage if there is an enemy of the target on the opposite side of the target, and that unit is not incapacitated (turned to stone or otherwise paralyzed)."
        multiply=3
        backstab=yes
        active_on=offense
    [/damage]
#enddef

#define WEAPON_SPECIAL_MARKSMAN_DEFENSE
    # Canned definition of the Marksman ability to be included in a
    # [specials] clause.
    [chance_to_hit]
        id=marksman defense
        value=60
        cumulative=yes
        active_on=defense
    [/chance_to_hit]
    [chance_to_hit]
        id=marksman defense
        name= _ "marksman defense"
        description= _ "When used defensively, this attack always has at least a 60% chance to hit."
        value=0
        cumulative=yes
    [/chance_to_hit]
#enddef

#define ABILITY_BLOODLUST_3
    [dummy]
        id=bloodlust_3
        name= _ "bloodlust 3 hp"
        description= _ "This unit heals 3 hitpoints whenever it kills a living unit." 
    [/dummy]
#enddef

#define ABILITY_BLOODLUST_6
    [dummy]
        id=bloodlust_6
        name= _ "bloodlust 6 hp"
        description= _ "This unit heals 6 hitpoints whenever it kills a living unit." 
    [/dummy]
#enddef


#define ABILITY_BLOODLUST_9
    [dummy]
        id=bloodlust_9
        name= _ "bloodlust 9 hp"
        description= _ "This unit heals 9 hitpoints whenever it kills a living unit." 
    [/dummy]
#enddef


#define ABILITY_BLOODLUST_12
    [dummy]
        id=bloodlust_12
        name= _ "bloodlust 12 hp"
        description= _ "This unit heals 12 hitpoints whenever it kills a living unit." 
    [/dummy]
#enddef



#define ABILITY_DAYSTALK
    # Canned definition of the Daystalk ability to be included in an
    # [abilities] clause.
    [hides]
        id=daystalk
        name= _ "daystalk"
        female_name= _ "daystalk"
        description= _ "The unit becomes invisible during day. Enemy units cannot see this unit at day, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        name_inactive= _ "daystalk"
        female_name_inactive= _ "female^daystalk"
        description_inactive= _ "The unit becomes invisible during day. Enemy units cannot see this unit at day, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        affect_self=yes
        [filter_self]
            [filter_location]
                time_of_day=lawful
            [/filter_location]
        [/filter_self]
    [/hides]
#enddef



#define ABILITY_MWC_GREATER_PROTECTION
    [resistance]
        id=greater_protection
        add=25
        max_value=75
        #apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=-1000
            less_than=75
        [/filter_base_value]
        name= _ "greater protection"
        description= _ "Adjacent friendly units receive a +25% bonus to all resistances (up to a maximum of 75%)."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef


#define ABILITY_MWC_PROTECTION
    [resistance]
        id=protection
        add=20
        max_value=75
        #apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=-1000
            less_than=75
        [/filter_base_value]
        name= _ "protection"
        description= _ "Adjacent friendly units receive a +20% bonus to all resistances (up to a maximum of 75%)."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef


#define ABILITY_MWC_WEAKER_PROTECTION
    [resistance]
        id=weaker_protection
        add=15
        max_value=75
        #apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=-1000
            less_than=75
        [/filter_base_value]
        name= _ "weaker protection"
        description= _ "Adjacent friendly units receive a +15% bonus to all resistances (up to a maximum of 75%)."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef



#define ABILITY_MWC_ELITE_STEADFAST
    [resistance]
        id=elite steadfast
        multiply=2
        max_value=65
        [filter_base_value]
            greater_than=0
            less_than=65
        [/filter_base_value]
        name= _ "elite steadfast"
        female_name= _ "female^elite steadfast"
        description= _ "This unit's resistances are doubled, up to a maximum of 65%, when defending. Vulnerabilities are not affected."
        affect_self=yes
        active_on=defense
    [/resistance]
#enddef

#define ABILITY_MWC_STEADFAST_AURA
    [resistance]
        id=steadfast aura
        multiply=2
        max_value=50
        apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=0
            less_than=50
        [/filter_base_value]
        name= _ "steadfast aura"
        description= _ "Adjacent friendly units got doubled all resistances (up to a maximum of 50%) while defending."
        affect_self=no
        affect_allies=yes
        active_on=defense
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef


#define ABILITY_MWC_DAUNTLESS_AURA
    [resistance]
        id=dauntless aura
        multiply=2
        max_value=50
        apply_to=blade,pierce,impact,fire,cold,arcane
        [filter_base_value]
            greater_than=0
            less_than=50
        [/filter_base_value]
        name= _ "dauntless aura"
        description= _ "Adjacent friendly units got doubled all resistances (up to a maximum of 50%) while attacking."
        affect_self=no
        affect_allies=yes
        active_on=offense
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef



#define ABILITY_MWC_WARP
    # Canned definition of the WARP ability to be included in an
    # [abilities] clause.
    [teleport]
        id=warp_mwc
        name="warp"
        female_name= _ "female^warp"
        description= _ "This unit and it's allies may teleport between any two empty villages owned by your side."
		affect_self=yes
		affects_allies=yes
        [affect_adjacent]
			adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
         [tunnel]
            id=village_teleport
            [source]
                terrain=*^V*
                owner_side=$teleport_unit.side
                [not]
                    [filter]
                        [not]
                            id=$teleport_unit.id
                        [/not]
                    [/filter]
                [/not]
            [/source]

            [target]
                terrain=*^V*
                owner_side=$teleport_unit.side
                [not]
                    [filter]
                    [/filter]
                [/not]
            [/target]

            [filter]
            	ability=warp_mwc
				[or]
					[filter_adjacent]
						adjacent=n,ne,se,s,sw,nw
						is_enemy=no
					[/filter_adjacent]
				[/or]
            [/filter]
        [/tunnel]
    [/teleport]
#enddef



#define WEAPON_SPECIAL_CHAOS
    [chance_to_hit]
        name= _ "chaos"
        description= _ "When used defensively, this attacks damages all surrounding units for a half of the damage, and it always has a 70% chance to hit regardless of the defensive ability of the attacking unit."
    [/chance_to_hit]
    [chance_to_hit]
        id=chaos
        value=70
        cumulative=no
        active_on=defense
    [/chance_to_hit]
#enddef


#define WEAPON_SPECIAL_STRUGGLE
    [chance_to_hit]
        id=struggle
        sub=10
		apply_to=opponent
        cumulative=yes
    [/chance_to_hit]
    [chance_to_hit]
        id=struggle
        name= _ "struggle"
        description= _ "This attack causes the opponent to have a 10% lower chance to hit."
		apply_to=self
        cumulative=yes
    [/chance_to_hit]
#enddef


#define WEAPON_SPECIAL_MWC_WEAKER_STRUGGLE
    [chance_to_hit]
        id=mwc_weaker struggle
        sub=10
		value=20
		apply_to=opponent
        cumulative=yes
    [/chance_to_hit]
    [chance_to_hit]
        id=mwc_weaker struggle
        name= _ "weaker struggle"
        description= _ "This attack causes the opponent to have a 10% lower chance to hit(not lower than 20%)."
		apply_to=self
        cumulative=yes
    [/chance_to_hit]
#enddef


#define WEAPON_SPECIAL_MWC_STRUGGLE
    [chance_to_hit]
        id=mwc_struggle
       sub=15
		value=20
		apply_to=opponent
        cumulative=yes
    [/chance_to_hit]
    [chance_to_hit]
        id=mwc_struggle
        name= _ "normal struggle"
        description= _ "This attack causes the opponent to have a 15% lower chance to hit(not lower than 20%)."
		apply_to=self
        cumulative=yes
    [/chance_to_hit]
#enddef


#define WEAPON_SPECIAL_MWC_STRONGER_STRUGGLE
    [chance_to_hit]
        id=mwc_stronger struggle
        sub=20
		value=20
		apply_to=opponent
        cumulative=yes
    [/chance_to_hit]
    [chance_to_hit]
        id=mwc_stronger struggle
        name= _ "stronger struggle"
        description= _ "This attack causes the opponent to have a 20% lower chance to hit(not lower than 20%)."
		apply_to=self
        cumulative=yes
    [/chance_to_hit]
#enddef


#define ABILITY_MWC_MURDERLUST
  [dummy]
      id=murderlust
      name= _ "murderlust"
        description= _ "When this unit kills another unit, he/she heals 8 hp."
  [/dummy]
	[/abilities]
		[event]
			name=die
			first_time_only=no
			id=murderedbymurderlust
			[filter_second]
				ability=murderlust
			[/filter_second]
			[heal_unit]
				[filter]
					id=$second_unit.id
				[/filter]
				amount=8
				animate=yes
				restore_statuses=no
			[/heal_unit]
		[/event]
	[+abilities]
#enddef


#define ABILITY_MWC_SWAMPAMBUSH
    [hides]
        id=swampambush
        name= _ "swamp ambush"
        name_inactive= _ "swamp ambush"
        description= _ "This unit can hide in swamp, and remain undetected by its enemies. Enemy units cannot see this unit while it is in swamp, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        description_inactive= _ "This unit can hide in swamp, and remain undetected by its enemies. Enemy units cannot see this unit while it is in swamp, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        affect_self=yes
        [filter_self]
            [filter_location]
                terrain=Sm*,Ss*,Khs*,Chs*,Sm^*,Ss^*,Khs^*,Chs^*
            [/filter_location]
        [/filter_self]
    [/hides]
#enddef


#define WEAPON_SPECIAL_QUICKSTRIKE
 # This ability is just to notice that the attack uses no movement.
    [attacks]
        id=quickstrike
        name= _ "quickstrike"
        name_inactive= _ "quickstrike"
        description= _ "Quickstrike: When this attack is used, the attacker loses no movement. However, this does not give back the movement lost due to entering a unit's ZoC."
    [/attacks]
#enddef

#define WEAPON_SPECIAL_MWC_PICKPOCKET

# Canned definition of the pickpocket ability to be included in a

# [specials] clause.
# dummy weapon special used to describe the effect to the user
# and filter on special's id
[dummy]
  id=weapon_pickpocket
  name= _ "pickpocket"
  name_inactive= _ "pickpocket"
  description= _ "Gain money for attacking your foe. Each strike scores you one gold."
  description_inactive= _ "Gain money for attacking your foe. Each strike scores you one gold."
  apply_to=opponent
[/dummy]
#enddef

#define WEAPON_SPECIAL_PICKPOCKET

# Canned definition of the pickpocket ability to be included in a

# [specials] clause.
# dummy weapon special used to describe the effect to the user
# and filter on special's id
[dummy]
  id=weapon_pickpocket
  name= _ "pickpocket"
  name_inactive= _ "pickpocket"
  description= _ "Gain money for attacking your foe. Each strike scores you one gold."
  description_inactive= _ "Gain money for attacking your foe. Each strike scores you one gold."
  apply_to=opponent
[/dummy]
[/specials]
[/attack]
# event that creates a "pickpocket has worked" variable
# and sets it to "yes" if the attacker hits at least once.
[event]
  name=attacker hits
  first_time_only=no   
  [filter_attack]
     special=weapon_pickpocket
  [/filter_attack]   
  [store_unit]
     [filter]
        x,y=$x1,$y1
     [/filter]
     variable=unit_att_with_pickpocket
     mode=append
  [/store_unit]
  [set_variable]
     name=unit_att_with_pickpocket.variables.pickpocket_has_worked
     value=yes
  [/set_variable]
  [unstore_unit]
     variable=unit_att_with_pickpocket
  [/unstore_unit]   
  {CLEAR_VARIABLE unit_att_with_pickpocket}
[/event]
[event]
  name=attacker hits
  first_time_only=no  
  [filter_attack]
     special=weapon_pickpocket
  [/filter_attack]   
  [store_unit]
     [filter]
        x,y=$x1,$y1
     [/filter]
     variable=pickpocketer
     mode=append
  [/store_unit]   
  [store_unit]
     [filter]
        x,y=$x2,$y2
     [/filter]
     variable=pickpocketed
     mode=append
  [/store_unit]   
  [if]
     [variable]
        name=pickpocketer.variables.pickpocket_has_worked
        equals=yes
     [/variable]
     [then]
   [gold]
    side=$side_number
    amount=2
   [/gold]
        [unstore_unit]
           variable=pickpocketed
           text="!"
           {COLOR_HEAL}
        [/unstore_unit]
     [/then]
  [/if]   
  {CLEAR_VARIABLE pickpocketer}
  {CLEAR_VARIABLE pickpocketed}
[/event]
[+attack]
[+specials]
#enddef



#define ABILITY_MWC_THORNS
  [dummy]
      id=thorns
      name= _ "thorns"
        description= _ "Any unit that attacks this unit in melee suffers three points of piercing damage. Unlike reflect, it can kill."
  [/dummy]
#enddef


#define ABILITY_MWC_ILLUMINATES_WEAKER
    # Canned definition of the Illuminates weaker ability to be included in an
    # [abilities] clause.
    [illuminates]
        id=illumination weaker
        value=15
        max_value=15
        cumulative=no
        name= _ "illuminates weaker"
        female_name= _ "female^illuminates weaker"
        description= _ "This unit illuminates weaker the surrounding area, making lawful units fight better, and chaotic units fight worse. Any units adjacent to this unit will fight as if it were dusk when it is night, and as if it were day when it is dusk."
        affect_self=yes
    [/illuminates]
#enddef

#define ABILITY_LATENT_TELEPORT
    # Canned definition of the TELEPORT ability to be included in an
    # [abilities] clause.
    [teleport]
        id=teleport_forced
        name= _ "teleport"
        female_name= _ "female^teleport"
        description= _ "This unit may teleport between any two empty villages owned by its side using one of its moves."
        [tunnel]
            id=village_teleport
            [source]
                terrain=*^V*
                owner_side=$teleport_unit.side
                [not]
                    [filter]
                        [not]
                            id=$teleport_unit.id
                        [/not]
                    [/filter]
                [/not]
            [/source]

            [target]
                terrain=*^V*
                owner_side=$teleport_unit.side
                [not]
                    [filter]
                    [/filter]
                [/not]
            [/target]

            [filter]
                ability=teleport_forced
            [/filter]
        [/tunnel]
		[filter_self]
			[filter_adjacent]
				ability=warp_mwc
			[/filter_adjacent]
		[/filter_self]
    [/teleport]
#enddef


#define WEAPON_SPECIAL_MWC_DEADLY_STRIKE
    [dummy]
        id=deadly_strike
        name= _ "deadly strike"
        description= _ "this attack has a 5% chance to kill immediately a lower level enemy."
    [/dummy]
#enddef



#define ABILITY_TERROR_LEVEL_0
    [leadership]
        id=terror
        name= _ "terror"
        female_name= _ "female^terror"
        description= _ "This unit can makes enemie units fight worse."
        value=-5
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef










#define ABILITY_TERROR_LEVEL_1
    [leadership]
        id=terror
        name= _ "terror"
        female_name= _ "female^terror"
        description= _ "This unit can makes enemie units fight worse."
        value=-15
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-5
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef









#define ABILITY_TERROR_LEVEL_2
    [leadership]
        id=terror
        name= _ "terror"
        female_name= _ "female^terror"
        description= _ "This unit can makes enemie units fight worse."
        value=-25
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-15
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-5
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef








#define ABILITY_TERROR_LEVEL_3
    [leadership]
        id=terror
        name= _ "terror"
        female_name= _ "female^terror"
        description= _ "This unit can makes enemie units fight worse."
        value=-35
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-25
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-15
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-5
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef









#define ABILITY_TERROR_LEVEL_4
    [leadership]
        id=terror
        name= _ "terror"
        female_name= _ "female^terror"
        description= _ "This unit can makes enemie units fight worse."
        value=-45
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-35
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-25
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-15
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-5
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=4
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef









#define ABILITY_TERROR_LEVEL_5
    [leadership]
        id=terror
        name= _ "terror"
        female_name= _ "female^terror"
        description= _ "This unit can makes enemie units fight worse."
        value=-55
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-45
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-35
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-25
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-15
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=4
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-5
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=5
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef









#define ABILITY_TERROR_LEVEL_6
    [leadership]
        id=terror
        name= _ "terror"
        female_name= _ "female^terror"
        description= _ "This unit can makes enemie units fight worse."
        value=-65
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-55
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-45
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-35
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-25
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=4
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-15
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=5
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-5
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=6
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef


#define ABILITY_MWC_LEADERSHIP_LEVEL_1
    # Canned definition of the Leadership (level 1) ability to be included in an
    # [abilities] clause.
    [leadership]
        id=leadership
        value=25
        cumulative=no
        name= _ "leadership"
        female_name= _ "female^leadership"
        description= _ "This unit can lead our own units that are next to it, making them fight better. Adjacent own units of lower level will do more damage in battle. When a unit adjacent to, of a lower level than, and on the same side as a unit with Leadership engages in combat, its attacks do 25% more damage times the difference in their levels."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_MWC_LEADERSHIP_LEVEL_2
    # Canned definition of the Leadership (level 2) ability to be included in an
    # [abilities] clause.
    [leadership]
        id=leadership
        value=50
        cumulative=no
        name= _ "leadership"
        female_name= _ "female^leadership"
        description= _ "This unit can lead our own units that are next to it, making them fight better. Adjacent own units of lower level will do more damage in battle. When a unit adjacent to, of a lower level than, and on the same side as a unit with Leadership engages in combat, its attacks do 25% more damage times the difference in their levels."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=25
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_MWC_LEADERSHIP_LEVEL_3
    # Canned definition of the Leadership (level 3) ability to be included in an
    # [abilities] clause.
    [leadership]
        id=leadership
        value=75
        cumulative=no
        name= _ "leadership"
        female_name= _ "female^leadership"
        description= _ "This unit can lead our own units that are next to it, making them fight better. Adjacent own units of lower level will do more damage in battle. When a unit adjacent to, of a lower level than, and on the same side as a unit with Leadership engages in combat, its attacks do 25% more damage times the difference in their levels."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=50
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=25
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_MWC_LEADERSHIP_LEVEL_4
    # Canned definition of the Leadership (level 4) ability to be included in an
    # [abilities] clause.
    [leadership]
        id=leadership
        value=100
        cumulative=no
        name= _ "leadership"
        female_name= _ "female^leadership"
        description= _ "This unit can lead our own units that are next to it, making them fight better. Adjacent own units of lower level will do more damage in battle. When a unit adjacent to, of a lower level than, and on the same side as a unit with Leadership engages in combat, its attacks do 25% more damage times the difference in their levels."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=75
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=50
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=25
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_MWC_LEADERSHIP_LEVEL_5
    # Canned definition of the Leadership (level 5) ability to be included in an
    # [abilities] clause.
    [leadership]
        id=leadership
        value=125
        cumulative=no
        name= _ "leadership"
        female_name= _ "female^leadership"
        description= _ "This unit can lead our own units that are next to it, making them fight better. Adjacent own units of lower level will do more damage in battle. When a unit adjacent to, of a lower level than, and on the same side as a unit with Leadership engages in combat, its attacks do 25% more damage times the difference in their levels."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=100
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=75
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=50
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=25
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=4
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef


#define ABILITY_MWC_LEADERSHIP_LEVEL_6
    # Canned definition of the Leadership (level 6) ability to be included in an
    # [abilities] clause.
    [leadership]
        id=leadership
        value=150
        cumulative=no
        name= _ "leadership"
        female_name= _ "female^leadership"
        description= _ "This unit can lead our own units that are next to it, making them fight better. Adjacent own units of lower level will do more damage in battle. When a unit adjacent to, of a lower level than, and on the same side as a unit with Leadership engages in combat, its attacks do 25% more damage times the difference in their levels."
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=125
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=100
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=75
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=50
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=4
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=25
        cumulative=no
        affect_self=no
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=5
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_BURNING_AURA POWER
    [heals]
        value=-{POWER}
        id=burning_aura_mwc_{POWER}
        name= _ "burns foes"
        female_name= _ "female^burns foes"
        description=  _ "Allows the unit to damage adjacent enemies at the beginning of our turn. The damage depends on the skill in this aura. Because it specialises on lesser forms of life, it may help a poisoned enemy, or the poison will protect it from the aura, taking only " + {POWER} + " hp. This ability ignores any resistances or weaknesses of enemies, so it`s very powerful against spirits. It never kills, because it always leaves 1hp at least. If the enemy is poisoned, it doesn't cumulate."
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/heals]
#enddef

#define WEAPON_SPECIAL_MWC_HOLY
    [damage]
        id=mwc_holy
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=undead
        [/filter_opponent]
    [/damage]
    [damage]
        id=mwc_holy
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=Mwc_demon
        [/filter_opponent]
    [/damage]
    [damage]
        id=mwc_holy
        multiply=1.5
        apply_to=self
        [filter_opponent]
			race=Mwc_elemental
        [/filter_opponent]
    [/damage]
    [damage]
        id=mwc_holy
        name= _ "holy"
        description= _ "This attack deals 50% extra damage to undead, demons and elementals."
        multiply=1.0
    [/damage]
#enddef

#define ABILITY_FORESTHOME_VALUE VALUE
    [regenerate]
        [filter_self]
            [filter_location]
                terrain=*^F*
            [/filter_location]
        [/filter_self]
        value={VALUE}
        id=forest_regenerates{VALUE}
        name= _ "forest " + {VALUE} + "hp"
        description= _ "This unit will regenerate " + {VALUE} + "hp when in forest."
        name_inactive= _ "forest" + {VALUE} + "hp"
        description_inactive= _ "This unit will regenerate " + {VALUE} + " hp when in forest."
        affect_self=yes
    [/regenerate]
#enddef

#define ABILITY_WATER_VALUE VALUE
	[regenerate]
		value={VALUE}
		id=water_regenerates{VALUE}
		name= _ "water " + {VALUE} + "hp"
		description= _ "This unit is made of water. As a result, if it is standing in water, it will receive " + {VALUE} + "hp. If it is poisoned, it will remove it instead of healing."
		name_inactive= _ "waterhome " + {VALUE} + "hp"
		description_inactive= _ "This unit is made of water. If it stands in water, it will receive " + {VALUE} + " hp. If it is poisoned, it will remove it instead of healing."
		affect_self=yes
		poison=cured
		[filter_self]
			[filter_location]
				terrain=W*,Sm*,Ss*,W^*,Sm^*,Ss^*,Chw,Chw^*,Chs,Chs^*
			[/filter_location]
		[/filter_self]
	[/regenerate]
#enddef

#define ABILITY_MWC_WATERAMBUSH
    [hides]
        id=waterambush
        name= _ "water ambush"
        name_inactive= _ "water ambush"
        description= _ "This unit can hide in water, and remain undetected by its enemies. Enemy units cannot see this unit while it is in water, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        description_inactive= _ "This unit can hide in water, and remain undetected by its enemies. Enemy units cannot see this unit while it is in water, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        affect_self=yes
        [filter_self]
            [filter_location]
                terrain=W*,Sm*,Ss*,W^*,Sm^*,Ss^*,Chw,Chw^*,Chs,Chs^*
            [/filter_location]
        [/filter_self]
    [/hides]
#enddef

#define ABILITY_DARKAURA_WEAKER
    [leadership]
        id=darkaura weaker
        value=-15
        cumulative=yes
        name= _ "dark weaker aura"
        description= _ "Dark weaker aura makes all enemy units fight worse (-15% for attack)."
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            #[filter]
            #	level=0
            #[/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_DARKAURA
    [leadership]
        id=darkaura
        value=-25
        cumulative=yes
        name= _ "dark aura"
        description= _ "Dark aura makes all enemy units fight worse (-25% for attack)."
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            #[filter]
            #	level=0
            #[/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_LIGHTAURA_WEAKER
    [leadership]
        id=lightaura weaker
        value=+15
        cumulative=yes
        name= _ "light weaker aura"
        description= _ "Light weaker aura makes all allies units fight better (+15% for attack)."
        affect_self=yes
        affect_allies=yes
        affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            #[filter]
            #	level=0
            #[/filter]
        [/affect_adjacent]
    [/leadership]
#enddef

#define ABILITY_LIGHTAURA
    [leadership]
        id=lightaura
        value=+25
        cumulative=yes
        name= _ "light aura"
        description= _ "Light aura makes all allies units fight better (+25% for attack)."
        affect_self=no
        affect_allies=yes
        affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            #[filter]
            #	level=0
            #[/filter]
        [/affect_adjacent]
    [/leadership]
#enddef



#define SUMMON_MENU_ITEM ID DESCRIPTION COST ABILITY UNIT
    [event]
        name=select

        first_time_only=no

        [filter]
            type=Mwc_Master Of Fire,Mwc_Master Of Air,Mwc_Master Of Water,Mwc_Master Of Elements,Mwc_Guru,Mwc_Master Of Balance,Mwc_Heavy Summoner,Mwc_Summons Master
            side=$side_number
        [/filter]

        [store_unit]
            [filter]
                x,y=$x1,$y1
            [/filter]
            variable=last_selected_unit
        [/store_unit]
    [/event]
    [set_menu_item]
        id=MWC_summon_{ID}
        description= _ "Summon {DESCRIPTION} ({COST}g)"
        [show_if]
        [/show_if]

        [filter_location]
            [filter_adjacent_location]
                [filter]
                    ability={ABILITY}
                    side=$side_number
                    [filter_wml]
                        moves=$this_unit.max_moves
                    [/filter_wml]
                    [filter_location]
                        [not]
                            terrain=C*,K*,W*,C^*,K^*,W^*
                        [/not]
                    [/filter_location]
                [/filter]
            [/filter_adjacent_location]
            [not]
                [filter]
                [/filter]
                [or]
                    terrain=_off^_usr,Q*,Q^*,Wo*,Wo^*,Mm^Xm,Md^Xm,Xu,Xv,*^V*
                [/or]
            [/not]
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to={COST}
                [/variable]
                [then]
                    [gold]
                        amount=-{COST}
                        side=$side_number
                    [/gold]
                    [unit]
                        type={UNIT}
                        side=$side_number
                        x,y=$x1,$y1
                        moves=0
                        animate=yes
                    [/unit]
                    [store_unit]
                        variable=newunit
                        [filter]
                            x,y=$x1,$y1
                        [/filter]
                    [/store_unit]
                    [set_variable]
                        name=newunit.attacks_left
                        value=0
                    [/set_variable]
                    [unstore_unit]
                        variable=newunit
                        find_vacant=no
                    [/unstore_unit]
                    [set_variable]
                        name=newunit.moves
                        value=0
                    [/set_variable]
                    [store_unit]
                        [filter]
                            ability={ABILITY}
                            side=$side_number
                            [filter_wml]
                                moves=$this_unit.max_moves
                            [/filter_wml]
                            [filter_adjacent]
                                x,y=$x1,$y1
                            [/filter_adjacent]
                        [/filter]
                        variable=able_to_summon
                    [/store_unit]
                    [if]
                        [variable]
                            name=able_to_summon.length
                            greater_than=1
                        [/variable]
                        [then]
                            {FOREACH able_to_summon a}
                                [if]
                                    [variable]
                                        name=able_to_summon[$a].id
                                        equals=$last_selected_unit.id
                                    [/variable]
                                    [then]
                                        [set_variable]
                                            name=able_to_summon[$a].attacks_left
                                            value=0
                                        [/set_variable]
                                        [set_variable]
                                            name=able_to_summon[$a].moves
                                            value=0
                                        [/set_variable]

                                        {VARIABLE_OP able_to_summon[$a].experience add 3}

                                        [unstore_unit]
                                            variable=able_to_summon[$a]
                                            find_vacant=no
                                            text= _ "+$this_unit.level exp"
                                            red,green,blue=50,50,200
                                        [/unstore_unit]
                                        {CLEAR_VARIABLE newunit}
                                        {CLEAR_VARIABLE able_to_summon}
                                    [/then]
                                [/if]
                            {NEXT a}
                        [/then]
                        [else]
                            [store_unit]
                                variable=able_to_summon
                                [filter]
                                    ability={ABILITY}
                                    side=$side_number
                                    [filter_wml]
                                        moves=$this_unit.max_moves
                                    [/filter_wml]
                                    [filter_adjacent]
                                        x,y=$x1,$y1
                                    [/filter_adjacent]
                                [/filter]
                            [/store_unit]
                            [set_variable]
                                name=able_to_summon[$a].attacks_left
                                value=0
                            [/set_variable]
                            [set_variable]
                                name=able_to_summon[$a].moves
                                value=0
                            [/set_variable]

                            {VARIABLE_OP able_to_summon[$a].experience add 4}

                            [unstore_unit]
                                variable=able_to_summon[$a]
                                find_vacant=no
                                text= _ "+$this_unit.level exp"
                                red,green,blue=50,50,200
                            [/unstore_unit]
                            {CLEAR_VARIABLE newunit}
                            {CLEAR_VARIABLE able_to_summon}
                        [/else]
                    [/if]
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to summon."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
            {CLEAR_VARIABLE actualgold}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_summon_zhelp
        description= _ "Summon Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
                type=Mwc_Master Of Fire,Mwc_Master Of Air,Mwc_Master Of Water,Mwc_Master Of Elements,Mwc_Guru,Mwc_Master Of Balance,Mwc_Heavy Summoner,Mwc_Summons Master,Mwc_Elder Necromancer,Mwc_The_Last_Summoner
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To summon a unit right-click on adjacent hexes near a selected summoner.
                    
You need all movement points (and remaining attacks) to summon one creature. You are unable to summon from castles or keeps. A new unit can't be summoned on water.
Every summoning adds +4 to current experience.

If there are 2 or more summoners, a new unit will be summoned by the last selected unit able to summon."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef

#####################################
#####################################

#Summoners
#Grand Summoner

#define ABILITY_MWC_SUMMON_LEVEL3
    [dummy]
        id=MWC_summon_lvl3
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_summon_lvl3
        [/have_unit]
        [then]
            {SUMMON_MENU_LVL3}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_summon_lvl3
    [/filter]
    {SUMMON_MENU_LVL3}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_summon_lvl3
    [/filter]
    {SUMMON_MENU_LVL3}
[/event]

[+abilities]
#enddef

#define SUMMON_MENU_LVL3
    {SUMMON_MENU_ITEM 6_1_1 (Fire Elemental) 17 MWC_summon_lvl3 (Mwc_Elemental Fire)}
    {SUMMON_MENU_ITEM 6_1_2 (Water Elemental) 20 MWC_summon_lvl3 (Mwc_Tidal)}
#enddef

#Summons Master

#define ABILITY_MWC_SUMMON_LEVEL4
    [dummy]
        id=MWC_summon_lvl4
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_summon_lvl4
        [/have_unit]
        [then]
            {SUMMON_MENU_LVL4}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_summon_lvl4
    [/filter]
    {SUMMON_MENU_LVL4}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_summon_lvl4
    [/filter]
    {SUMMON_MENU_LVL4}
[/event]

[+abilities]
#enddef

#define SUMMON_MENU_LVL4
    {SUMMON_MENU_ITEM 6_2_1 (Fire Elemental) 17 MWC_summon_lvl4 (Mwc_Elemental Fire)}
    {SUMMON_MENU_ITEM 6_2_2 (Water Elemental) 19 MWC_summon_lvl4 (Mwc_Tidal)}
    {SUMMON_MENU_ITEM 6_2_3 (Air Elemental) 20 MWC_summon_lvl4 (Mwc_Elemental_Air)}
    {SUMMON_MENU_ITEM 6_2_4 (Earth Elemental) 20 MWC_summon_lvl4 (Mwc_Elemental_Earth)}
    {SUMMON_MENU_ITEM 6_2_5 (Wood Golem) 23 MWC_summon_lvl4 (Mwc_Little_Golem)}
    {SUMMON_MENU_ITEM 6_2_6 (Animated Snow) 22 MWC_summon_lvl4 (Mwc_Animated Snow)}
#enddef


#define ABILITY_MWC_SUMMON_LEVEL5
    [dummy]
        id=MWC_summon_lvl5
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_summon_lvl5
        [/have_unit]
        [then]
            {SUMMON_MENU_LVL5}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_summon_lvl5
    [/filter]
    {SUMMON_MENU_LVL5}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_summon_lvl5
    [/filter]
    {SUMMON_MENU_LVL5}
[/event]

[+abilities]
#enddef

#define SUMMON_MENU_LVL5
    {SUMMON_MENU_ITEM 6_2_1 (Fire Elemental) 15 MWC_summon_lvl5 (Mwc_Elemental Fire)}
    {SUMMON_MENU_ITEM 6_2_2 (Water Elemental) 17 MWC_summon_lvl5 (Mwc_Tidal)}
    {SUMMON_MENU_ITEM 6_2_3 (Air Elemental) 18 MWC_summon_lvl5 (Mwc_Elemental_Air)}
    {SUMMON_MENU_ITEM 6_2_4 (Earth Elemental) 18 MWC_summon_lvl5 (Mwc_Elemental_Earth)}
    {SUMMON_MENU_ITEM 6_2_5 (Wood Golem) 21 MWC_summon_lvl5 (Mwc_Little_Golem)}
    {SUMMON_MENU_ITEM 6_2_6 (Animated Snow) 20 MWC_summon_lvl5 (Mwc_Animated Snow)}
#enddef

#Heavy and Neutral Summoner

#define ABILITY_MWC_SUMMON_HS
    [dummy]
        id=MWC_summon_hs
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_summon_hs
        [/have_unit]
        [then]
            {SUMMON_HS_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_summon_hs
    [/filter]
    {SUMMON_HS_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_summon_hs
    [/filter]
    {SUMMON_HS_MENU}
[/event]

[+abilities]
#enddef

#define SUMMON_HS_MENU
    {SUMMON_MENU_ITEM 6_3_1 (Rhami) 17 MWC_summon_hs (Mwc_Rhami)}
#enddef

###########################
###########################

#Enlightened Ones

#define ABILITY_MWC_MOF
    [dummy]
        id=MWC_mof
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_mof
        [/have_unit]
        [then]
            {MOF_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_mof
    [/filter]
    {MOF_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_mof
    [/filter]
    {MOF_MENU}
[/event]

[+abilities]
#enddef

#define MOF_MENU
    {SUMMON_MENU_ITEM MWC_mof_menu (Fire Elemental) 17 MWC_mof (Mwc_Elemental Fire)}
#enddef

##################
#define ABILITY_MWC_MOW
    [dummy]
        id=MWC_mow
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_mow
        [/have_unit]
        [then]
            {MOW_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_mow
    [/filter]
    {MOW_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_mow
    [/filter]
    {MOW_MENU}
[/event]

[+abilities]
#enddef

#define MOW_MENU
    {SUMMON_MENU_ITEM MWC_mow_menu (Water Elemental) 20 MWC_mow (Mwc_Tidal)}
#enddef

###################
#define ABILITY_MWC_MOA
    [dummy]
        id=MWC_moa
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_moa
        [/have_unit]
        [then]
            {MOA_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_moa
    [/filter]
    {MOA_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_moa
    [/filter]
    {MOA_MENU}
[/event]

[+abilities]
#enddef

#define MOA_MENU
    {SUMMON_MENU_ITEM MWC_moa_menu (Air Elemental) 21 MWC_moa (Mwc_Elemental_Air)}
#enddef

#####################
#define ABILITY_MWC_GURU
    [dummy]
        id=Mwc_Guru
        name= _ "summon"
        description= _ "This unit can summon new units near him, but not in villages."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=Mwc_Guru
        [/have_unit]
        [then]
            {GURU_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=Mwc_Guru
    [/filter]
    {GURU_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=Mwc_Guru
    [/filter]
    {GURU_MENU}
[/event]

[+abilities]
#enddef

#define GURU_MENU
    {SUMMON_MENU_ITEM MWC_guru_menu (Golem) 24 Mwc_Guru (Mwc_Magic Golem)}
#enddef




#define ABILITY_MWC_MEGACIRCLE
    [regenerate]
        value=4
        id=healing_mwc
        name= _ "megacircle"
        description= _ "This unit owns powerful magic circle which affects all units inside. All friendly units fight better (+55%, +40%, +25%, +15%, +5% - lvl 0, 1, 2, 3, 4), are healed by 4 points and regenerate themselves (+4)."
        affect_self=yes
        poison=cured
    [/regenerate]
    [heals]
        value=4
        id=healing_mwc
        affect_allies=yes
        affect_self=no
        poison=slowed
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/heals]
    [heals]
        id=curing
        affect_allies=yes
        affect_self=no
        poison=cured
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/heals]
    [leadership]
        id=leadership
        value=55
        cumulative=no
        affect_allies=yes
        affect_self=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=40
        cumulative=no
        affect_allies=yes
        affect_self=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=25
        cumulative=no
        affect_allies=yes
        affect_self=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=15
        cumulative=no
        affect_allies=yes
        affect_self=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=5
        cumulative=no
        affect_allies=yes
        affect_self=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=4
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef


#define WEAPON_SPECIAL_BANISH
    [damage]
        id=banish
        name= _ "banish"
        name_inactive= _ "banish"
        description=_ "If a Banisher hits an enemy elemental unit, the enemy will turn into a DG 'Dimensional Gate', (this happens only if the target is exactly one level below the banisher). If the enemy is at least two levels below your banisher, it'll get completely destroyed. Any other enemy won't be affected."
        description_inactive= _ "If a Banisher hits an enemy elemental unit, the enemy will turn into a DG 'Dimensional Gate', (this happens only if the target is exactly one level below the banisher). If the enemy is at least two levels below your banisher, it'll get completely destroyed. Any other enemy won't be affected."
    [/damage]
#enddef

#define BANISHER_EVENT
    [event]
        first_time_only=no
        name=attacker hits
        [filter]
            type=Mwc_Dispeller,Mwc_Banisher
        [/filter]
        [filter_attack]
            name=banishment
        [/filter_attack]
        [filter_second]
            race=Mwc_elemental
        [/filter_second]

        [if]
            [have_unit]
                race=Mwc_elemental
                x,y=$x2,$y2
                level=1
            [/have_unit]
            [and]
                [have_unit]
                    x,y=$x1,$y1
                    level=2
                [/have_unit]
            [/and]
            [then]
                {ADVANCE_UNIT x,y=$x2,$y2 (Mwc_Dimensional Gate)}
                [store_unit]
                    [filter]
                        x,y=$x2,$y2
                    [/filter]
                    variable=dg
                    kill=yes
                [/store_unit]
                {VARIABLE dg.attacks_left 0}
                {VARIABLE dg.moves 0}
                [unstore_unit]
                    variable=dg
                    find_vacant=no
                [/unstore_unit]
                #{CLEAR_VARIABLE dg}
            [/then]
            [else]
                [if]
                    [have_unit]
                        race=Mwc_elemental
                        x,y=$x2,$y2
                        level=1,0
                    [/have_unit]
                    [and]
                        [have_unit]
                            x,y=$x1,$y1
                            level=3
                        [/have_unit]
                    [/and]
                    [then]
                        [kill]
                            x,y=$x2,$y2
                            animate=yes
                        [/kill]
                    [/then]
                    [else]
                        [if]
                            [have_unit]
                                race=Mwc_elemental
                                x,y=$x2,$y2
                                level=2
                            [/have_unit]
                            [and]
                                [have_unit]
                                    x,y=$x1,$y1
                                    level=3
                                [/have_unit]
                            [/and]
                            [then]
                                {ADVANCE_UNIT x,y=$x2,$y2 (Mwc_Greater Dimensional Gate)}
                                [store_unit]
                                    [filter]
                                        x,y=$x2,$y2
                                    [/filter]
                                    variable=dg
                                    kill=yes
                                [/store_unit]
                                {VARIABLE dg.attacks_left 0}
                                {VARIABLE dg.moves 0}
                            [/then]
                            [else]
                                [if]
                                    [have_unit]
                                        race=Mwc_elemental
                                        x,y=$x2,$y2
                                        level=0
                                    [/have_unit]
                                    [and]
                                        [have_unit]
                                            x,y=$x1,$y1
                                            level=2,3
                                        [/have_unit]
                                    [/and]
                                    [then]
                                        [kill]
                                            x,y=$x2,$y2
                                            animate=no
                                        [/kill]
                                    [/then]
                                [/if]
                            [/else]
                        [/if]
                    [/else]
                [/if]
            [/else]
        [/if]
    [/event]
    [event]
        first_time_only=no
        name=attack end
        [if]
            [variable]
                name=dg.length
                greater_than=0
            [/variable]
            [then]
                [unstore_unit]
                    variable=dg
                    find_vacant=no
                [/unstore_unit]
                {CLEAR_VARIABLE dg}
            [/then]
        [/if]
    [/event]
#enddef


#define ABILITY_CIRCLERES
    [resistance]
        id=cr
        add=20
        max_value=100
        apply_to=fire,cold,arcane
        name= _ "circle of resistance"
        description= _ "This unit and all adjacent friendly units receive a +20% bonus to fire, cold and arcane resistance."
        affect_self=yes
        affect_allies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef

#define ABILITY_CIRCLE_OF_BANISHMENT
    [leadership]
        id=cob
        value=-40
        cumulative=no
        name= _ "circle of banishment"
        description= _ "This unit can affect enemy elemental units that are next to it, making them fight worse. Adjacent enemy elemental units of lower level will do less damage in battle. When a unit adjacent to, of the same level, or a lower level than, and is an enemy of the unit with Circle of Banishment engages in combat, its attacks do less damage (-40% lvl0, -30% lvl1, -15% lvl2, -10% lvl3)."
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=0
                race=Mwc_elemental
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-30
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=1
                race=Mwc_elemental
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-15
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=2
                race=Mwc_elemental
            [/filter]
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=terror
        value=-10
        cumulative=no
        affect_self=no
        affect_allies=no
        affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                level=3
                race=Mwc_elemental
            [/filter]
        [/affect_adjacent]
    [/leadership]
#enddef


#define WEAPON_SPECIAL_MARKSMAN_GREATER
    # Canned definition of the Marksman greater ability to be included in a
    # [specials] clause.
    [chance_to_hit]
        id=marksman greater
        name= _ "marksman greater"
        description= _ "When used offensively, this attack always has at least a 70% chance to hit."
        value=70
        cumulative=yes
        active_on=offense
    [/chance_to_hit]
#enddef








#define WEAPON_SPECIAL_MARKSMAN_GREATER_DEFENSE
    # Canned definition of the Marksman greater defense ability to be included in a
    # [specials] clause.
    [chance_to_hit]
        id=marksman greater defense
        name= _ "marksman greater defense"
        description= _ "When used offensively, this attack always has at least a 70% chance to hit."
        value=70
        cumulative=yes
        active_on=defense
    [/chance_to_hit]
#enddef

#define WEAPON_SPECIAL_PRECISION
    # Canned definition of the Precision ability to be included in a
    # [specials] clause.
    [chance_to_hit]
        id=precision
        name= _ "precision"
        description= _ "When used offensively, this attack always has at least a 80% chance to hit."
        value=80
        cumulative=yes
        active_on=offense
    [/chance_to_hit]
#enddef

#define WEAPON_SPECIAL_CURSED_MWC
    # Canned definition of the Plague ability to be included in a
    # [specials] clause.
    [plague]
        id=plague(Mwc_Demon Cursed)
        name= _ "curse"
        description= _ "When a unit is killed by a curse attack, that unit is replaced with a Cursed on the same side as the unit with the Plague attack. This doesn't work on Undead or units in villages."
        type=Mwc_Demon Cursed
    [/plague]
#enddef

#define EVENT_DEADLYSTRIKE
    [if]
        [have_unit]
            x,y=$x2,$y2
            [not]
                side=side_number
            [/not]
        [/have_unit]
        [then]
            [if]
                [variable]
                    name=unit.level
                    greater_than=$second_unit.level
                [/variable]
                [then]
                    [set_variable]
                        name=leveldiff
                        value=$unit.level
                    [/set_variable]
                    [set_variable]
                        name=leveldiff
                        add=-$second_unit.level
                    [/set_variable]
                    [set_variable]
                        name=random
                        rand=1..100
                    [/set_variable]
                    [set_variable]
                        name=limit
                        value=5
                    [/set_variable]
                    [set_variable]
                        name=limit
                        multiply=$leveldiff
                    [/set_variable]
                    [if]
                        [variable]
                            name=random
                            less_than_equal_to=$limit
                        [/variable]
                        [then]
                            [set_variable]
                                name=exp
                                value=8
                            [/set_variable]
                            [set_variable]
                                name=exp
                                multiply=$second_unit.level
                            [/set_variable]
                            [set_variable]
                                name=exp
                                add=-$second_unit.level
                            [/set_variable]
                            [if]
                                [variable]
                                    name=exp
                                    numerical_equals=0
                                [/variable]
                                [then]
                                    [set_variable]
                                        name=exp
                                        value=4
                                    [/set_variable]
                                [/then]
                            [/if]
                            [unstore_unit]
                                variable=second_unit
                                red=255
                                text= _ "mortal hit"
                                find_vacant=no
                            [/unstore_unit]
                            [kill]
                                x,y=$x2,$y2
                                animate=yes
                            [/kill]
                            [set_variable]
                                name=unit.experience
                                add=$exp
                            [/set_variable]
                            [unstore_unit]
                                variable=unit
                            [/unstore_unit]
                        [/then]
                    [/if]
                    [clear_variable]
                        name=random
                    [/clear_variable]
                    [clear_variable]
                        name=leveldiff
                    [/clear_variable]
                    [clear_variable]
                        name=exp
                    [/clear_variable]
                    [clear_variable]
                        name=limit
                    [/clear_variable]
                [/then]
            [/if]
        [/then]
    [/if]
#enddef

#define RANDOM_PORTRAIT
	[set_variable]
		name=PickPortrait
		rand=1..91
	[/set_variable]
	[switch]
		variable=PickPortrait
		[case]
			value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55
			{RANDOM_PORTRAIT_DEFAULT}
		[/case]
		[case]
			value=56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91
			{RANDOM_PORTRAIT_WOTG}
		[/case]
	[/switch]
#enddef

#define RANDOM_PORTRAIT_DEFAULT
	{VARIABLE_OP RandomPortraitDefault rand ("portraits/drakes/transparent/blademaster.png,portraits/drakes/transparent/burner.png,portraits/drakes/transparent/clasher.png,portraits/drakes/transparent/enforcer.png,portraits/drakes/transparent/fighter.png,portraits/drakes/transparent/flameheart.png,portraits/drakes/transparent/glider.png,portraits/drakes/transparent/hurricane.png,portraits/drakes/transparent/inferno.png,portraits/drakes/transparent/warden.png,portraits/dwarves/transparent/dragonguard.png,portraits/dwarves/transparent/explorer.png,portraits/dwarves/transparent/fighter.png,portraits/dwarves/transparent/fighter-2.png,portraits/dwarves/transparent/gryphon-rider.png,portraits/dwarves/transparent/guard.png,portraits/dwarves/transparent/lord.png,portraits/dwarves/transparent/runemaster.png,portraits/dwarves/transparent/scout.png,portraits/dwarves/transparent/sentinel.png,portraits/dwarves/transparent/thunderer.png,portraits/dwarves/transparent/ulfserker.png,portraits/elves/transparent/archer.png,portraits/elves/transparent/archer+female.png,portraits/elves/transparent/captain.png,portraits/elves/transparent/druid.png,portraits/elves/transparent/fighter.png,portraits/elves/transparent/hero.png,portraits/elves/transparent/high-lord.png,portraits/elves/transparent/lady.png,portraits/elves/transparent/lord.png,portraits/elves/transparent/lord.png,portraits/elves/transparent/marksman.png,portraits/elves/transparent/marksman+female.png,portraits/elves/transparent/ranger.png,portraits/elves/transparent/ranger+female.png,portraits/elves/transparent/scout.png,portraits/elves/transparent/shaman.png,portraits/elves/transparent/shyde.png,portraits/elves/transparent/sorceress.png,portraits/elves/transparent/sylph.png,portraits/goblins/transparent/direwolver.png,portraits/goblins/transparent/impaler.png,portraits/goblins/transparent/pillager.png,portraits/goblins/transparent/rouser.png,portraits/goblins/transparent/rouser-2.png,portraits/goblins/transparent/spearman.png,portraits/goblins/transparent/spearman-2.png,portraits/goblins/transparent/wolf-rider.png,portraits/humans/transparent/assassin.png,portraits/humans/transparent/assassin+female.png,portraits/humans/transparent/bandit.png,portraits/humans/transparent/bowman.png,portraits/humans/transparent/cavalier.png,portraits/humans/transparent/cavalryman.png,portraits/humans/transparent/dark-adept.png,portraits/humans/transparent/dark-adept+female.png,portraits/humans/transparent/duelist.png,portraits/humans/transparent/fencer.png,portraits/humans/transparent/footpad.png,portraits/humans/transparent/footpad+female.png,portraits/humans/transparent/general.png,portraits/humans/transparent/grand-knight.png,portraits/humans/transparent/grand-knight-2.png,portraits/humans/transparent/halberdier.png,portraits/humans/transparent/heavy-infantry.png,portraits/humans/transparent/horseman.png,portraits/humans/transparent/huntsman.png,portraits/humans/transparent/iron-mauler.png,portraits/humans/transparent/javelineer.png,portraits/humans/transparent/knight.png,portraits/humans/transparent/lancer.png,portraits/humans/transparent/lieutenant.png,portraits/humans/transparent/longbowman.png,portraits/humans/transparent/mage.png,portraits/humans/transparent/mage+female.png,portraits/humans/transparent/mage-arch.png,portraits/humans/transparent/mage-arch+female.png,portraits/humans/transparent/mage-light.png,portraits/humans/transparent/mage-light+female.png,portraits/humans/transparent/mage-red.png,portraits/humans/transparent/mage-red+female.png,portraits/humans/transparent/mage-silver.png,portraits/humans/transparent/mage-silver+female.png,portraits/humans/transparent/mage-white.png,portraits/humans/transparent/mage-white+female.png,portraits/humans/transparent/marshal.png,portraits/humans/transparent/marshal-2.png,portraits/humans/transparent/master-at-arms.png,portraits/humans/transparent/master-bowman.png,portraits/humans/transparent/necromancer.png,portraits/humans/transparent/necromancer+female.png,portraits/humans/transparent/outlaw.png,portraits/humans/transparent/outlaw+female.png,portraits/humans/transparent/paladin.png,portraits/humans/transparent/peasant.png,portraits/humans/transparent/pikeman.png,portraits/humans/transparent/ranger.png,portraits/humans/transparent/royal-guard.png,portraits/humans/transparent/ruffian.png,portraits/humans/transparent/sergeant.png,portraits/humans/transparent/spearman.png,portraits/humans/transparent/swordsman.png,portraits/humans/transparent/swordsman-2.png,portraits/humans/transparent/swordsman-3.png,portraits/humans/transparent/thief.png,portraits/humans/transparent/thief+female.png,portraits/humans/transparent/thug.png,portraits/humans/transparent/trapper.png,portraits/humans/transparent/woodsman.png,portraits/khalifate/transparent/hakim.png,portraits/merfolk/transparent/enchantress.png,portraits/merfolk/transparent/fighter.png,portraits/merfolk/transparent/hoplite.png,portraits/merfolk/transparent/hunter.png,portraits/merfolk/transparent/initiate.png,portraits/merfolk/transparent/initiate-2.png,portraits/merfolk/transparent/netcaster.png,portraits/merfolk/transparent/priestess.png,portraits/merfolk/transparent/spearman.png,portraits/merfolk/transparent/triton.png,portraits/monsters/transparent/bat.png,portraits/monsters/transparent/giant-mudcrawler.png,portraits/monsters/transparent/gryphon.png,portraits/monsters/transparent/ogre.png,portraits/monsters/transparent/scorpion.png,portraits/monsters/transparent/sea-serpent.png,portraits/nagas/transparent/fighter.png,portraits/nagas/transparent/myrmidon.png,portraits/orcs/transparent/archer.png,portraits/orcs/transparent/assassin.png,portraits/orcs/transparent/crossbowman.png,portraits/orcs/transparent/grunt.png,portraits/orcs/transparent/grunt-2.png,portraits/orcs/transparent/grunt-3.png,portraits/orcs/transparent/grunt-4.png,portraits/orcs/transparent/grunt-5.png,portraits/orcs/transparent/grunt-6.png,portraits/orcs/transparent/leader.png,portraits/orcs/transparent/leader-2.png,portraits/orcs/transparent/slayer.png,portraits/orcs/transparent/slurbow.png,portraits/orcs/transparent/sovereign.png,portraits/orcs/transparent/warlord.png,portraits/orcs/transparent/warrior.png,portraits/saurians/transparent/augur.png,portraits/saurians/transparent/skirmisher.png,portraits/trolls/transparent/troll.png,portraits/trolls/transparent/whelp.png,portraits/undead/transparent/archer.png,portraits/undead/transparent/banebow.png,portraits/undead/transparent/bone-shooter.png,portraits/undead/transparent/deathblade.png,portraits/undead/transparent/death-knight.png,portraits/undead/transparent/draug.png,portraits/undead/transparent/draug-2.png,portraits/undead/transparent/ghost.png,portraits/undead/transparent/ghoul.png,portraits/undead/transparent/lich.png,portraits/undead/transparent/nightgaunt.png,portraits/undead/transparent/revenant.png,portraits/undead/transparent/shadow.png,portraits/undead/transparent/skeleton.png,portraits/undead/transparent/spectre.png,portraits/woses/transparent/ancient-wose.png")}
#enddef

#define RANDOM_PORTRAIT_WOTG
	{VARIABLE_OP RandomPortraitDefault rand ("portraits/drakes/akrinas.png,portraits/drakes/dragon_body.png,portraits/drakes/kasii.png,portraits/drakes/kratemaqth.png,portraits/drakes/lord.png,portraits/drakes/sword.png,portraits/drakes/wyngilla.png,portraits/dwarves/aiglondur.png,portraits/dwarves/angarthing.png,portraits/dwarves/dulcatulos.png,portraits/dwarves/dwarves_king.png,portraits/dwarves/karrag.png,portraits/elves/transparent/bloodymage.png,portraits/elves/transparent/deathelven_berserker.png,portraits/elves/transparent/deathelven_hunter.png,portraits/elves/transparent/deathelven_sorcerer.png,portraits/elves/transparent/elvish_marshal.png,portraits/elves/transparent/halberdier.png,portraits/elves/transparent/logalmier.png,portraits/goblins/transparent/goblinwarbanner.png,portraits/human-betrayer/transparent/bloodknight.png,portraits/human-loyalists/captain.png,portraits/human-loyalists/gerrick_HRa.png,portraits/human-loyalists/konrad.png,portraits/human-loyalists/lisar.png,portraits/human-outlaws/transparent/bresda.png,portraits/human-outlaws/transparent/bresda-heroine.png,portraits/merfolk/transparent/kai_krellis.png,portraits/merfolk/transparent/kai_krellis2.png,portraits/merfolk/transparent/brawler.png,portraits/monsters/ares.png,portraits/monsters/Devil 2.png,portraits/monsters/Devil.png,portraits/monsters/dharmarashti.png,portraits/monsters/dog.png,portraits/monsters/dogface.png,portraits/monsters/driver.png,portraits/monsters/echidna.png,portraits/monsters/echidna-low.png,portraits/monsters/echidna-mid.png,portraits/monsters/firewheel.png,portraits/monsters/horashti.png,portraits/monsters/katoblepon.png,portraits/monsters/nightmare.png,portraits/monsters/ophis.png,portraits/monsters/prokyon.png,portraits/monsters/protector.png,portraits/monsters/rashti.png,portraits/monsters/seth.png,portraits/monsters/slowfoot.png,portraits/monsters/striker.png,portraits/monsters/swift.png,portraits/monsters/timber-wolf.png,portraits/monsters/truerashti.png,portraits/monsters/war-dog.png,portraits/monsters/wheel.png,portraits/monsters/yak.png,portraits/monsters/yeti.png,portraits/monsters/transparent/nailers.png,portraits/monsters/transparent/overgrown.png,portraits/nagas/transparent/naga-with-bow.png,portraits/orcs/young_orcish_shaman.png,portraits/orcs/orcish_shaman.png,portraits/orcs/old_orcish_shaman.png,portraits/orcs/grunt-6.png,portraits/saurians/saurian-sage.png,portraits/trolls/trollhero.png,portraits/trolls/trollshaman.png,portraits/trolls/trollthrower.png,portraits/undead/BoneDrake.png,portraits/undead/transparent/bloodborn.png,portraits/undead/transparent/blood-hulk.png,portraits/undead/transparent/duchess.png,portraits/undead/transparent/familiar.png,portraits/undead/transparent/fledgeling.png,portraits/undead/transparent/flesh-artisan.png,portraits/undead/transparent/noble.png,portraits/undead/transparent/sword-dancer.png,portraits/drakes/kratemaqht.png,portraits/drakes/akrinas.png,portraits/drakes/kozmo.png,portraits/human-betreyar/transparent/Argan.png,portraits/human-betreyar/transparent/invader.png,portraits/human-betreyar/transparent/dark-knight.png,portraits/human-betreyar/transparent/bloodknight.png,portraits/monsters/transparent/lava-behemoth.png,portraits/monsters/transparent/lava-elemental.png,portraits/monsters/transparent/minor-lava-elemental.png,portraits/trolls/whitetroll.png")}
#enddef




#define ABILITY_MWC_SHIELDSBREAKER_WEAKER
    [resistance]
        id=mwc_shieldsbreaker_weaker
        add=-10
        min_value=-1000
		max_value=101
        [filter_base_value]
            greater_than=-1001
            less_than=101
        [/filter_base_value]
        name= _ "shieldsbreaker weaker"
        female_name= _ "female^shieldsbreaker weaker"
        description= _ "This unit can decrease adjected enemies resistances by 10%, while offense."
        affect_self=no
		affect_allies=no
		affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef


#define ABILITY_MWC_SHIELDSBREAKER
    [resistance]
        id=mwc_shieldsbreaker
        add=-15
        min_value=-1000
		max_value=101
        [filter_base_value]
            greater_than=-1001
            less_than=101
        [/filter_base_value]
        name= _ "shieldsbreaker"
        female_name= _ "female^shieldsbreaker"
        description= _ "This unit can decrease adjected enemies resistances by 15%, while offense."
        affect_self=no
		affect_allies=no
		affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef


#define ABILITY_MWC_SHIELDSBREAKER_STRONGER
    [resistance]
        id=mwc_shieldsbreaker_stronger
        add=-20
        min_value=-1000
		max_value=101
        [filter_base_value]
            greater_than=-1001
            less_than=101
        [/filter_base_value]
        name= _ "shieldsbreaker stronger"
        female_name= _ "female^shieldsbreaker stronger"
        description= _ "This unit can decrease adjected enemies resistances by 20%, while offense."
        affect_self=no
		affect_allies=no
		affect_enemies=yes
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/resistance]
#enddef






#define ABILITY_MWC_DIG
    [dummy]
        id=MWC_dig
        name= _ "dig"
        description= _ "This unit can dig in cave walls (when this unit have atleast 3 mp, each dig takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_dig
        [/have_unit]
        [then]
            {DIG_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_dig
    [/filter]
    {DIG_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_dig
    [/filter]
    {DIG_MENU}
[/event]

[+abilities]
#enddef

#define DIG_MENU
    {DIG_MENU_ITEM}
#enddef


#define DIG_DIGGING
	[set_variable]
		name=random_dummy_dig
		rand=1..50
	[/set_variable]
	[switch]
		variable=random_dummy_dig
		[case]
			value=1,2,3,4,5,6,7,8
			[terrain]
				x,y=$x1,$y1
				terrain=Uu
			[/terrain]
		[/case]
		[case]
			value=9,10,11,12,13,14,15,16
			[terrain]
				x,y=$x1,$y1
				terrain=Uue
			[/terrain]
		[/case]
		[case]
			value=17,18,19,20,21,22
			[terrain]
				x,y=$x1,$y1
				terrain=Ur
			[/terrain]
		[/case]
		[case]
			value=23,24,25,26,27,28
			[terrain]
				x,y=$x1,$y1
				terrain=Urb
			[/terrain]
		[/case]
		[case]
			value=29,30,31,32,33
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Uf
			[/terrain]
		[/case]
		[case]
			value=34,35,36,37,38
			[terrain]
				x,y=$x1,$y1
				terrain=Uh
			[/terrain]
		[/case]
		[case]
			value=39
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Vud
			[/terrain]
		[/case]
		[case]
			value=40
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Vu
			[/terrain]
		[/case]
		[case]
			value=41,42,43,44
			[terrain]
				x,y=$x1,$y1
				terrain=Cud
			[/terrain]
		[/case]
		[case]
			value=45,46,47
			[terrain]
				x,y=$x1,$y1
				terrain=Wwf
			[/terrain]
		[/case]
		[case]
			value=48,49,50
			[terrain]
				x,y=$x1,$y1
				terrain=Sm
			[/terrain]
		[/case]
	[/switch]
	{CLEAR_VARIABLE random_dummy_dig}
#enddef

#define DIG_MENU_ITEM
    [set_menu_item]
        id=MWC_dig_menu
        description= _ "dig"
        [show_if]
        [/show_if]

        [filter_location]
            [filter_adjacent_location]
                [filter]
                    ability=MWC_dig
                    side=$side_number
                    #[filter_wml]
                    #    moves=$this_unit.max_moves
                    #[/filter_wml]	
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
                [/filter]
            [/filter_adjacent_location]
			terrain=X*,X*^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[unit]
			    type=Mwc_Peasant
			    side=$side_number
			    x,y=$x1,$y1
			    moves=0
			    animate=no
			[/unit]
			{DIG_DIGGING}
			
			[store_unit]
				[filter]
					[filter_adjacent]
						x,y=$x1,$y1
					[/filter_adjacent]
					ability=MWC_dig
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_dig
			[/store_unit]
			{FOREACH able_to_dig a}
				[set_variable]
					name=able_to_dig[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_dig[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_dig[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_dig[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_dig}
			{NEXT a}
			[kill]
				type=Mwc_Peasant
				x,y=$x1,$y1
				animate=no
			[/kill]
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_2_dig_zhelp
        description= _ "Dig Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_dig
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To dig a unit right-click on adjacent hexes near a selected diger.
                    
You need atleast 3 movement points to dig in cave walls(each dig takes all mp).
Every digging adds +1 to current experience.

If there are 2 or more diggers, cave will be digged by the last selected unit able to dig."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef




#define DIG_MWC_DIGGING
	[set_variable]
		name=random_dummy_dig
		rand=1..50
	[/set_variable]
	[switch]
		variable=random_dummy_dig
		[case]
			value=1,2,3,4,5,6,7,8
			[terrain]
				x,y=$x1,$y1
				terrain=Uu
			[/terrain]
		[/case]
		[case]
			value=9,10,11,12,13,14,15,16
			[terrain]
				x,y=$x1,$y1
				terrain=Uue
			[/terrain]
		[/case]
		[case]
			value=17,18,19,20,21,22
			[terrain]
				x,y=$x1,$y1
				terrain=Ur
			[/terrain]
		[/case]
		[case]
			value=23,24,25,26,27,28
			[terrain]
				x,y=$x1,$y1
				terrain=Urb
			[/terrain]
		[/case]
		[case]
			value=29,30,31,32,33
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Uf
			[/terrain]
		[/case]
		[case]
			value=34,35,36,37,38
			[terrain]
				x,y=$x1,$y1
				terrain=Uh
			[/terrain]
		[/case]
		[case]
			value=39
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Vud
			[/terrain]
		[/case]
		[case]
			value=40
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Vu
			[/terrain]
		[/case]
		[case]
			value=41,42,43,44
			[terrain]
				x,y=$x1,$y1
				terrain=Cud
			[/terrain]
		[/case]
		[case]
			value=45,46,47
			[terrain]
				x,y=$x1,$y1
				terrain=Wwf
			[/terrain]
		[/case]
		[case]
			value=48,49,50
			[terrain]
				x,y=$x1,$y1
				terrain=Sm
			[/terrain]
		[/case]
	[/switch]
	{CLEAR_VARIABLE random_dummy_dig}
#enddef



#define ABILITY_MWC_FARM
    [dummy]
        id=MWC_farm
        name= _ "farm"
        description= _ "This unit can farm, but first it have to change flat terrain for it (when this unit have atleast 3 mp, each farm takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_farm
        [/have_unit]
        [then]
            {FARM_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_farm
    [/filter]
    {FARM_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_farm
    [/filter]
    {FARM_MENU}
[/event]

[+abilities]
#enddef

#define FARM_MENU
    {FARM_MENU_ITEM}
    {FARM_MENU_2_ITEM}
    {FARM_MENU_3_ITEM}
	{FARM_MENU_4_ITEM}
#enddef



#define FARM_MENU_ITEM
    [set_menu_item]
        id=MWC_farm_menu
        description= _ "Sow field"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Rb
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg^Gvs
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm
			[/store_unit]
			{FOREACH able_to_farm a}
				[set_variable]
					name=able_to_farm[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_farm[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_farm[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_farm[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_farm_zhelp
        description= _ "Farm Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_farm
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To prepare field right-click on selected farmer.
                    
You need atleast 3 mp to prepare field, each prepare takes all mp.
Every preparing field adds +1 to current experience for farmer.

To sow field right-click on selected farmer(terrain have to be earlier prepared for it).
                    
You need atleast 3 mp to sow field, each sow takes all mp.
Every sowing adds +1 to current experience.

To pick harvest right-click on selected farmer.
                    
You need 3 mp to pick harvest, each pick takes all mp.
Every picking harvest adds +1 to current experience for farmer and 2 gold for your side.

To create flat right-click on selected farmer.
                    
You need atleast 3 mp and 5 gold to create flat, each create takes all mp.
Every creating flat terrain adds +1 to current experience for farmer."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define FARM_MENU_2_ITEM
    [set_menu_item]
        id=MWC_farm_2_menu
        description= _ "Pick harvest"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg^Gvs
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Rb
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm_2
			[/store_unit]
			{FOREACH able_to_farm_2 a}
				[set_variable]
					name=able_to_farm_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_farm_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_farm_2[$a].experience add 1}
				[gold]
					amount=2
					side=$side_number
				[/gold]

				
				[unstore_unit]
					variable=able_to_farm_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm_2}
			{NEXT a}
        [/command]
    [/set_menu_item]
#enddef


#define FARM_MENU_3_ITEM
    [set_menu_item]
        id=MWC_farm_3_menu
        description= _ "Prepare field"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Rb
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm_3
			[/store_unit]
			{FOREACH able_to_farm_3 a}
				[set_variable]
					name=able_to_farm_3[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_farm_3[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_farm_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_farm_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm_3}
			{NEXT a}
        [/command]
    [/set_menu_item]
#enddef



#define FARM_MENU_4_ITEM
    [set_menu_item]
        id=MWC_farm_4_menu
        description= _ "Create flat terrain"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Rb,Gg^Gvs,Rb^*,Dd,Ds,Dd^*,Ds^*,Uu,Uue,Uu^*,Uue^*,Ww,Wwg,Sm,Wwt,Wwf,Ss,Ww^*,Wwg^*,Sm^*,Wwt^*,Wwf^*,Ss^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm_4
			[/store_unit]
			{FOREACH able_to_farm_4 a}
				[set_variable]
					name=able_to_farm_4[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_farm_4[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_farm_4[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_farm_4[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm_4}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
#enddef



#define ABILITY_MWC_AFFORESTATION
    [dummy]
        id=MWC_afforestation
        name= _ "afforestation"
        description= _ "This unit can sow trees(when this unit have atleast 3 mp, each sow takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_afforestation
        [/have_unit]
        [then]
            {AFFORESTATION_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_afforestation
    [/filter]
    {AFFORESTATION_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_afforestation
    [/filter]
    {AFFORESTATION_MENU}
[/event]

[+abilities]
#enddef

#define AFFORESTATION_MENU
    {AFFORESTATION_MENU_ITEM}
    {AFFORESTATION_MENU_2_ITEM}
#enddef



#define AFFORESTATION_MENU_ITEM
    [set_menu_item]
        id=MWC_afforestation_menu
        description= _ "Sow trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_afforestation
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_forest
				rand=1..13
			[/set_variable]
			[switch]
				variable=random_dummy_forest
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Gg^Fet
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Ft
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fp
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fds
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fdf
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fdw
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fms
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fmf
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fmw
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fpa
					[/terrain]
				[/case]
				[case]
					value=11
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fda
					[/terrain]
				[/case]
				[case]
					value=12
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fma
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fetd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_forest}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_afforestation
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_afforestation
			[/store_unit]
			{FOREACH able_to_afforestation a}
				[set_variable]
					name=able_to_afforestation[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_afforestation[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_afforestation[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_afforestation[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_afforestation}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_afforestation_zhelp
        description= _ "Sow Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_afforestation
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To sow trees right-click on selected unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to sow trees, each sow takes all mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define AFFORESTATION_MENU_2_ITEM
    [set_menu_item]
        id=MWC_afforestation_2_menu
        description= _ "Sow trees on hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_afforestation
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Hh,Hd,Ha,Hhd,Uh,Hh^Ii,Hd^Ii,Ha^Ii,Hhd^Ii,Uh^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill_forest
				rand=1..10
			[/set_variable]
			[switch]
				variable=random_dummy_hill_forest
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fp
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fds
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fms
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fpa
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fda
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fma
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdf
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdw
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmf
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmw
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill_forest}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_afforestation
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_afforestation_2
			[/store_unit]
			{FOREACH able_to_afforestation_2 a}
				[set_variable]
					name=able_to_afforestation_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_afforestation_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_afforestation_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_afforestation_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_afforestation_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_afforestation_2_zhelp
        description= _ "Sow Trees On Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_afforestation
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To sow trees on hills right-click on selected unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to sow trees, each sow takes all mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_CUTTER
    [dummy]
        id=MWC_cutter
        name= _ "cut"
        description= _ "This unit can cut trees(when this unit have atleast 3 mp, each cut takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_cutter
        [/have_unit]
        [then]
            {CUTTER_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_cutter
    [/filter]
    {CUTTER_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_cutter
    [/filter]
    {CUTTER_MENU}
[/event]

[+abilities]
#enddef

#define CUTTER_MENU
    {CUTTER_MENU_ITEM}
    {CUTTER_MENU_2_ITEM}
#enddef



#define CUTTER_MENU_ITEM
    [set_menu_item]
        id=MWC_cutter_menu
        description= _ "Cut trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_cutter
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg^Fet,Gs^Ft,Gll^Fp,Gs^Fds,Gd^Fdf,Gs^Fdw,Gs^Fms,Gll^Fmf,Gd^Fmw,Gd^Fetd,Gs^Fp,G*^F*,Gg^F*,Gs^F*,Gll^F*,Gd^F*,Rd^F*,Rb^F*,Rrc^F*,Re^F*,Rr^F*,Rp^F*,Urb^F*,Iwr^F*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_cutter
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_cutter
			[/store_unit]
			{FOREACH able_to_cutter a}
				[set_variable]
					name=able_to_cutter[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_cutter[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_cutter[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_cutter[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_cutter}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_cutter_zhelp
        description= _ "Cut Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_cutter
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To cut trees right-click on selected cutter.
                    
You need atleast 3 mp (and 5 gold) to cut trees, each cut takes all mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define CUTTER_MENU_2_ITEM
    [set_menu_item]
        id=MWC_cutter_2_menu
        description= _ "Cut trees from hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_cutter
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Hh^F*,Hhd^F*,Ha^F*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill
				rand=1..5
			[/set_variable]
			[switch]
				variable=random_dummy_hill
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Uh
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Hd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_cutter
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_cutter_2
			[/store_unit]
			{FOREACH able_to_cutter_2 a}
				[set_variable]
					name=able_to_cutter_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_cutter_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_cutter_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_cutter_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_cutter_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_cutter_2_zhelp
        description= _ "Cut Trees From Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_cutter
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To cut trees from hills right-click on selected cutter.
                    
You need atleast 3 mp (and 5 gold) to cut trees from hills, each cut takes all mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_CRUSHER
    [dummy]
        id=MWC_crusher
        name= _ "crush"
        description= _ "This unit can crush impossible mountains,mountains,hills(when this unit have atleast 3 mp, each crush takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_crusher
        [/have_unit]
        [then]
            {CRUSHER_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_crusher
    [/filter]
    {CRUSHER_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_crusher
    [/filter]
    {CRUSHER_MENU}
[/event]

[+abilities]
#enddef

#define CRUSHER_MENU
    {CRUSHER_MENU_ITEM}
    {CRUSHER_MENU_2_ITEM}
    {CRUSHER_MENU_3_ITEM}
    {CRUSHER_MENU_4_ITEM}
#enddef



#define CRUSHER_MENU_ITEM
    [set_menu_item]
        id=MWC_crusher
        description= _ "Crush impossible mountains"
        [show_if]
        [/show_if]

        [filter_location]
            [filter_adjacent_location]
                [filter]
                    ability=MWC_crusher
                    side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
                [/filter]
            [/filter_adjacent_location]
			terrain=Mm^Xm,Ms^Xm,Md^Xm
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[unit]
			    type=Mwc_Peasant
			    side=$side_number
			    x,y=$x1,$y1
			    moves=0
			    animate=no
			[/unit]
			[set_variable]
				name=random_dummy_mountain
				rand=1..3
			[/set_variable]
			[switch]
				variable=random_dummy_mountain
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Mm
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Ms
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Md
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_mountain}
			
			[store_unit]
				[filter]
					[filter_adjacent]
						x,y=$x1,$y1
					[/filter_adjacent]
					ability=MWC_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher
			[/store_unit]
			{FOREACH able_to_crusher a}
				[set_variable]
					name=able_to_crusher[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_crusher[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_crusher[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher}
			{NEXT a}
			[kill]
				type=Mwc_Peasant
				x,y=$x1,$y1
				animate=no
			[/kill]
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_crusher_zhelp
        description= _ "Crush Impossible Mountains Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a impossible mountains right-click on adjacent hexes near a selected crusher.
                    
You need atleast 3 mp (and 5 gold) to crush impossible mountains, each crush takes all mp.
Every crushing adds +1 to current experience.

If there are 2 or more crushers, impossible mountain will be crushed by the last selected unit able to crush."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define CRUSHER_MENU_2_ITEM
    [set_menu_item]
        id=MWC_2_crusher
        description= _ "Crush mountains"
        [show_if]
        [/show_if]

        [filter_location]
            [filter_adjacent_location]
                [filter]
                    ability=MWC_crusher
                    side=$side_number
                    #[filter_wml]
                    #    moves=$this_unit.max_moves
                    #[/filter_wml]	
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
                [/filter]
            [/filter_adjacent_location]
			terrain=Mm,Ms,Md
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[unit]
			    type=Mwc_Peasant
			    side=$side_number
			    x,y=$x1,$y1
			    moves=0
			    animate=no
			[/unit]
			[set_variable]
				name=random_dummy_hill
				rand=1..5
			[/set_variable]
			[switch]
				variable=random_dummy_hill
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Uh
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Hd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill}
			
			[store_unit]
				[filter]
					[filter_adjacent]
						x,y=$x1,$y1
					[/filter_adjacent]
					ability=MWC_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher_2
			[/store_unit]
			{FOREACH able_to_crusher_2 a}
				[set_variable]
					name=able_to_crusher_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_crusher_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_crusher_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher_2}
			{NEXT a}
			[kill]
				type=Mwc_Peasant
				x,y=$x1,$y1
				animate=no
			[/kill]
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_crusher_2_zhelp
        description= _ "Crush Mountains Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a mountains right-click on adjacent hexes near a selected crusher.
                    
You need atleast 3 mp (and 5 gold) to crush mountains, each crush takes all mp.
Every crushing adds +1 to current experience.

If there are 2 or more crushers, mountain will be crushed by the last selected unit able to crush."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define CRUSHER_MENU_3_ITEM
    [set_menu_item]
        id=MWC_3_crusher
        description= _ "Crush hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_crusher
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ha,Hh,Hhd,Hd,Uh,Ha^Ii,Hh^Ii,Hhd^Ii,Hd^Ii,Uh^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_flat
				rand=1..9
			[/set_variable]
			[switch]
				variable=random_dummy_flat
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Gll
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Gd
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Gg
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Gs
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Ds
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Dd
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Uu
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Uue
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Aa
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_flat}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher_3
			[/store_unit]
			{FOREACH able_to_crusher_3 a}
				[set_variable]
					name=able_to_crusher_3[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_crusher_3[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_crusher_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher_3}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_crusher_3_zhelp
        description= _ "Crush Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a hills right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to crush hills, each crush takes all mp.
Every crushing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define CRUSHER_MENU_4_ITEM
    [set_menu_item]
        id=MWC_4_crusher
        description= _ "Crush hills/trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_crusher
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ha^*,Hh^*,Hhd^*
			[and]
				[not]
					terrain=Ha^Vhha,Hh^Vhh,Hhd^Vhhr
				[/not]
			[/and]
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_forest
				rand=1..13
			[/set_variable]
			[switch]
				variable=random_dummy_forest
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Gg^Fet
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Ft
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fp
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fds
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fdf
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fdw
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fms
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fmf
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fmw
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fpa
					[/terrain]
				[/case]
				[case]
					value=11
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fda
					[/terrain]
				[/case]
				[case]
					value=12
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fma
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fetd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_forest}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher_4
			[/store_unit]
			{FOREACH able_to_crusher_4 a}
				[set_variable]
					name=able_to_crusher_4[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_crusher_4[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_crusher_4[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher_4[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher_4}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_crusher_4_zhelp
        description= _ "Crush Hills/Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a hills/trees right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to crush hills/trees, each crush takes all mp.
Every crushing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef

#define ABILITY_MWC_MUSHROOMS
    [dummy]
        id=MWC_mushrooms
        name= _ "mushrooms"
        description= _ "This unit can sow mushrooms in cave(when this unit have atleast 3 mp, each sow takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_mushrooms
        [/have_unit]
        [then]
            {MUSHROOMS_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_mushrooms
    [/filter]
    {MUSHROOMS_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_mushrooms
    [/filter]
    {MUSHROOMS_MENU}
[/event]

[+abilities]
#enddef

#define MUSHROOMS_MENU
    {MUSHROOMS_MENU_ITEM}
    {MUSHROOMS_MENU_2_ITEM}
#enddef


#define MUSHROOMS_MENU_ITEM
    [set_menu_item]
        id=MWC_mushrooms
        description= _ "Prepare cave"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_mushrooms
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_cave
				rand=1..2
			[/set_variable]
			[switch]
				variable=random_dummy_cave
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Uu
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Uue
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_cave}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_mushrooms
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_mushrooms
			[/store_unit]
			{FOREACH able_to_mushrooms a}
				[set_variable]
					name=able_to_mushrooms[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_mushrooms[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_mushrooms[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_mushrooms[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_mushrooms}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_mushrooms_zhelp
        description= _ "Prepare Cave Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_mushrooms
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To prepare cave on flat terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to prepare cave, each prepare takes all mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef

#define MUSHROOMS_MENU_2_ITEM
    [set_menu_item]
        id=MWC_2_mushrooms
        description= _ "Sow mushrooms"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_mushrooms
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Uu,Uue,Uu^*,Uue^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Uf
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_mushrooms
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]	
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_mushrooms_2
			[/store_unit]
			{FOREACH able_to_mushrooms_2 a}
				[set_variable]
					name=able_to_mushrooms_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_mushrooms_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_mushrooms_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_mushrooms_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_mushrooms_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_mushrooms_2_zhelp
        description= _ "Sow Mushrooms Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_mushrooms
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To sow mushrooms in cave right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to sow mushrooms, each sow takes all mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_DESERT
    [dummy]
        id=MWC_desert
        name= _ "burn"
        description= _ "This unit can create desert by burning terrain on flat(when this unit have atleast 3 mp, each burn takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_desert
        [/have_unit]
        [then]
            {DESERT_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_desert
    [/filter]
    {DESERT_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_desert
    [/filter]
    {DESERT_MENU}
[/event]

[+abilities]
#enddef

#define DESERT_MENU
    {DESERT_MENU_ITEM}
    {DESERT_MENU_2_ITEM}
#enddef


#define DESERT_MENU_ITEM
    [set_menu_item]
        id=MWC_desert
        description= _ "Burn terrain"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_desert
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_desert
				rand=1..14
			[/set_variable]
			[switch]
				variable=random_dummy_desert
				[case]
					value=1,2,3,4,5,6
					[terrain]
						x,y=$x1,$y1
						terrain=Ds
					[/terrain]
				[/case]
				[case]
					value=7,8,9,10,11,12
					[terrain]
						x,y=$x1,$y1
						terrain=Dd
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Dd^Vdt
					[/terrain]
				[/case]
				[case]
					value=14
					[terrain]
						x,y=$x1,$y1
						terrain=Dd^Vda
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_desert}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_desert
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]	
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_desert
			[/store_unit]
			{FOREACH able_to_desert a}
				[set_variable]
					name=able_to_desert[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_desert[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_desert[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_desert[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_desert}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_desert_zhelp
        description= _ "Burn Terrain Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_desert
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To burn terrain on flat terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to burn terrain, each burn takes all mp.
Every burning adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef

#define DESERT_MENU_2_ITEM
    [set_menu_item]
        id=MWC_2_desert
        description= _ "Dissolve the ice"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_desert
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Aa,Aa^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_desert
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_desert_2
			[/store_unit]
			{FOREACH able_to_desert_2 a}
				[set_variable]
					name=able_to_desert_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_desert_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_desert_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_desert_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_desert_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_desert_2_zhelp
        description= _ "Dissolve Ice Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_desert
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To dissolve ice right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to dissolve ice, each dissolve takes all mp.
Every dissolving adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_WATER
    [dummy]
        id=MWC_water
        name= _ "pour"
        description= _ "This unit can create water terrain by pour flat terrain(when this unit have atleast 3 mp, each pour all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_water
        [/have_unit]
        [then]
            {WATER_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_water
    [/filter]
    {WATER_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_water
    [/filter]
    {WATER_MENU}
[/event]

[+abilities]
#enddef

#define WATER_MENU
    {WATER_MENU_ITEM}
#enddef


#define WATER_MENU_ITEM
    [set_menu_item]
        id=MWC_water
        description= _ "Pour"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_water
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Aa,Aa^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_water
				rand=1..14
			[/set_variable]
			[switch]
				variable=random_dummy_water
				[case]
					value=1,2
					[terrain]
						x,y=$x1,$y1
						terrain=Ss
					[/terrain]
				[/case]
				[case]
					value=3,4
					[terrain]
						x,y=$x1,$y1
						terrain=Wwf
					[/terrain]
				[/case]
				[case]
					value=5,6
					[terrain]
						x,y=$x1,$y1
						terrain=Wwt
					[/terrain]
				[/case]
				[case]
					value=7,8
					[terrain]
						x,y=$x1,$y1
						terrain=Sm
					[/terrain]
				[/case]
				[case]
					value=9,10
					[terrain]
						x,y=$x1,$y1
						terrain=Wwg
					[/terrain]
				[/case]
				[case]
					value=11,12
					[terrain]
						x,y=$x1,$y1
						terrain=Ww
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Ss^Vhs
					[/terrain]
				[/case]
				[case]
					value=14
					[terrain]
						x,y=$x1,$y1
						terrain=Ww^Vm
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_water}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_water
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_water
			[/store_unit]
			{FOREACH able_to_water a}
				[set_variable]
					name=able_to_water[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_water[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_water[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_water[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_water}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_water_zhelp
        description= _ "Pour Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_water
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To pour terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to pour terrain, each pour takes all mp.
Every pouring adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_ICE
    [dummy]
        id=MWC_ice
        name= _ "freeze"
        description= _ "This unit can create ice terrain by freeze flat terrain(when this unit have atleast 3 mp, each freeze takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_ice
        [/have_unit]
        [then]
            {ICE_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_ice
    [/filter]
    {ICE_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_ice
    [/filter]
    {ICE_MENU}
[/event]

[+abilities]
#enddef

#define ICE_MENU
    {ICE_MENU_ITEM}
    {ICE_MENU_2_ITEM}
    {ICE_MENU_3_ITEM}
#enddef


#define ICE_MENU_ITEM
    [set_menu_item]
        id=MWC_ice
        description= _ "Freeze"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_ice
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Ai,Ai^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Aa
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_ice
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_ice
			[/store_unit]
			{FOREACH able_to_ice a}
				[set_variable]
					name=able_to_ice[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_ice[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_ice[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_ice[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_ice}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_ice_zhelp
        description= _ "Freeze Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_ice
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To freeze terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to freeze terrain, each freeze takes all mp.
Every freezing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ICE_MENU_2_ITEM
    [set_menu_item]
        id=MWC_2_ice
        description= _ "Freeze water"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_ice
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ww,Wwt,Wwg,Wwf,Sm,Ss,Ww^*,Wwt^*,Wwg^*,Wwf^*,Sm^*,Ss^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Ai
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_ice
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_ice_2
			[/store_unit]
			{FOREACH able_to_ice_2 a}
				[set_variable]
					name=able_to_ice_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_ice_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_ice_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_ice_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_ice_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_ice_2_zhelp
        description= _ "Freeze Water Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_ice
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To freeze water terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to freeze water terrain, each freeze takes all mp.
Every freezing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define ICE_MENU_3_ITEM
    [set_menu_item]
        id=MWC_3_ice
        description= _ "Freeze desert"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_ice
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Dd,Ds,Dd^*,Ds^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_ice
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_ice_3
			[/store_unit]
			{FOREACH able_to_ice_3 a}
				[set_variable]
					name=able_to_ice_3[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_ice_3[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_ice_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_ice_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_ice_3}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_ice_3_zhelp
        description= _ "Freeze Desert Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_ice
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To freeze desert terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to freeze desert terrain, each freeze takes all mp.
Every freezing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_BUILDING
    [dummy]
        id=MWC_building
        name= _ "build"
        description= _ "This unit can create castle on flat terrain(when this unit have atleast 3 mp, each build takes all mp) and if your side have atleast 15 gold."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_building
        [/have_unit]
        [then]
            {BUILDING_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_building
    [/filter]
    {BUILDING_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_building
    [/filter]
    {BUILDING_MENU}
[/event]

[+abilities]
#enddef

#define BUILDING_MENU
    {BUILDING_MENU_ITEM}
    {BUILDING_MENU_2_ITEM}
    {BUILDING_MENU_3_ITEM}
    {BUILDING_MENU_4_ITEM}
#enddef


#define BUILDING_MENU_ITEM
    [set_menu_item]
        id=MWC_building
        description= _ "Build castle (-15 gold)"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Ai,Ai^*,Uue,Uu,Dd,Ds,Uue^*,Uu^*,Dd^*,Ds^*,Ww,Wwt,Wwg,Wwf,Sm,Ss,Ww^*,Wwt^*,Wwg^*,Wwf^*,Sm^*,Ss^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=15
                [/variable]
                [then]
                    [gold]
                        amount=-15
                        side=$side_number
                    [/gold]
					[set_variable]
						name=random_dummy_castle
						rand=1..13
					[/set_variable]
					[switch]
						variable=random_dummy_castle
						[case]
							value=1
							[terrain]
								x,y=$x1,$y1
								terrain=Ce
							[/terrain]
						[/case]
						[case]
							value=2
							[terrain]
								x,y=$x1,$y1
								terrain=Cea
							[/terrain]
						[/case]
						[case]
							value=3
							[terrain]
								x,y=$x1,$y1
								terrain=Ch
							[/terrain]
						[/case]
						[case]
							value=4
							[terrain]
								x,y=$x1,$y1
								terrain=Chw
							[/terrain]
						[/case]
						[case]
							value=5
							[terrain]
								x,y=$x1,$y1
								terrain=Co
							[/terrain]
						[/case]
						[case]
							value=6
							[terrain]
								x,y=$x1,$y1
								terrain=Coa
							[/terrain]
						[/case]
						[case]
							value=7
							[terrain]
								x,y=$x1,$y1
								terrain=Cha
							[/terrain]
						[/case]
						[case]
							value=8
							[terrain]
								x,y=$x1,$y1
								terrain=Chs
							[/terrain]
						[/case]
						[case]
							value=9
							[terrain]
								x,y=$x1,$y1
								terrain=Cv
							[/terrain]
						[/case]
						[case]
							value=10
							[terrain]
								x,y=$x1,$y1
								terrain=Cud
							[/terrain]
						[/case]
						[case]
							value=11
							[terrain]
								x,y=$x1,$y1
								terrain=Chr
							[/terrain]
						[/case]
						[case]
							value=12
							[terrain]
								x,y=$x1,$y1
								terrain=Cd
							[/terrain]
						[/case]
						[case]
							value=13
							[terrain]
								x,y=$x1,$y1
								terrain=Cdr
							[/terrain]
						[/case]
					[/switch]
					{CLEAR_VARIABLE random_dummy_castle}
					[store_unit]
						[filter]
							x,y=$x1,$y1
							ability=MWC_building
							side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
						[/filter]
						variable=able_to_building
					[/store_unit]
					{FOREACH able_to_building a}
						[set_variable]
							name=able_to_building[$a].attacks_left
							value=0
						[/set_variable]
						[set_variable]
							name=able_to_building[$a].moves
							value=0
						[/set_variable]

						{VARIABLE_OP able_to_building[$a].experience add 1}

						
						[unstore_unit]
							variable=able_to_building[$a]
							find_vacant=no
							text= _ "+$this_unit.level exp"
							red,green,blue=50,50,200
						[/unstore_unit]
						{CLEAR_VARIABLE able_to_building}
					{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to build castle."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_building_zhelp
        description= _ "Build Castle Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To build castle right-click on unit with this ability.
                    
You need atleast 3 mp (and 15 gold) to build castle, each build takes all mp.
Every building adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define BUILDING_MENU_2_ITEM
    [set_menu_item]
        id=MWC_2_building
        description= _ "Destroy castle"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ce,Cea,Ch,Chw,Co,Coa,Cha,Chs,Cv,Cud,Chr,Cd,Cdr,Ce^*,Cea^*,Ch^*,Chw^*,Co^*,Coa^*,Cha^*,Chs^*,Cv^*,Cud^*,Chr^*,Cd^*,Cdr^*
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			[gold]
				amount=5
				side=$side_number
			[/gold]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_building
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_building_2
			[/store_unit]
			{FOREACH able_to_building_2 a}
				[set_variable]
					name=able_to_building_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_building_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_building_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_building_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_building_2}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_building_2_zhelp
        description= _ "Destroy Castle Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To destroy castle right-click on unit with this ability.
                    
You need atleast 3 mp to destroy castle, each destroy takes all mp.
Every destroying castle adds +1 to current experience and 5 gold for your side."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define BUILDING_MENU_3_ITEM
    [set_menu_item]
        id=MWC_3_building
        description= _ "Build leader castle (-10 gold)"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ce,Coa,Cdr,Cea,Ch,Cv,Cd,Co,Cha,Cud,Chs,Chw,Chr,Ce^*,Coa^*,Cdr^*,Cea^*,Ch^*,Cv^*,Cd^*,Co^*,Cha^*,Cud^*,Chs^*,Chw^*,Chr^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=10
                [/variable]
                [then]
                    [gold]
                        amount=-10
                        side=$side_number
                    [/gold]
					[set_variable]
						name=random_dummy_castle_leader
						rand=1..14
					[/set_variable]
					[switch]
						variable=random_dummy_castle_leader
						[case]
							value=1
							[terrain]
								x,y=$x1,$y1
								terrain=Kv
							[/terrain]
						[/case]
						[case]
							value=2
							[terrain]
								x,y=$x1,$y1
								terrain=Kud
							[/terrain]
						[/case]
						[case]
							value=3
							[terrain]
								x,y=$x1,$y1
								terrain=Kha
							[/terrain]
						[/case]
						[case]
							value=4
							[terrain]
								x,y=$x1,$y1
								terrain=Ket
							[/terrain]
						[/case]
						[case]
							value=5
							[terrain]
								x,y=$x1,$y1
								terrain=Khr
							[/terrain]
						[/case]
						[case]
							value=6
							[terrain]
								x,y=$x1,$y1
								terrain=Kh
							[/terrain]
						[/case]
						[case]
							value=7
							[terrain]
								x,y=$x1,$y1
								terrain=Ke
							[/terrain]
						[/case]
						[case]
							value=8
							[terrain]
								x,y=$x1,$y1
								terrain=Kea
							[/terrain]
						[/case]
						[case]
							value=9
							[terrain]
								x,y=$x1,$y1
								terrain=Khw
							[/terrain]
						[/case]
						[case]
							value=10
							[terrain]
								x,y=$x1,$y1
								terrain=Koa
							[/terrain]
						[/case]
						[case]
							value=11
							[terrain]
								x,y=$x1,$y1
								terrain=Ko
							[/terrain]
						[/case]
						[case]
							value=12
							[terrain]
								x,y=$x1,$y1
								terrain=Khs
							[/terrain]
						[/case]
						[case]
							value=13
							[terrain]
								x,y=$x1,$y1
								terrain=Kdr
							[/terrain]
						[/case]
						[case]
							value=14
							[terrain]
								x,y=$x1,$y1
								terrain=Kd
							[/terrain]
						[/case]
					[/switch]
					{CLEAR_VARIABLE random_dummy_castle_leader}
					[store_unit]
						[filter]
							x,y=$x1,$y1
							ability=MWC_building
							side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
						[/filter]
						variable=able_to_building_3
					[/store_unit]
					{FOREACH able_to_building_3 a}
						[set_variable]
							name=able_to_building_3[$a].attacks_left
							value=0
						[/set_variable]
						[set_variable]
							name=able_to_building_3[$a].moves
							value=0
						[/set_variable]

						{VARIABLE_OP able_to_building_3[$a].experience add 1}

						
						[unstore_unit]
							variable=able_to_building_3[$a]
							find_vacant=no
							text= _ "+$this_unit.level exp"
							red,green,blue=50,50,200
						[/unstore_unit]
						{CLEAR_VARIABLE able_to_building_3}
					{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to build castle."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_building_3_zhelp
        description= _ "Build Leader Castle Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To build castle right-click on unit with this ability.
                    
You need atleast 3 mp (and 10 gold) to build leader castle, each build takes all mp.
Every building adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define BUILDING_MENU_4_ITEM
    [set_menu_item]
        id=MWC_4_building
        description= _ "Destroy leader castle"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Kv,Kud,Kha,Ket,Khr,Kh,Ke,Kea,Khw,Koa,Ko,Khs,Kdr,Kd,Kv^*,Kud^*,Kha^*,Ket^*,Khr^*,Kh^*,Ke^*,Kea^*,Khw^*,Koa^*,Ko^*,Khs^*,Kdr^*,Kd^*
        [/filter_location]
        [command]
			[set_variable]
				name=random_dummy_castle
				rand=1..13
			[/set_variable]
			[switch]
				variable=random_dummy_castle
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ce
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Cea
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Ch
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Chw
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Co
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Coa
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Cha
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Chs
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Cv
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Cud
					[/terrain]
				[/case]
				[case]
					value=11
					[terrain]
						x,y=$x1,$y1
						terrain=Chr
					[/terrain]
				[/case]
				[case]
					value=12
					[terrain]
						x,y=$x1,$y1
						terrain=Cd
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Cdr
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_castle}
			[gold]
				amount=5
				side=$side_number
			[/gold]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_building
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_building_4
			[/store_unit]
			{FOREACH able_to_building_4 a}
				[set_variable]
					name=able_to_building_4[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_building_4[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_building_4[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_building_4[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_building_4}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_building_4_zhelp
        description= _ "Destroy Leader Castle Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To destroy leader castle right-click on unit with this ability.
                    
You need atleast 3 mp to destroy leader castle, each destroy takes all mp.
Every destroying leader castle adds +1 to current experience and 5 gold for your side."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define ABILITY_MWC_CREATE_ROCKS
    [dummy]
        id=MWC_create_rocks
        name= _ "create rocks"
        description= _ "This unit can create hills, mountains on flat terrain, hills(when this unit have atleast 3 mp, each create takes all mp)."
    [/dummy]
[/abilities]

[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_create_rocks
        [/have_unit]
        [then]
            {CREATE_ROCKS_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_create_rocks
    [/filter]
    {CREATE_ROCKS_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_create_rocks
    [/filter]
    {CREATE_ROCKS_MENU}
[/event]

[+abilities]
#enddef

#define CREATE_ROCKS_MENU
    {CREATE_ROCKS_MENU_ITEM}
    {CREATE_ROCKS_MENU_2_ITEM}
    {CREATE_ROCKS_MENU_3_ITEM}
#enddef


#define CREATE_ROCKS_MENU_ITEM
    [set_menu_item]
        id=MWC_create_rocks
        description= _ "Create hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_create_rocks
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Ai,Ai^*,Uue,Uu,Dd,Ds,Uue^*,Uu^*,Dd^*,Ds^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill
				rand=1..5
			[/set_variable]
			[switch]
				variable=random_dummy_hill
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Hd
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Uh
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_create_rocks
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_create_rocks
			[/store_unit]
			{FOREACH able_to_create_rocks a}
				[set_variable]
					name=able_to_create_rocks[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_create_rocks[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_create_rocks[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_create_rocks[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_create_rocks}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_create_rocks_zhelp
        description= _ "Create Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_create_rocks
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To create hills right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to create hills, each create takes all mp.
Every creating adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define CREATE_ROCKS_MENU_2_ITEM
    [set_menu_item]
        id=MWC_2_create_rocks
        description= _ "Create mountains"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_create_rocks
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ha,Hh,Hhd,Hd,Uh,Ha^Ii,Hh^Ii,Hhd^Ii,Hd^Ii,Uh^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_mountain
				rand=1..3
			[/set_variable]
			[switch]
				variable=random_dummy_mountain
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Mm
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Md
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Ms
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_mountain}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_create_rocks
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_create_rocks_2
			[/store_unit]
			{FOREACH able_to_create_rocks_2 a}
				[set_variable]
					name=able_to_create_rocks_2[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_create_rocks_2[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_create_rocks_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_create_rocks_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_create_rocks_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_create_rocks_2_zhelp
        description= _ "Create Mountains Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_create_rocks
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To create mountains right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to create mountains, each create takes all mp.
Every creating adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define CREATE_ROCKS_MENU_3_ITEM
    [set_menu_item]
        id=MWC_3_create_rocks
        description= _ "Create hills on trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_create_rocks
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg^Fet,Gs^Ft,Gll^Fp,Gs^Fds,Gd^Fdf,Gs^Fdw,Gs^Fms,Gll^Fmf,Gd^Fmw,Gd^Fetd,Gs^Fp,G*^F*,Gg^F*,Gs^F*,Gll^F*,Gd^F*,Rd^F*,Rb^F*,Rrc^F*,Re^F*,Rr^F*,Rp^F*,Urb^F*,Iwr^F*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill_tree
				rand=1..10
			[/set_variable]
			[switch]
				variable=random_dummy_hill_tree
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fpa
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fda
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fma
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fp
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fds
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fms
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdf
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdw
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmf
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmw
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill_tree}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_create_rocks
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_create_rocks_3
			[/store_unit]
			{FOREACH able_to_create_rocks_3 a}
				[set_variable]
					name=able_to_create_rocks_3[$a].attacks_left
					value=0
				[/set_variable]
				[set_variable]
					name=able_to_create_rocks_3[$a].moves
					value=0
				[/set_variable]

				{VARIABLE_OP able_to_create_rocks_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_create_rocks_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_create_rocks_3}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_create_rocks_3_zhelp
        description= _ "Create Hills On Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_create_rocks
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To create hills on trees right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to create hills on trees, each create takes all mp.
Every creating adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define ABILITY_MWC_HERO_DIG
    [dummy]
        id=MWC_hero_dig
        name= _ "dig"
        description= _ "This unit can dig in cave walls (when this unit have atleast 3 mp, each dig takes 6 mp)."
    [/dummy]
#enddef

#define DIG_HERO_MENU
    {DIG_HERO_MENU_ITEM}
#enddef




#define DIG_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_dig
        description= _ "dig"
        [show_if]
        [/show_if]

        [filter_location]
            [filter_adjacent_location]
                [filter]
                    ability=MWC_hero_dig
                    side=$side_number
                    #[filter_wml]
                    #    moves=$this_unit.max_moves
                    #[/filter_wml]	
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
                [/filter]
            [/filter_adjacent_location]
			terrain=X*,X*^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[unit]
			    type=Mwc_Peasant
			    side=$side_number
			    x,y=$x1,$y1
			    moves=0
			    animate=no
			[/unit]
			{DIG_MWC_DIGGING}
			
			[store_unit]
				[filter]
					[filter_adjacent]
						x,y=$x1,$y1
					[/filter_adjacent]
					ability=MWC_hero_dig
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_dig
			[/store_unit]
			{FOREACH able_to_dig a}
				[set_variable]
					name=able_to_dig[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_dig[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_dig[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_dig}
			{NEXT a}
			[kill]
				type=Mwc_Peasant
				x,y=$x1,$y1
				animate=no
			[/kill]
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_dig_zhelp
        description= _ "Dig Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_dig
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To dig a unit right-click on adjacent hexes near a selected diger.
                    
You need atleast 3 movement points to dig in cave walls(each dig takes 6 mp).
Every digging adds +1 to current experience.

If there are 2 or more diggers, cave will be digged by the last selected unit able to dig."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define ABILITY_MWC_HERO_FARM
    [dummy]
        id=MWC_hero_farm
        name= _ "farm"
        description= _ "This unit can farm, but first it have to change flat terrain for it (when this unit have atleast 3 mp, each farm takes 6 mp)."
    [/dummy]
#enddef

#define FARM_HERO_MENU
    {FARM_HERO_MENU_ITEM}
    {FARM_HERO_MENU_2_ITEM}
    {FARM_HERO_MENU_3_ITEM}
	{FARM_HERO_MENU_4_ITEM}
#enddef



#define FARM_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_farm_menu
        description= _ "Sow field"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Rb
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg^Gvs
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm
			[/store_unit]
			{FOREACH able_to_farm a}
				[set_variable]
					name=able_to_farm[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_farm[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_farm[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_farm_zhelp
        description= _ "Sow Field Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_farm
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To sow field right-click on selected farmer(terrain have to be earlier prepared for it).
                    
You need atleast 3 mp to sow field, each sow takes 6 mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define FARM_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_farm_2_menu
        description= _ "Pick harvest"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg^Gvs
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Rb
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm_2
			[/store_unit]
			{FOREACH able_to_farm_2 a}
				[set_variable]
					name=able_to_farm_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_farm_2[$a].experience add 1}
				[gold]
					amount=2
					side=$side_number
				[/gold]

				
				[unstore_unit]
					variable=able_to_farm_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm_2}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_farm_2_zhelp
        description= _ "Pick Harvest Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_farm
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To pick harvest right-click on selected farmer.
                    
You need 3 mp to pick harvest, each pick takes 6 mp.
Every picking harvest adds +1 to current experience for farmer and 2 gold for your side."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define FARM_HERO_MENU_3_ITEM
    [set_menu_item]
        id=MWC_hero_farm_3_menu
        description= _ "Prepare field"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Rb
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm_3
			[/store_unit]
			{FOREACH able_to_farm_3 a}
				[set_variable]
					name=able_to_farm_3[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_farm_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_farm_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm_3}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_farm_3_zhelp
        description= _ "Prepare Field Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_farm
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To prepare field right-click on selected farmer.
                    
You need atleast 3 mp to prepare field, each prepare takes 6 mp.
Every preparing field adds +1 to current experience for farmer."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define FARM_HERO_MENU_4_ITEM
    [set_menu_item]
        id=MWC_hero_farm_4_menu
        description= _ "Create flat terrain"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_farm
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Rb,Gg^Gvs,Rb^*,Dd,Ds,Dd^*,Ds^*,Uu,Uue,Uu^*,Uue^*,Ww,Wwg,Sm,Wwt,Wwf,Ss,Ww^*,Wwg^*,Sm^*,Wwt^*,Wwf^*,Ss^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_farm
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_farm_4
			[/store_unit]
			{FOREACH able_to_farm_4 a}
				[set_variable]
					name=able_to_farm_4[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_farm_4[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_farm_4[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_farm_4}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_farm_4_zhelp
        description= _ "Create Flat Terrain Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_farm
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To create flat right-click on selected farmer.
                    
You need atleast 3 mp and 5 gold to create flat, each create takes 6 mp.
Every creating flat terrain adds +1 to current experience for farmer."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define ABILITY_MWC_HERO_AFFORESTATION
    [dummy]
        id=MWC_hero_afforestation
        name= _ "afforestation"
        description= _ "This unit can sow trees(when this unit have atleast 3 mp, each sow takes 6 mp)."
    [/dummy]
#enddef

#define AFFORESTATION_HERO_MENU
    {AFFORESTATION_HERO_MENU_ITEM}
    {AFFORESTATION_HERO_MENU_2_ITEM}
#enddef



#define AFFORESTATION_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_afforestation_menu
        description= _ "Sow trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_afforestation
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_forest
				rand=1..13
			[/set_variable]
			[switch]
				variable=random_dummy_forest
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Gg^Fet
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Ft
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fp
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fds
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fdf
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fdw
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fms
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fmf
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fmw
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fpa
					[/terrain]
				[/case]
				[case]
					value=11
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fda
					[/terrain]
				[/case]
				[case]
					value=12
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fma
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fetd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_forest}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_afforestation
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_afforestation
			[/store_unit]
			{FOREACH able_to_afforestation a}
				[set_variable]
					name=able_to_afforestation[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_afforestation[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_afforestation[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_afforestation}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_afforestation_zhelp
        description= _ "Sow Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_afforestation
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To sow trees right-click on selected unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to sow trees, each sow takes 6 mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define AFFORESTATION_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_afforestation_2_menu
        description= _ "Sow trees on hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_afforestation
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Hh,Hd,Ha,Hhd,Uh,Hh^Ii,Hd^Ii,Ha^Ii,Hhd^Ii,Uh^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill_forest
				rand=1..10
			[/set_variable]
			[switch]
				variable=random_dummy_hill_forest
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fp
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fds
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fms
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fpa
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fda
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fma
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdf
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdw
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmf
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmw
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill_forest}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_afforestation
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_afforestation_2
			[/store_unit]
			{FOREACH able_to_afforestation_2 a}
				[set_variable]
					name=able_to_afforestation_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_afforestation_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_afforestation_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_afforestation_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_afforestation_2_zhelp
        description= _ "Sow Trees On Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_afforestation
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To sow trees on hills right-click on selected unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to sow trees, each sow takes 6 mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_HERO_CUTTER
    [dummy]
        id=MWC_hero_cutter
        name= _ "cut"
        description= _ "This unit can cut trees(when this unit have atleast 3 mp, each cut takes 6 mp)."
    [/dummy]
#enddef

#define CUTTER_HERO_MENU
    {CUTTER_HERO_MENU_ITEM}
    {CUTTER_HERO_MENU_2_ITEM}
#enddef



#define CUTTER_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_cutter_menu
        description= _ "Cut trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_cutter
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg^Fet,Gs^Ft,Gll^Fp,Gs^Fds,Gd^Fdf,Gs^Fdw,Gs^Fms,Gll^Fmf,Gd^Fmw,Gd^Fetd,Gs^Fp,G*^F*,Gg^F*,Gs^F*,Gll^F*,Gd^F*,Rd^F*,Rb^F*,Rrc^F*,Re^F*,Rr^F*,Rp^F*,Urb^F*,Iwr^F*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_cutter
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_cutter
			[/store_unit]
			{FOREACH able_to_cutter a}
				[set_variable]
					name=able_to_cutter[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_cutter[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_cutter[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_cutter}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_cutter_zhelp
        description= _ "Cut Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_cutter
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To cut trees right-click on selected cutter.
                    
You need atleast 3 mp (and 5 gold) to cut trees, each cut takes 6 mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define CUTTER_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_cutter_2_menu
        description= _ "Cut trees from hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_cutter
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Hh^F*,Hhd^F*,Ha^F*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill
				rand=1..5
			[/set_variable]
			[switch]
				variable=random_dummy_hill
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Uh
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Hd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_cutter
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_cutter_2
			[/store_unit]
			{FOREACH able_to_cutter_2 a}
				[set_variable]
					name=able_to_cutter_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_cutter_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_cutter_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_cutter_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_cutter_2_zhelp
        description= _ "Cut Trees From Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_cutter
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To cut trees from hills right-click on selected cutter.
                    
You need atleast 3 mp (and 5 gold) to cut trees from hills, each cut takes 6 mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_HERO_CRUSHER
    [dummy]
        id=MWC_hero_crusher
        name= _ "crush"
        description= _ "This unit can crush impossible mountains,mountains,hills(when this unit have atleast 3 mp, each crush takes 6 mp(for hills it takes 4 mp))."
    [/dummy]
#enddef

#define CRUSHER_HERO_MENU
    {CRUSHER_HERO_MENU_ITEM}
    {CRUSHER_HERO_MENU_2_ITEM}
    {CRUSHER_HERO_MENU_3_ITEM}
    {CRUSHER_HERO_MENU_4_ITEM}
#enddef



#define CRUSHER_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_crusher
        description= _ "Crush impossible mountains"
        [show_if]
        [/show_if]

        [filter_location]
            [filter_adjacent_location]
                [filter]
                    ability=MWC_hero_crusher
                    side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
                [/filter]
            [/filter_adjacent_location]
			terrain=Mm^Xm,Ms^Xm,Md^Xm
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[unit]
			    type=Mwc_Peasant
			    side=$side_number
			    x,y=$x1,$y1
			    moves=0
			    animate=no
			[/unit]
			[set_variable]
				name=random_dummy_mountain
				rand=1..3
			[/set_variable]
			[switch]
				variable=random_dummy_mountain
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Mm
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Ms
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Md
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_mountain}
			
			[store_unit]
				[filter]
					[filter_adjacent]
						x,y=$x1,$y1
					[/filter_adjacent]
					ability=MWC_hero_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher
			[/store_unit]
			{FOREACH able_to_crusher a}
				[set_variable]
					name=able_to_crusher[$a].moves
					sub=4
				[/set_variable]

				{VARIABLE_OP able_to_crusher[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher}
			{NEXT a}
			[kill]
				type=Mwc_Peasant
				x,y=$x1,$y1
				animate=no
			[/kill]
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_crusher_zhelp
        description= _ "Crush Impossible Mountains Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a impossible mountains right-click on adjacent hexes near a selected crusher.
                    
You need atleast 3 mp (and 5 gold) to crush impossible mountains, each crush takes 4 mp.
Every crushing adds +1 to current experience.

If there are 2 or more crushers, impossible mountain will be crushed by the last selected unit able to crush."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define CRUSHER_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_2_crusher
        description= _ "Crush mountains"
        [show_if]
        [/show_if]

        [filter_location]
            [filter_adjacent_location]
                [filter]
                    ability=MWC_hero_crusher
                    side=$side_number
                    #[filter_wml]
                    #    moves=$this_unit.max_moves
                    #[/filter_wml]	
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
                [/filter]
            [/filter_adjacent_location]
			terrain=Mm,Ms,Md
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[unit]
			    type=Mwc_Peasant
			    side=$side_number
			    x,y=$x1,$y1
			    moves=0
			    animate=no
			[/unit]
			[set_variable]
				name=random_dummy_hill
				rand=1..5
			[/set_variable]
			[switch]
				variable=random_dummy_hill
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Uh
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Hd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill}
			
			[store_unit]
				[filter]
					[filter_adjacent]
						x,y=$x1,$y1
					[/filter_adjacent]
					ability=MWC_hero_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher_2
			[/store_unit]
			{FOREACH able_to_crusher_2 a}
				[set_variable]
					name=able_to_crusher_2[$a].moves
					sub=4
				[/set_variable]

				{VARIABLE_OP able_to_crusher_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher_2}
			{NEXT a}
			[kill]
				type=Mwc_Peasant
				x,y=$x1,$y1
				animate=no
			[/kill]
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_crusher_2_zhelp
        description= _ "Crush Mountains Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a mountains right-click on adjacent hexes near a selected crusher.
                    
You need atleast 3 mp (and 5 gold) to crush mountains, each crush takes 4 mp.
Every crushing adds +1 to current experience.

If there are 2 or more crushers, mountain will be crushed by the last selected unit able to crush."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define CRUSHER_HERO_MENU_3_ITEM
    [set_menu_item]
        id=MWC_hero_3_crusher
        description= _ "Crush hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_crusher
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ha,Hh,Hhd,Hd,Uh,Ha^Ii,Hh^Ii,Hhd^Ii,Hd^Ii,Uh^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_flat
				rand=1..9
			[/set_variable]
			[switch]
				variable=random_dummy_flat
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Gll
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Gd
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Gg
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Gs
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Ds
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Dd
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Uu
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Uue
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Aa
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_flat}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher_3
			[/store_unit]
			{FOREACH able_to_crusher_3 a}
				[set_variable]
					name=able_to_crusher_3[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_crusher_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher_3}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_crusher_3_zhelp
        description= _ "Crush Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a hills right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to crush hills, each crush takes 6 mp.
Every crushing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define CRUSHER_HERO_MENU_4_ITEM
    [set_menu_item]
        id=MWC_hero_4_crusher
        description= _ "Crush hills/trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_crusher
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ha^*,Hh^*,Hhd^*
			[and]
				[not]
					terrain=Ha^Vhha,Hh^Vhh,Hhd^Vhhr
				[/not]
			[/and]
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_forest
				rand=1..13
			[/set_variable]
			[switch]
				variable=random_dummy_forest
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Gg^Fet
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Ft
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fp
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fds
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fdf
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fdw
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Gs^Fms
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Gll^Fmf
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fmw
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fpa
					[/terrain]
				[/case]
				[case]
					value=11
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fda
					[/terrain]
				[/case]
				[case]
					value=12
					[terrain]
						x,y=$x1,$y1
						terrain=Aa^Fma
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Gd^Fetd
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_forest}
			
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_crusher
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_crusher_4
			[/store_unit]
			{FOREACH able_to_crusher_4 a}
				[set_variable]
					name=able_to_crusher_4[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_crusher_4[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_crusher_4[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_crusher_4}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_crusher_4_zhelp
        description= _ "Crush Hills/Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_crusher
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To crush a hills/trees right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to crush hills/trees, each crush takes 6 mp.
Every crushing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef

#define ABILITY_MWC_HERO_MUSHROOMS
    [dummy]
        id=MWC_hero_mushrooms
        name= _ "mushrooms"
        description= _ "This unit can sow mushrooms in cave(when this unit have atleast 3 mp, each sow takes 6 mp)."
    [/dummy]
#enddef

#define MUSHROOMS_HERO_MENU
    {MUSHROOMS_HERO_MENU_ITEM}
    {MUSHROOMS_HERO_MENU_2_ITEM}
#enddef


#define MUSHROOMS_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_mushrooms
        description= _ "Prepare cave"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_mushrooms
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_cave
				rand=1..2
			[/set_variable]
			[switch]
				variable=random_dummy_cave
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Uu
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Uue
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_cave}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_mushrooms
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_mushrooms
			[/store_unit]
			{FOREACH able_to_mushrooms a}
				[set_variable]
					name=able_to_mushrooms[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_mushrooms[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_mushrooms[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_mushrooms}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_mushrooms_zhelp
        description= _ "Prepare Cave Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_mushrooms
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To prepare cave on flat terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to prepare cave, each prepare takes 6 mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef

#define MUSHROOMS_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_2_mushrooms
        description= _ "Sow mushrooms"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_mushrooms
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Uu,Uue,Uu^*,Uue^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Uu^Uf
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_mushrooms
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]	
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_mushrooms_2
			[/store_unit]
			{FOREACH able_to_mushrooms_2 a}
				[set_variable]
					name=able_to_mushrooms_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_mushrooms_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_mushrooms_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_mushrooms_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_mushrooms_2_zhelp
        description= _ "Sow Mushrooms Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_mushrooms
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To sow mushrooms in cave right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to sow mushrooms, each sow takes 6 mp.
Every sowing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_HERO_DESERT
    [dummy]
        id=MWC_hero_desert
        name= _ "burn"
        description= _ "This unit can create desert by burning terrain on flat(when this unit have atleast 3 mp, each burn takes 6 mp)."
    [/dummy]
#enddef

#define DESERT_HERO_MENU
    {DESERT_HERO_MENU_ITEM}
    {DESERT_HERO_MENU_2_ITEM}
#enddef


#define DESERT_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_desert
        description= _ "Burn terrain"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_desert
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_desert
				rand=1..14
			[/set_variable]
			[switch]
				variable=random_dummy_desert
				[case]
					value=1,2,3,4,5,6
					[terrain]
						x,y=$x1,$y1
						terrain=Ds
					[/terrain]
				[/case]
				[case]
					value=7,8,9,10,11,12
					[terrain]
						x,y=$x1,$y1
						terrain=Dd
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Dd^Vdt
					[/terrain]
				[/case]
				[case]
					value=14
					[terrain]
						x,y=$x1,$y1
						terrain=Dd^Vda
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_desert}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_desert
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]	
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_desert
			[/store_unit]
			{FOREACH able_to_desert a}
				[set_variable]
					name=able_to_desert[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_desert[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_desert[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_desert}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_desert_zhelp
        description= _ "Burn Terrain Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_desert
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To burn terrain on flat terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to burn terrain, each burn takes 6 mp.
Every burning adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef

#define DESERT_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_2_desert
        description= _ "Dissolve the ice"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_desert
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Aa,Aa^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_desert
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_desert_2
			[/store_unit]
			{FOREACH able_to_desert_2 a}
				[set_variable]
					name=able_to_desert_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_desert_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_desert_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_desert_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_desert_2_zhelp
        description= _ "Dissolve Ice Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_desert
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To dissolve ice right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to dissolve ice, each dissolve takes 6 mp.
Every dissolving adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_HERO_WATER
    [dummy]
        id=MWC_hero_water
        name= _ "pour"
        description= _ "This unit can create water terrain by pour flat terrain(when this unit have atleast 3 mp, each pour all mp)."
    [/dummy]
#enddef

#define WATER_HERO_MENU
    {WATER_HERO_MENU_ITEM}
#enddef


#define WATER_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_water
        description= _ "Pour"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_water
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Aa,Aa^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_water
				rand=1..14
			[/set_variable]
			[switch]
				variable=random_dummy_water
				[case]
					value=1,2
					[terrain]
						x,y=$x1,$y1
						terrain=Ss
					[/terrain]
				[/case]
				[case]
					value=3,4
					[terrain]
						x,y=$x1,$y1
						terrain=Wwf
					[/terrain]
				[/case]
				[case]
					value=5,6
					[terrain]
						x,y=$x1,$y1
						terrain=Wwt
					[/terrain]
				[/case]
				[case]
					value=7,8
					[terrain]
						x,y=$x1,$y1
						terrain=Sm
					[/terrain]
				[/case]
				[case]
					value=9,10
					[terrain]
						x,y=$x1,$y1
						terrain=Wwg
					[/terrain]
				[/case]
				[case]
					value=11,12
					[terrain]
						x,y=$x1,$y1
						terrain=Ww
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Ss^Vhs
					[/terrain]
				[/case]
				[case]
					value=14
					[terrain]
						x,y=$x1,$y1
						terrain=Ww^Vm
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_water}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_water
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_water
			[/store_unit]
			{FOREACH able_to_water a}
				[set_variable]
					name=able_to_water[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_water[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_water[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_water}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_water_zhelp
        description= _ "Pour Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_water
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To pour terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to pour terrain, each pour takes 6 mp.
Every pouring adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_HERO_ICE
    [dummy]
        id=MWC_hero_ice
        name= _ "freeze"
        description= _ "This unit can create ice terrain by freeze flat terrain(when this unit have atleast 3 mp, each freeze takes 6 mp)."
    [/dummy]
#enddef

#define ICE_HERO_MENU
    {ICE_HERO_MENU_ITEM}
    {ICE_HERO_MENU_2_ITEM}
    {ICE_HERO_MENU_3_ITEM}
#enddef


#define ICE_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_ice
        description= _ "Freeze"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_ice
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Ai,Ai^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Aa
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_ice
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_ice
			[/store_unit]
			{FOREACH able_to_ice a}
				[set_variable]
					name=able_to_ice[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_ice[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_ice[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_ice}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_ice_zhelp
        description= _ "Freeze Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_ice
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To freeze terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to freeze terrain, each freeze takes 6 mp.
Every freezing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ICE_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_2_ice
        description= _ "Freeze water"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_ice
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ww,Wwt,Wwg,Wwf,Sm,Ss,Ww^*,Wwt^*,Wwg^*,Wwf^*,Sm^*,Ss^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Ai
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_ice
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_ice_2
			[/store_unit]
			{FOREACH able_to_ice_2 a}
				[set_variable]
					name=able_to_ice_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_ice_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_ice_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_ice_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_ice_2_zhelp
        description= _ "Freeze Water Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_ice
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To freeze water terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to freeze water terrain, each freeze takes 6 mp.
Every freezing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef



#define ICE_HERO_MENU_3_ITEM
    [set_menu_item]
        id=MWC_hero_3_ice
        description= _ "Freeze desert"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_ice
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Dd,Ds,Dd^*,Ds^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_ice
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_ice_3
			[/store_unit]
			{FOREACH able_to_ice_3 a}
				[set_variable]
					name=able_to_ice_3[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_ice_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_ice_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_ice_3}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_ice_3_zhelp
        description= _ "Freeze Desert Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_ice
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To freeze desert terrain right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to freeze desert terrain, each freeze takes 6 mp.
Every freezing adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_HERO_BUILDING
    [dummy]
        id=MWC_hero_building
        name= _ "build"
        description= _ "This unit can create castle on flat terrain(when this unit have atleast 3 mp, each build takes 6 mp) and if your side have atleast 15 gold."
    [/dummy]
#enddef

#define BUILDING_HERO_MENU
    {BUILDING_HERO_MENU_ITEM}
    {BUILDING_HERO_MENU_2_ITEM}
    {BUILDING_HERO_MENU_3_ITEM}
    {BUILDING_HERO_MENU_4_ITEM}
#enddef


#define BUILDING_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_building
        description= _ "Build castle (-15 gold)"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Ai,Ai^*,Uue,Uu,Dd,Ds,Uue^*,Uu^*,Dd^*,Ds^*,Ww,Wwt,Wwg,Wwf,Sm,Ss,Ww^*,Wwt^*,Wwg^*,Wwf^*,Sm^*,Ss^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=15
                [/variable]
                [then]
                    [gold]
                        amount=-15
                        side=$side_number
                    [/gold]
					[set_variable]
						name=random_dummy_castle
						rand=1..13
					[/set_variable]
					[switch]
						variable=random_dummy_castle
						[case]
							value=1
							[terrain]
								x,y=$x1,$y1
								terrain=Ce
							[/terrain]
						[/case]
						[case]
							value=2
							[terrain]
								x,y=$x1,$y1
								terrain=Cea
							[/terrain]
						[/case]
						[case]
							value=3
							[terrain]
								x,y=$x1,$y1
								terrain=Ch
							[/terrain]
						[/case]
						[case]
							value=4
							[terrain]
								x,y=$x1,$y1
								terrain=Chw
							[/terrain]
						[/case]
						[case]
							value=5
							[terrain]
								x,y=$x1,$y1
								terrain=Co
							[/terrain]
						[/case]
						[case]
							value=6
							[terrain]
								x,y=$x1,$y1
								terrain=Coa
							[/terrain]
						[/case]
						[case]
							value=7
							[terrain]
								x,y=$x1,$y1
								terrain=Cha
							[/terrain]
						[/case]
						[case]
							value=8
							[terrain]
								x,y=$x1,$y1
								terrain=Chs
							[/terrain]
						[/case]
						[case]
							value=9
							[terrain]
								x,y=$x1,$y1
								terrain=Cv
							[/terrain]
						[/case]
						[case]
							value=10
							[terrain]
								x,y=$x1,$y1
								terrain=Cud
							[/terrain]
						[/case]
						[case]
							value=11
							[terrain]
								x,y=$x1,$y1
								terrain=Chr
							[/terrain]
						[/case]
						[case]
							value=12
							[terrain]
								x,y=$x1,$y1
								terrain=Cd
							[/terrain]
						[/case]
						[case]
							value=13
							[terrain]
								x,y=$x1,$y1
								terrain=Cdr
							[/terrain]
						[/case]
					[/switch]
					{CLEAR_VARIABLE random_dummy_castle}
					[store_unit]
						[filter]
							x,y=$x1,$y1
							ability=MWC_hero_building
							side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
						[/filter]
						variable=able_to_building
					[/store_unit]
					{FOREACH able_to_building a}
						[set_variable]
							name=able_to_building[$a].moves
							sub=6
						[/set_variable]

						{VARIABLE_OP able_to_building[$a].experience add 1}

						
						[unstore_unit]
							variable=able_to_building[$a]
							find_vacant=no
							text= _ "+$this_unit.level exp"
							red,green,blue=50,50,200
						[/unstore_unit]
						{CLEAR_VARIABLE able_to_building}
					{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to build castle."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_building_zhelp
        description= _ "Build Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To build castle right-click on unit with this ability.
                    
You need atleast 3 mp (and 15 gold) to build castle, each build takes 6 mp.
Every building adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define BUILDING_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_2_building
        description= _ "Destroy castle"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ce,Cea,Ch,Chw,Co,Coa,Cha,Chs,Cv,Cud,Chr,Cd,Cdr,Ce^*,Cea^*,Ch^*,Chw^*,Co^*,Coa^*,Cha^*,Chs^*,Cv^*,Cud^*,Chr^*,Cd^*,Cdr^*
        [/filter_location]
        [command]
			[terrain]
				x,y=$x1,$y1
				terrain=Gg
			[/terrain]
			[gold]
				amount=5
				side=$side_number
			[/gold]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_building
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_building_2
			[/store_unit]
			{FOREACH able_to_building_2 a}
				[set_variable]
					name=able_to_building_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_building_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_building_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_building_2}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_building_2_zhelp
        description= _ "Destroy Castle Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To destroy castle right-click on unit with this ability.
                    
You need atleast 3 mp to destroy castle, each destroy takes 6 mp.
Every destroying castle adds +1 to current experience and 5 gold for your side."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define BUILDING_HERO_MENU_3_ITEM
    [set_menu_item]
        id=MWC_hero_3_building
        description= _ "Build leader castle (-10 gold)"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ce,Coa,Cdr,Cea,Ch,Cv,Cd,Co,Cha,Cud,Chs,Chw,Chr,Ce^*,Coa^*,Cdr^*,Cea^*,Ch^*,Cv^*,Cd^*,Co^*,Cha^*,Cud^*,Chs^*,Chw^*,Chr^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=10
                [/variable]
                [then]
                    [gold]
                        amount=-10
                        side=$side_number
                    [/gold]
					[set_variable]
						name=random_dummy_castle_leader
						rand=1..14
					[/set_variable]
					[switch]
						variable=random_dummy_castle_leader
						[case]
							value=1
							[terrain]
								x,y=$x1,$y1
								terrain=Kv
							[/terrain]
						[/case]
						[case]
							value=2
							[terrain]
								x,y=$x1,$y1
								terrain=Kud
							[/terrain]
						[/case]
						[case]
							value=3
							[terrain]
								x,y=$x1,$y1
								terrain=Kha
							[/terrain]
						[/case]
						[case]
							value=4
							[terrain]
								x,y=$x1,$y1
								terrain=Ket
							[/terrain]
						[/case]
						[case]
							value=5
							[terrain]
								x,y=$x1,$y1
								terrain=Khr
							[/terrain]
						[/case]
						[case]
							value=6
							[terrain]
								x,y=$x1,$y1
								terrain=Kh
							[/terrain]
						[/case]
						[case]
							value=7
							[terrain]
								x,y=$x1,$y1
								terrain=Ke
							[/terrain]
						[/case]
						[case]
							value=8
							[terrain]
								x,y=$x1,$y1
								terrain=Kea
							[/terrain]
						[/case]
						[case]
							value=9
							[terrain]
								x,y=$x1,$y1
								terrain=Khw
							[/terrain]
						[/case]
						[case]
							value=10
							[terrain]
								x,y=$x1,$y1
								terrain=Koa
							[/terrain]
						[/case]
						[case]
							value=11
							[terrain]
								x,y=$x1,$y1
								terrain=Ko
							[/terrain]
						[/case]
						[case]
							value=12
							[terrain]
								x,y=$x1,$y1
								terrain=Khs
							[/terrain]
						[/case]
						[case]
							value=13
							[terrain]
								x,y=$x1,$y1
								terrain=Kdr
							[/terrain]
						[/case]
						[case]
							value=14
							[terrain]
								x,y=$x1,$y1
								terrain=Kd
							[/terrain]
						[/case]
					[/switch]
					{CLEAR_VARIABLE random_dummy_castle_leader}
					[store_unit]
						[filter]
							x,y=$x1,$y1
							ability=MWC_hero_building
							side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
						[/filter]
						variable=able_to_building_3
					[/store_unit]
					{FOREACH able_to_building_3 a}
						[set_variable]
							name=able_to_building_3[$a].moves
							sub=6
						[/set_variable]

						{VARIABLE_OP able_to_building_3[$a].experience add 1}

						
						[unstore_unit]
							variable=able_to_building_3[$a]
							find_vacant=no
							text= _ "+$this_unit.level exp"
							red,green,blue=50,50,200
						[/unstore_unit]
						{CLEAR_VARIABLE able_to_building_3}
					{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to build castle."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_building_3_zhelp
        description= _ "Build Leader Castle Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To build castle right-click on unit with this ability.
                    
You need atleast 3 mp (and 10 gold) to build leader castle, each build takes 6 mp.
Every building adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define BUILDING_HERO_MENU_4_ITEM
    [set_menu_item]
        id=MWC_hero_4_building
        description= _ "Destroy leader castle"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_building
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Kv,Kud,Kha,Ket,Khr,Kh,Ke,Kea,Khw,Koa,Ko,Khs,Kdr,Kd,Kv^*,Kud^*,Kha^*,Ket^*,Khr^*,Kh^*,Ke^*,Kea^*,Khw^*,Koa^*,Ko^*,Khs^*,Kdr^*,Kd^*
        [/filter_location]
        [command]
			[set_variable]
				name=random_dummy_castle
				rand=1..13
			[/set_variable]
			[switch]
				variable=random_dummy_castle
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ce
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Cea
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Ch
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Chw
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Co
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Coa
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Cha
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Chs
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Cv
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Cud
					[/terrain]
				[/case]
				[case]
					value=11
					[terrain]
						x,y=$x1,$y1
						terrain=Chr
					[/terrain]
				[/case]
				[case]
					value=12
					[terrain]
						x,y=$x1,$y1
						terrain=Cd
					[/terrain]
				[/case]
				[case]
					value=13
					[terrain]
						x,y=$x1,$y1
						terrain=Cdr
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_castle}
			[gold]
				amount=5
				side=$side_number
			[/gold]
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_building
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_building_4
			[/store_unit]
			{FOREACH able_to_building_4 a}
				[set_variable]
					name=able_to_building_4[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_building_4[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_building_4[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_building_4}
			{NEXT a}
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_building_4_zhelp
        description= _ "Destroy Leader Castle Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_building
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To destroy leader castle right-click on unit with this ability.
                    
You need atleast 3 mp to destroy leader castle, each destroy takes 6 mp.
Every destroying leader castle adds +1 to current experience and 5 gold for your side."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWC_HERO_CREATE_ROCKS
    [dummy]
        id=MWC_hero_create_rocks
        name= _ "create rocks"
        description= _ "This unit can create hills, mountains on flat terrain, hills(when this unit have atleast 3 mp, each create takes 6 mp)."
    [/dummy]
#enddef

#define CREATE_ROCKS_HERO_MENU
    {CREATE_ROCKS_HERO_MENU_ITEM}
    {CREATE_ROCKS_HERO_MENU_2_ITEM}
    {CREATE_ROCKS_HERO_MENU_3_ITEM}
#enddef


#define CREATE_ROCKS_HERO_MENU_ITEM
    [set_menu_item]
        id=MWC_hero_create_rocks
        description= _ "Create hills"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_create_rocks
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg,Gs,Gd,Gll,Gg^*,Gs^*,Gd^*,Gll^*,Ai,Ai^*,Uue,Uu,Dd,Ds,Uue^*,Uu^*,Dd^*,Ds^*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill
				rand=1..5
			[/set_variable]
			[switch]
				variable=random_dummy_hill
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Hh
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Hd
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Uh
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_create_rocks
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_create_rocks
			[/store_unit]
			{FOREACH able_to_create_rocks a}
				[set_variable]
					name=able_to_create_rocks[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_create_rocks[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_create_rocks[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_create_rocks}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_create_rocks_zhelp
        description= _ "Create Hills Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_create_rocks
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To create hills right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to create hills, each create takes 6 mp.
Every creating adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define CREATE_ROCKS_HERO_MENU_2_ITEM
    [set_menu_item]
        id=MWC_hero_2_create_rocks
        description= _ "Create mountains"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_create_rocks
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Ha,Hh,Hhd,Hd,Uh,Ha^Ii,Hh^Ii,Hhd^Ii,Hd^Ii,Uh^Ii
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_mountain
				rand=1..3
			[/set_variable]
			[switch]
				variable=random_dummy_mountain
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Mm
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Md
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Ms
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_mountain}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_create_rocks
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_create_rocks_2
			[/store_unit]
			{FOREACH able_to_create_rocks_2 a}
				[set_variable]
					name=able_to_create_rocks_2[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_create_rocks_2[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_create_rocks_2[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_create_rocks_2}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_create_rocks_2_zhelp
        description= _ "Create Mountains Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_create_rocks
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To create mountains right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to create mountains, each create takes 6 mp.
Every creating adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define CREATE_ROCKS_HERO_MENU_3_ITEM
    [set_menu_item]
        id=MWC_hero_3_create_rocks
        description= _ "Create hills on trees"
        [show_if]
        [/show_if]

        [filter_location]
			[filter]
				ability=MWC_hero_create_rocks
				side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
			[/filter]
			terrain=Gg^Fet,Gs^Ft,Gll^Fp,Gs^Fds,Gd^Fdf,Gs^Fdw,Gs^Fms,Gll^Fmf,Gd^Fmw,Gd^Fetd,Gs^Fp,G*^F*,Gg^F*,Gs^F*,Gll^F*,Gd^F*,Rd^F*,Rb^F*,Rrc^F*,Re^F*,Rr^F*,Rp^F*,Urb^F*,Iwr^F*
        [/filter_location]
        [command]
            [store_gold]
                variable=actualgold
                side=$side_number
            [/store_gold]
            [if]
                [variable]
                    name=actualgold
                    greater_than_equal_to=5
                [/variable]
                [then]
                    [gold]
                        amount=-5
                        side=$side_number
                    [/gold]
			[set_variable]
				name=random_dummy_hill_tree
				rand=1..10
			[/set_variable]
			[switch]
				variable=random_dummy_hill_tree
				[case]
					value=1
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fpa
					[/terrain]
				[/case]
				[case]
					value=2
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fda
					[/terrain]
				[/case]
				[case]
					value=3
					[terrain]
						x,y=$x1,$y1
						terrain=Ha^Fma
					[/terrain]
				[/case]
				[case]
					value=4
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fp
					[/terrain]
				[/case]
				[case]
					value=5
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fds
					[/terrain]
				[/case]
				[case]
					value=6
					[terrain]
						x,y=$x1,$y1
						terrain=Hh^Fms
					[/terrain]
				[/case]
				[case]
					value=7
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdf
					[/terrain]
				[/case]
				[case]
					value=8
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fdw
					[/terrain]
				[/case]
				[case]
					value=9
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmf
					[/terrain]
				[/case]
				[case]
					value=10
					[terrain]
						x,y=$x1,$y1
						terrain=Hhd^Fmw
					[/terrain]
				[/case]
			[/switch]
			{CLEAR_VARIABLE random_dummy_hill_tree}
			[store_unit]
				[filter]
					x,y=$x1,$y1
					ability=MWC_hero_create_rocks
					side=$side_number
					[and]
						[not]
							[filter_wml]
								moves=0
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=1
							[/filter_wml]
						[/not]
					[/and]
					[and]
						[not]
							[filter_wml]
								moves=2
							[/filter_wml]
						[/not]
					[/and]
				[/filter]
				variable=able_to_create_rocks_3
			[/store_unit]
			{FOREACH able_to_create_rocks_3 a}
				[set_variable]
					name=able_to_create_rocks_3[$a].moves
					sub=6
				[/set_variable]

				{VARIABLE_OP able_to_create_rocks_3[$a].experience add 1}

				
				[unstore_unit]
					variable=able_to_create_rocks_3[$a]
					find_vacant=no
					text= _ "+$this_unit.level exp"
					red,green,blue=50,50,200
				[/unstore_unit]
				{CLEAR_VARIABLE able_to_create_rocks_3}
			{NEXT a}
                [/then]
                [else]
                    [message]
                        speaker=narrator
                        side_for=$side_number
                        caption=_ "Error"
                        message= _ "I have insufficient materials. I am unable to do what you want."
                        image=wesnoth-icon.png
                    [/message]
                [/else]
            [/if]
        [/command]
    [/set_menu_item]
    ####
    ####
    [set_menu_item]
        id=MWC_hero_create_rocks_3_zhelp
        description= _ "Create Hills On Trees Help"
        [show_if]
        [/show_if]

        [filter_location]
            [filter]
				ability=MWC_hero_create_rocks
                side=$side_number
            [/filter]
        [/filter_location]
        [command]
            [message]
                speaker=narrator
                side_for=$side_number
                caption=_ "Help"
                message= _ "To create hills on trees right-click on unit with this ability.
                    
You need atleast 3 mp (and 5 gold) to create hills on trees, each create takes 6 mp.
Every creating adds +1 to current experience."
                image=wesnoth-icon.png
            [/message]
        [/command]
    [/set_menu_item]
#enddef


#define ABILITY_MWCREGENERATES6
    [regenerate]
        value=6
        id=regen6
        name= _ "regenerates +6"
        description= _ "At the beginning of each turn this unit heals +6 hp. If it is poisoned, it will remove it instead of healing."
        affect_self=yes
        poison=cured
    [/regenerate]
#enddef


#define WEAPON_SPECIAL_SWALLOW
    [damage]
        id=swallow
        name= _ "swallow +4"
        name_inactive= _ "swallow +4"
        description= _ "This unit gains 4 hitpoints added to its current health whenever it kills a living unit."
    [/damage]
#enddef

#define SWALLOW_EVENT
    [event]
        name=die
        first_time_only=no

        [filter]
            [not]
                [filter_wml]
                    [status]
                        not_living="yes"
                    [/status]
                [/filter_wml]
            [/not]
        [/filter]

        [filter_second_attack]
            name=fangswyv
        [/filter_second_attack]

        [unstore_unit]
            variable=second_unit
            {COLOR_HEAL}
            text= _ "4"
            find_vacant=no
        [/unstore_unit]

        [object]
            silent=yes
            duration=forever

            [filter]
                x,y=$x2,$y2
            [/filter]

            [effect]
                apply_to=hitpoints
                increase=4
            [/effect]
        [/object]
    [/event]
#enddef



#define ABILITY_ULTRACURES
    [heals]
        value=12
        id=healing
        affect_allies=yes
        name= _ "ultracures"
        description= _ "Allows the unit to heal adjacent friendly units at the beginning of each turn.

A unit cared for by this healer may heal up to 12 HP per turn.
A curer can cure a unit of poison, although that unit will receive no additional healing on the turn it is cured of the poison."
        affect_self=no
        poison=cured
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
        [/affect_adjacent]
    [/heals]
    [regenerate]
        value=12
        id=healing
        affect_self=yes
        poison=cured
    [/regenerate]
#enddef


#define ABILITY_MOUNTAINAMBUSH
    [hides]
        id=mountainambush
        name= _ "mountain ambush"
        name_inactive= _ " mountain ambush"
        description= _ "This unit can hide in mountains and hills, and remain undetected by its enemies. Enemy units cannot see this unit while it is in mountains or hills, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        description_inactive= _ "This unit can hide in mountains and hills, and remain undetected by its enemies. Enemy units cannot see this unit while it is in mountains or hills, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        affect_self=yes
        [filter_self]
            [filter_location]
                terrain=Hd*,Hh*,Ha*,Mm*,Md*,Ms*,Uh*,Hd^*,Hh^*,Ha^*,Mm^*,Md^*,Ms^*,Uh^*
            [/filter_location]
        [/filter_self]
    [/hides]
#enddef


#define ABILITY_CHAMELEON
    # Canned definition of the Chameleon ability to be included in an
    # [abilities] clause.
    [hides]
        id=chameleon
        name=_"chameleon"
        female_name=_"female^chameleon"
        description=_"The unit can change its color like a chameleon. Enemy units cannot see this unit when it's standing on place, except if they have units next to it. Any enemy unit that first discovers this unit immediately loses all its remaining movement."
        affect_self=yes
	alert=_"Chameleon!"
	[filter_self]
	    [filter_wml]
		moves=$this_unit.max_moves
	    [/filter_wml]
	[/filter_self]
    [/hides]
#enddef

#define ANIM_CHAMELEON
# definition of animations needed for chameleons
# to be added after [movement_anim] clause

[+movement_anim]
    alpha=0.9
[/movement_anim]

[pre_movement_anim]
    alpha=0.8~0.9
    [frame]
	duration=150
    [/frame]
[/pre_movement_anim]

[standing_anim]
    alpha=0.8~0.3:5000,0.3,0.3~0.8:5000
    [frame]
	duration=3600000
    [/frame]
[/standing_anim]

[post_movement_anim]
    alpha=0.9~0.8
    [frame]
	duration=200
    [/frame]
[/post_movement_anim]

#enddef

#define ABILITY_MWCFURY
    [dummy]
        id=mwcfury
        name= _ "fury"
        description= _ "This unit can attack another unit after killing an enemy."
    [/dummy] # wmlxgettext: [abilities]
[/abilities]
[event]
    name=die
    first_time_only=no
    [filter_second]
        side=$side_number
        ability=mwcfury
    [/filter_second]

    [store_unit]
        variable=mwcfurious
        [filter]
            x,y=$x2,$y2
        [/filter]
    [/store_unit]
    {VARIABLE_OP mwcfurious.attacks_left add 1}
	#{CLEAR_VARIABLE mwcfurious.status.poisoned}
	#{CLEAR_VARIABLE mwcfurious.status.slowed}
    [unstore_unit]
        variable=mwcfurious
        {COLOR_HARM}
        text= _ "FURY!"
        find_vacant=no
    [/unstore_unit]
[/event]
[+abilities] # wmlxgettext: [/abilities]
#enddef


#define SECOND_ATTACK
    [set_variable]
        name=tmp_double_attack_unit_store.attacks_left
        add=1
    [/set_variable]

    [set_variables]
        name=tmp_double_attack_unit_store.variables
        mode=merge
        [value]
            double_attack_attacked=yes
            double_attack_turn=$turn_number
        [/value]
    [/set_variables]

    [unstore_unit]
        text= _ "double attack"
        {COLOR_HARM}
        variable=tmp_double_attack_unit_store
    [/unstore_unit]
#enddef

#define WEAPON_SPECIAL_DOUBLE_ATTACK
# wmlxgettext: [attack]
# wmlxgettext: [specials]
    [dummy]
        id=double attack
        name= _ "double attack"
        description= _ "This unit can attack two enemies in one turn, but cannot move from a hex, where the first enemy was attacked."
    [/dummy]
[/specials]
[/attack]

[event]
    name=attack_end
    first_time_only=no
    [filter_attack]
        special=double attack
    [/filter_attack]

    [store_unit]
        [filter]
            id=$unit.id
        [/filter]
        variable=tmp_double_attack_unit_store
    [/store_unit]

    [if]
        [variable]
            name=tmp_double_attack_unit_store.variables.double_attack_attacked
            boolean_not_equals=yes
        [/variable]

        [then]
            {SECOND_ATTACK}
        [/then]

        [else]
            [if]
                [variable]
                    name=tmp_double_attack_unit_store.variables.double_attack_turn
                    not_equals=$turn_number
                [/variable]

                [then]
                    {SECOND_ATTACK}
                [/then]
            [/if]
        [/else]
    [/if]
[/event]

[event]
    name=side turn
    first_time_only=no

    [clear_variable]
        name=tmp_double_attack_unit_store
    [/clear_variable]
[/event]

[event]
    name=victory

    [clear_variable]
        name=tmp_double_attack_unit_store
    [/clear_variable]
[/event]
[+attack]
[+specials]
# wmlxgettext: [/specials]
# wmlxgettext: [/attack]
#enddef


#define SPLIT_FIRE_SECOND_ATTACK
    [set_variable]
        name=tmp_split_fire_unit_store.attacks_left
        add=1
    [/set_variable]

    [if]
        [variable]
            name=tmp_split_fire_unit_store.variables.split_fire_attacked
            boolean_not_equals=yes
        [/variable]

        [then]
           {FOREACH tmp_split_fire_unit_store.attack i}
				{VARIABLE tmp_split_fire_variable 0}
					{FOREACH tmp_split_fire_unit_store.attack[$i].specials.dummy k}
						[if]
							[variable]
								name=tmp_split_fire_unit_store.attack[$i].specials.dummy[$k].id
								not_equals="split fire"
							[/variable]
							[then]
							[/then]
							[else]
								{VARIABLE_OP tmp_split_fire_variable add 1}
							[/else]
						[/if]
					{NEXT k}
				[if]
					[variable]
						name="tmp_split_fire_variable"
						equals=0
					[/variable]
					[then]
						[set_variable]
							name=tmp_split_fire_unit_store.attack[$i].attack_weight
							value=0
						[/set_variable]
					[/then]
				[/if]
                #[if]
                #    [variable]
                #        name=tmp_split_fire_unit_store.attack[$i].name
                #        not_equals={ATTACK_NAME}
                #    [/variable]
				#
                #    [then]
                #        [set_variable]
                #            name=tmp_split_fire_unit_store.attack[$i].attack_weight
                #            value=0
                #        [/set_variable]
                #    [/then]
                #[/if]
            {NEXT i}
        [/then]
    [/if]

    [set_variables]
        name=tmp_split_fire_unit_store.variables
        mode=merge
        [value]
            split_fire_attacked=yes
            split_fire_turn=$turn_number
        [/value]
    [/set_variables]

    [unstore_unit]
        text= _ "second target"
        {COLOR_HARM}
        variable=tmp_split_fire_unit_store
    [/unstore_unit]
#enddef





#define WEAPON_SPECIAL_SPLIT_FIRE
# wmlxgettext: [attack]
# wmlxgettext: [specials]
    [dummy]
        id=split fire
        name= _ "split fire"
        description="This unit can attack two enemies in one turn with this attack."
    [/dummy]
[/specials]
[/attack]

[event]
    name=side turn
    first_time_only=no

	[filter_attack]
		special="split fire"
	[/filter_attack]   
    [store_unit]
       #[filter]
       #	type={TYPE}
       #[/filter]
        variable=split_fire_unit_store
     mode=append
    [/store_unit]

    {FOREACH split_fire_unit_store i}
        [if]
            [variable]
                name=split_fire_unit_store[$i].variables.split_fire_attacked
                boolean_equals=yes
            [/variable]

            [then]
                {FOREACH split_fire_unit_store[$i].attack j}
					{VARIABLE split_fire_variable 0}
					{FOREACH split_fire_unit_store[$i].attack[$j].specials.dummy k}
						[if]
							[variable]
								name=split_fire_unit_store[$i].attack[$j].specials.dummy[$k].id
								not_equals="split fire"
							[/variable]
							[then]
							[/then]
							[else]
								{VARIABLE_OP split_fire_variable add 1}
							[/else]
						[/if]
					{NEXT k}
					[if]
						[variable]
							name="split_fire_variable"
							equals=0
						[/variable]
						[then]
							[set_variable]
								name=split_fire_unit_store[$i].attack[$j].attack_weight
								add=1
							[/set_variable]
						[/then]
					[/if]
                #    [if]
                #        [variable]
                #            name=split_fire_unit_store[$i].attack[$j].name
                #            not_equals={ATTACK_NAME}
                #        [/variable]
				#
                #        [then]
                #            [set_variable]
                #                name=split_fire_unit_store[$i].attack[$j].attack_weight
                #                add=1
                #            [/set_variable]
                #        [/then]
                #    [/if]
                {NEXT j}

                [set_variable]
                    name=split_fire_unit_store[$i].variables.split_fire_attacked
                    value=no
                [/set_variable]

                [unstore_unit]
                    variable=split_fire_unit_store[$i]
                [/unstore_unit]
            [/then]
        [/if]
    {NEXT i}
[/event]

[event]
    name=attack_end
    first_time_only=no
    [filter_attack]
        special="split fire"
    [/filter_attack]

    #[filter]
    #    type={TYPE}
    #[/filter]

    [store_unit]
        [filter]
            id=$unit.id
        [/filter]
        variable=tmp_split_fire_unit_store
    [/store_unit]

    [if]
        [variable]
            name=tmp_split_fire_unit_store.variables.split_fire_attacked
            boolean_not_equals=yes
        [/variable]

        [then]
            {SPLIT_FIRE_SECOND_ATTACK}
        [/then]

        [else]
            [if]
                [variable]
                    name=tmp_split_fire_unit_store.variables.split_fire_turn
                    not_equals=$turn_number
                [/variable]

                [then]
                    {SPLIT_FIRE_SECOND_ATTACK}
                [/then]
            [/if]
        [/else]
    [/if]
[/event]

[event]
    name=victory

    [clear_variable]
        name=tmp_split_fire_unit_store,split_fire_unit_store,split_fire_variable,tmp_split_fire_variable
    [/clear_variable]
[/event]
[+attack]
[+specials]
# wmlxgettext: [/specials]
# wmlxgettext: [/attack]
#enddef


#define ABILITY_MWC_LEADERSHIP_BARBARIANS
    [leadership]
        id=leadership
        value=30
        cumulative=no
        name= _ "barbarians leader"
        description= _ "This unit can lead our own Orcs, Goblins, Cyclops, Saurians, Monsters and Salamanders that are next to it, making them fight better.

Adjacent own Orcs, Goblins, Cyclops, Saurians, Monsters and Salamanders will do more damage in battle (30% more)."
        affect_self=no
		affect_allies=yes
		affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
                race=orc
            [/filter]		
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=30
        cumulative=no
        affect_self=no
		affect_allies=yes
		affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
				race=lizard
            [/filter]		
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=30
        cumulative=no
        affect_self=no
		affect_allies=yes
		affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
				race=Mwc_salamander
            [/filter]		
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=30
        cumulative=no
        affect_self=no
		affect_allies=yes
		affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
				race=goblin
            [/filter]		
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=30
        cumulative=no
        affect_self=no
		affect_allies=yes
		affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
				race=Mwc_cyclop
            [/filter]		
        [/affect_adjacent]
    [/leadership]
    [leadership]
        id=leadership
        value=30
        cumulative=no
        affect_self=no
		affect_allies=yes
		affect_enemies=no
        [affect_adjacent]
            adjacent=n,ne,se,s,sw,nw
            [filter]
				race=monster
            [/filter]		
        [/affect_adjacent]
    [/leadership]
#enddef


#define WEAPON_SPECIAL_MWC_CONCENTRATED
    [damage]
        id=mwcgrowingfury
        name= _ "growing fury"
        name_inactive= _ "growing fury"
        description= _ "When this attack is used, this units damage increases after each successful hit (+4)."
    [/damage]
#enddef

#define CONCENTRATED_EVENTS
    #Attack	
	[event]
		name=attack
		first_time_only=no
		id=mwccyclopsgrowingfurya
        [filter]
            type=Mwc_Young_Cyclops,Mwc_Cyclops,Mwc_Cyclops_Breaker,Mwc_Baby_Cyclops,Mwc_Cyclops_Giant_Breaker
        [/filter]
		[store_unit]
			[filter]
				x,y=$x1,$y1
			[/filter]
			variable=dmgmemo
		[/store_unit]
	[/event]
    [event]
        name=attacker hits
        first_time_only=no
		id=mwccyclopsgrowingfuryb
        [filter]
            type=Mwc_Young_Cyclops,Mwc_Cyclops,Mwc_Cyclops_Breaker,Mwc_Baby_Cyclops,Mwc_Cyclops_Giant_Breaker
        [/filter]
        [set_variable]
            name=unit.attack[0].damage
            add=4
        [/set_variable]
        [unstore_unit]
            variable=unit
        [/unstore_unit]
    [/event]
	[event]
        name=attack end
		first_time_only=no
		id=mwccyclopsgrowingfuryc
        [filter]
            type=Mwc_Young_Cyclops,Mwc_Cyclops,Mwc_Cyclops_Breaker,Mwc_Baby_Cyclops,Mwc_Cyclops_Giant_Breaker
        [/filter]
		[set_variable]
            name=unit.attack[0].damage
			value=$dmgmemo.attack[0].damage
        [/set_variable]
        [unstore_unit]
            variable=unit
        [/unstore_unit]
    [/event]
	#defense
	[event]
		name=attack
		first_time_only=no
		id=mwccyclopsgrowingfuryd
        [filter_second]
            type=Mwc_Young_Cyclops,Mwc_Cyclops,Mwc_Cyclops_Breaker,Mwc_Baby_Cyclops,Mwc_Cyclops_Giant_Breaker
        [/filter_second]
		[store_unit]
			[filter]
				x,y=$x2,$y2
			[/filter]
			variable=dmgmemo2
		[/store_unit]
	[/event]
    [event]
        name=defender hits
        first_time_only=no
		id=mwccyclopsgrowingfurye
        [filter_second]
            type=Mwc_Young_Cyclops,Mwc_Cyclops,Mwc_Cyclops_Breaker,Mwc_Baby_Cyclops,Mwc_Cyclops_Giant_Breaker
        [/filter_second]
        [set_variable]
            name=second_unit.attack[0].damage
            add=4
        [/set_variable]
        [unstore_unit]
            variable=second_unit
        [/unstore_unit]
    [/event]
	[event]
        name=attack end
		first_time_only=no
		id=mwccyclopsgrowingfuryf
        [filter_second]
            type=Mwc_Young_Cyclops,Mwc_Cyclops,Mwc_Cyclops_Breaker,Mwc_Baby_Cyclops,Mwc_Cyclops_Giant_Breaker
        [/filter_second]
		[set_variable]
            name=second_unit.attack[0].damage
			value=$dmgmemo2.attack[0].damage
        [/set_variable]
        [unstore_unit]
            variable=second_unit
        [/unstore_unit]
    [/event]
#enddef




#define MWC_FURIOUSDEATH_EVENT
    #Mad
    [event]
        name=die
        first_time_only=no
        [filter]
            type=Mwc_Raging_Cyclops
        [/filter]
        [store_locations]
            x=$x1
            y=$y1
            variable=loc_store
            radius=1
        [/store_locations]
        {MWC_DAMAGE_HEX 2 18}
        {MWC_DAMAGE_HEX 5 18}
        {MWC_DAMAGE_HEX 6 18}
        {MWC_DAMAGE_HEX 4 18}
        {MWC_DAMAGE_HEX 1 18}
        {MWC_DAMAGE_HEX 0 18}
        #[unstore_unit]
        #variable=unit_store
        #	red=0
        #	green=127
        #	blue=127
        #	text=DAMAGE SPELL
        #[/unstore_unit]
    [/event]
#enddef

#define MWC_FURIOUSDEATH2_EVENT
    #Destroyer
    [event]
        name=die
        first_time_only=no
        [filter]
            type=Mwc_Cyclops_Destroyer
        [/filter]

        [store_locations]
            x=$x1
            y=$y1
            variable=loc_store
            radius=1
        [/store_locations]
        {MWC_DAMAGE_HEX 2 27}
        {MWC_DAMAGE_HEX 5 27}
        {MWC_DAMAGE_HEX 6 27}
        {MWC_DAMAGE_HEX 4 27}
        {MWC_DAMAGE_HEX 1 27}
        {MWC_DAMAGE_HEX 0 27}
        #[unstore_unit]
        #variable=unit_store
        #	red=0
        #	green=127
        #	blue=127
        #	text=DAMAGE SPELL
        #[/unstore_unit]
        {CLEAR_VARIABLE loc_store}
    [/event]

#enddef


#define MWC_FURIOUSDEATH3_EVENT
    #Destroyer
    [event]
        name=die
        first_time_only=no
        [filter]
            type=Mwc_Demonically_Possessed_Cyclops_Destroyer
        [/filter]

        [store_locations]
            x=$x1
            y=$y1
            variable=loc_store
            radius=1
        [/store_locations]
        {MWC_DAMAGE_HEX 2 36}
        {MWC_DAMAGE_HEX 5 36}
        {MWC_DAMAGE_HEX 6 36}
        {MWC_DAMAGE_HEX 4 36}
        {MWC_DAMAGE_HEX 1 36}
        {MWC_DAMAGE_HEX 0 36}
        #[unstore_unit]
        #variable=unit_store
        #	red=0
        #	green=127
        #	blue=127
        #	text=DAMAGE SPELL
        #[/unstore_unit]
        {CLEAR_VARIABLE loc_store}
    [/event]

#enddef

#define ABILITY_MWC_FURIOUSDEATH
    [damage]
        id=mwcfuriousdeath
        name= _ "furious death"
        description= _ "Moments before this unit's death, it flies into a fury. The unit with this ability attacks all adjacent units and then it finally dies."
    [/damage]
#enddef



#define MWC_DAMAGE_HEX NO DMG
    [store_unit]
        [filter]
            x=$loc_store[{NO}].x
            y=$loc_store[{NO}].y
        [/filter]
        kill=no
        variable=mhd_store
    [/store_unit]
    [if]
        [have_unit]
            find_in=mhd_store
            [filter_adjacent]
                is_enemy=no
                ability=mwcawake
            [/filter_adjacent]
        [/have_unit]
        [then]
            [store_unit]
                [filter]
                    x=$loc_store[{NO}].x
                    y=$loc_store[{NO}].y
                [/filter]
                kill=no
                variable=candidate.a
            [/store_unit]
        [/then]
    [/if]
    [if]
        [variable]
            name=mhd_store.hitpoints
            less_than_equal_to={DMG}
        [/variable]
        [then]
            [if]
                [have_unit]
                    x=$loc_store[{NO}].x
                    y=$loc_store[{NO}].y
                [/have_unit]
                [then]
                    [unstore_unit]
                        variable=mhd_store
                        {COLOR_HARM}
                        text="{DMG}"
                    [/unstore_unit]
                    [kill]
                        x=$loc_store[{NO}].x
                        y=$loc_store[{NO}].y
                        fire_event=yes
                        animate=yes
                    [/kill]
                [/then]
            [/if]
        [/then]
        [else]
            {VARIABLE dmgpuffer {DMG}}
            {VARIABLE_OP dmgpuffer multiply -1}
            {VARIABLE_OP mhd_store.hitpoints add $dmgpuffer}
            [unstore_unit]
                variable=mhd_store
                {COLOR_HARM}
                text="{DMG}"
            [/unstore_unit]
        [/else]
    [/if]
#enddef



#define CLEAVE_DAMAGE_HEX NUMBER
    [store_unit]
        [filter]
            x=$loc_store[{NUMBER}].x
            y=$loc_store[{NUMBER}].y
        [/filter]
        kill=no
        variable=cleave_defender_store
    [/store_unit]

    [if]
        [variable]
            name=cleave_defender_store.status.petrified
            not_equals=yes
        [/variable]

        [then]
            [if]
                [have_unit]
                    find_in=cleave_defender_store
                    [filter_adjacent]
                        is_enemy=no
                        ability=mwcawake
                    [/filter_adjacent]
                [/have_unit]

                [then]
                    [store_unit]
                        [filter]
                            x=$loc_store[{NUMBER}].x
                            y=$loc_store[{NUMBER}].y
                        [/filter]
                        kill=no
                        variable=awakememo2
                    [/store_unit]
                [/then]
                [else]
                    {CLEAR_VARIABLE awakememo2}
                [/else]
            [/if]

            [harm_unit]
                [filter]
                    x=$cleave_defender_store.x
                    y=$cleave_defender_store.y
                [/filter]

                amount=$tmp_cleave_damage
                alignment=$unit_with_cleave.alignment
                damage_type=$tmp_cleave_attack_type
                kill=yes
                fire_event=yes
                animate=yes
            [/harm_unit]

            [if]
                [variable]
                    name=awakememo2.hitpoints
                    equals=1
                [/variable]
                [else]
                    [if]
                        [variable]
                            name=awakememo2.hitpoints
                            less_than_equal_to=0
                        [/variable]
                        [then]
                            {VARIABLE awakememo2.hitpoints 1}
                            [if]
                                [variable]
                                    name=awakememo2.gender
                                    equals=female
                                [/variable]
                                [then]
                                    [unstore_unit]
                                        variable=awakememo2
                                        find_vacant=no
                                        text= _ "female^awoken"
                                        {COLOR_HEAL}
                                    [/unstore_unit]
                                [/then]
                                [else]
                                    [unstore_unit]
                                        variable=awakememo2
                                        find_vacant=no
                                        text= _ "awoken"
                                        {COLOR_HEAL}
                                    [/unstore_unit]
                                [/else]
                            [/if]
                        [/then]
                    [/if]
                [/else]
            [/if]

            #
            [if]
                [have_unit]
                    x=$cleave_defender_store.x
                    y=$cleave_defender_store.y
                [/have_unit]
                [else]
                    {VARIABLE gimmexp $cleave_defender_store[$i].level}
                    {VARIABLE_OP gimmexp multiply 8}
                    {VARIABLE_OP unit.experience add $gimmexp}
                    {CLEAR_VARIABLE gimmexp}
                    [unstore_unit]
                        variable=unit
                        find_vacant=no
                    [/unstore_unit]
                [/else]
            [/if]
        [/then]
    [/if]

    [clear_variable]
        name=cleave_defender_store
    [/clear_variable]
#enddef

#define WEAPON_SPECIAL_CLEAVE
# wmlindent: start ignoring
# wmlxgettext: [attack]
# wmlxgettext: [specials]

# wmlindent: stop ignoring
    [dummy]
        id=cleave
        name= _ "cleave"
        description= _ "A unit with this ability can hurt units that are adjacent to the attacker and the defender at the same time."
    [/dummy]
[/specials]
# wmlindent: start ignoring
[/attack]
# wmlindent: stop ignoring

[event]
    name=attacker hits
    first_time_only=no
    [filter_attack]
        special=cleave
    [/filter_attack]

    [store_unit]
        variable=loc_store
        [filter]
            [filter_adjacent]
                x,y=$x2,$y2
            [/filter_adjacent]
            [filter_adjacent]
                x,y=$x1,$y1
            [/filter_adjacent]
        [/filter]
    [/store_unit]

    [store_unit]
        variable=unit_with_cleave
        [filter]
            id=$unit.id
        [/filter]
    [/store_unit]

    # Grab the attack's raw power and attack type
    {FOREACH unit_with_cleave i}
        [if]
            [variable]
                name=unit_with_cleave.attack[$i].name
                equals="tree2"
            [/variable]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="treemad"
				[/variable]
			[/or]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="treedestr"
				[/variable]
			[/or]

            [then]
                [set_variable]
                    name=tmp_cleave_damage
                    value=$unit_with_cleave.attack[$i].damage
                [/set_variable]

                [set_variable]
                    name=tmp_cleave_attack_type
                    value=$unit_with_cleave.attack[$i].type
                [/set_variable]
            [/then]
        [/if]
    {NEXT i}

    # Divide by two; four if the user is slowed
    [if]
        [variable]
            name=unit_with_cleave.status.slowed
            not_equals=yes
        [/variable]

        [then]
            [set_variable]
                name=tmp_cleave_damage
                divide=2
            [/set_variable]
        [/then]

        [else]
            [set_variable]
                name=tmp_cleave_damage
                divide=4
            [/set_variable]
        [/else]
    [/if]

    # Round down
    [set_variable]
        name=tmp_cleave_damage
        round=floor
    [/set_variable]

    # Deal the damage
    [switch]
        variable=loc_store.length
        [case]
            value=1
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
        [case]
            value=2
            {CLEAVE_DAMAGE_HEX 1}
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
    [/switch]

    [clear_variable]
        name=loc_store,unit_with_cleave,tmp_cleave_damage,tmp_cleave_attack_type
    [/clear_variable]
[/event]

[event]
    name=defender hits
    first_time_only=no
    [filter_second_attack]
        special=cleave
    [/filter_second_attack]

    [store_unit]
        variable=loc_store
        [filter]
            [filter_adjacent]
                x,y=$x2,$y2
            [/filter_adjacent]
            [filter_adjacent]
                x,y=$x1,$y1
            [/filter_adjacent]
        [/filter]
    [/store_unit]

    [store_unit]
        variable=unit_with_cleave
        [filter]
            id=$second_unit.id
        [/filter]
    [/store_unit]

    # Grab the attack's raw power and attack type
    {FOREACH unit_with_cleave i}
        [if]
            [variable]
                name=unit_with_cleave.attack[$i].name
                equals="tree2"
            [/variable]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="treemad"
				[/variable]
			[/or]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="treedestr"
				[/variable]
			[/or]

            [then]
                [set_variable]
                    name=tmp_cleave_damage
                    value=$unit_with_cleave.attack[$i].damage
                [/set_variable]

                [set_variable]
                    name=tmp_cleave_attack_type
                    value=$unit_with_cleave.attack[$i].type
                [/set_variable]
            [/then]
        [/if]
    {NEXT i}

    # Divide by two; four if the user is slowed
    [if]
        [variable]
            name=unit_with_cleave.status.slowed
            equals=yes
        [/variable]

        [then]
            [set_variable]
                name=tmp_cleave_damage
                divide=4
            [/set_variable]
        [/then]

        [else]
            [set_variable]
                name=tmp_cleave_damage
                divide=2
            [/set_variable]
        [/else]
    [/if]

    # Round down
    [set_variable]
        name=tmp_cleave_damage
        round=floor
    [/set_variable]

    # Deal the damage
    [switch]
        variable=loc_store.length
        [case]
            value=1
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
        [case]
            value=2
            {CLEAVE_DAMAGE_HEX 1}
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
    [/switch]

    [clear_variable]
        name=loc_store,unit_with_cleave,tmp_cleave_damage,tmp_cleave_attack_type_type
    [/clear_variable]
[/event]
[+attack]
# wmlindent: start ignoring

[+specials]
# wmlxgettext: [/specials]
# wmlxgettext: [/attack]
# wmlindent: stop ignoring
#enddef


#define WEAPON_SPECIAL_MWC_SPLIT_FIRE
    [dummy]
        id=split fire
        name= _ "split fire"
        description= _ "This unit can attack two enemies in one turn with this attack."
    [/dummy]
#enddef


#define WEAPON_SPECIAL_MWC_DOUBLE_ATTACK
    [dummy]
        id=double attack 2
        name= _ "double attack"
        description= _ "This unit can attack two enemies in one turn, but cannot move from a hex, where the first enemy was attacked."
    [/dummy]
#enddef

#define WEAPON_SPECIAL_MWC_CLEAVE
    [dummy]
        id=cleave 2
        name= _ "cleave"
        description= _ "A unit with this ability can hurt units that are adjacent to the attacker and the defender at the same time."
    [/dummy]
#enddef

























































#define EVENTS_START
	[event]
		name=attacker hits
		first_time_only=no 
		[filter_attack]
			special=shockwave
		[/filter_attack]
		[store_unit]
			[filter]
				 x,y=$x1,$y1
			[/filter]
			variable=harmer
			kill=no
		[/store_unit]
		[store_unit]
			[filter]
				 x,y=$x2,$y2
			[/filter]
			variable=primary_target
			kill=no
		[/store_unit]      #Stores the information about units to know their positions. Other targets are stored a bit lower, we need to damage them first.   
		[harm_unit]
			[filter]
				[filter_adjacent]
					x,y=$x2,$y2
					is_enemy=no
				[/filter_adjacent]
				[not]
					side=$harmer.side
				[/not]
				[not]
					x,y=$x2,$y2
				[/not]
			[/filter]
			[filter_second]
				x,y=$x1,$y1
			[/filter_second]
			amount=10
			slowed=yes
			damage_type=impact
			fire_event=yes
			experience=no
			animate=no
		[/harm_unit]       #Damages units, slowing them
		[store_unit]
			[filter]
				[filter_adjacent]
					x,y=$x2,$y2
					is_enemy=no
				[/filter_adjacent]
				[not]
					side=$harmer.side
				[/not]
				[not]
					x,y=$x2,$y2
				[/not]
			[/filter]
			variable=other_targets
			kill=yes      #We don't want to duplicate them.
		[/store_unit]   
		{FOREACH other_targets i}
		{VARIABLE move_x $other_targets[$i].x}
		{VARIABLE move_y $other_targets[$i].y}
		{VARIABLE_OP move_x sub $primary_target.x}
		{VARIABLE_OP move_y sub $primary_target.y}
		{VARIABLE_OP other_targets[$i].x add $move_x}
		{VARIABLE_OP other_targets[$i].y add $move_y}      #Get the directions from the primary targets to others, and move them into them.
		[unstore_unit]
			variable=other_targets[$i]
			find_vacant=yes
			check_passability=yes         #We don't want them to be knocked into walls, do we?
		[/unstore_unit]
		{NEXT i}
		{CLEAR_VARIABLE harmer}
		{CLEAR_VARIABLE primary_target}
		{CLEAR_VARIABLE other_targets}
		{CLEAR_VARIABLE move_x}
		{CLEAR_VARIABLE move_y}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=firststrike leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_firststrikeleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=firststrikeleadershipunits
		[/store_unit]
		{FOREACH firststrikeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$firststrikeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_FIRSTSTRIKE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$firststrikeleadershipunits[$i].id variables.updated_firststrikeleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE firststrikeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=firststrike leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_firststrikeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=firststrikeleadershipunits
		[/store_unit]
		{FOREACH firststrikeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$firststrikeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=firststrike forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$firststrikeleadershipunits[$i].id variables.updated_firststrikeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE firststrikeleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=firststrike leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_firststrikeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=firststrikeleadershipunits
		[/store_unit]
		{FOREACH firststrikeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$firststrikeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=firststrike forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$firststrikeleadershipunits[$i].id variables.updated_firststrikeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE firststrikeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=poison leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_poisonleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=poisonleadershipunits
		[/store_unit]
		{FOREACH poisonleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$poisonleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_POISON}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$poisonleadershipunits[$i].id variables.updated_poisonleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE poisonleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=poison leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_poisonleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=poisonleadershipunits
		[/store_unit]
		{FOREACH poisonleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$poisonleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				remove_specials=poison forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$poisonleadershipunits[$i].id variables.updated_poisonleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE poisonleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=poison leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_poisonleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=poisonleadershipunits
		[/store_unit]
		{FOREACH poisonleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$poisonleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				remove_specials=poison forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$poisonleadershipunits[$i].id variables.updated_poisonleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE poisonleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker fury leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerfuryleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerfuryleadershipunits
		[/store_unit]
		{FOREACH weakerfuryleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerfuryleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_FURY}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerfuryleadershipunits[$i].id variables.updated_weakerfuryleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerfuryleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker fury leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerfuryleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerfuryleadershipunits
		[/store_unit]
		{FOREACH weakerfuryleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerfuryleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker fury forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerfuryleadershipunits[$i].id variables.updated_weakerfuryleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerfuryleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker fury leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerfuryleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerfuryleadershipunits
		[/store_unit]
		{FOREACH weakerfuryleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerfuryleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker fury forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerfuryleadershipunits[$i].id variables.updated_weakerfuryleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerfuryleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=fury leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_furyleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=furyleadershipunits
		[/store_unit]
		{FOREACH furyleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$furyleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_FURY}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$furyleadershipunits[$i].id variables.updated_furyleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE furyleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=fury leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_furyleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=furyleadershipunits
		[/store_unit]
		{FOREACH furyleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$furyleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=fury forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$furyleadershipunits[$i].id variables.updated_furyleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE furyleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=fury leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_furyleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=furyleadershipunits
		[/store_unit]
		{FOREACH furyleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$furyleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=fury forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$furyleadershipunits[$i].id variables.updated_furyleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE furyleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger fury leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerfuryleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerfuryleadershipunits
		[/store_unit]
		{FOREACH strongerfuryleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerfuryleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_FURY}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerfuryleadershipunits[$i].id variables.updated_strongerfuryleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerfuryleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger fury leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerfuryleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerfuryleadershipunits
		[/store_unit]
		{FOREACH strongerfuryleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerfuryleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger fury forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerfuryleadershipunits[$i].id variables.updated_strongerfuryleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerfuryleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger fury leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerfuryleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerfuryleadershipunits
		[/store_unit]
		{FOREACH strongerfuryleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerfuryleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger fury forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerfuryleadershipunits[$i].id variables.updated_strongerfuryleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerfuryleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=berserk leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_berserkleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=berserkleadershipunits
		[/store_unit]
		{FOREACH berserkleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$berserkleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_BERSERK}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$berserkleadershipunits[$i].id variables.updated_berserkleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE berserkleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=berserk leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_berserkleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=berserkleadershipunits
		[/store_unit]
		{FOREACH berserkleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$berserkleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=berserk forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$berserkleadershipunits[$i].id variables.updated_berserkleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE berserkleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=berserk leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_berserkleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=berserkleadershipunits
		[/store_unit]
		{FOREACH berserkleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$berserkleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=berserk forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$berserkleadershipunits[$i].id variables.updated_berserkleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE berserkleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=marksman leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_marksmanleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=marksmanleadershipunits
		[/store_unit]
		{FOREACH marksmanleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$marksmanleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_MARKSMAN}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$marksmanleadershipunits[$i].id variables.updated_marksmanleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE marksmanleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=marksman leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_marksmanleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=marksmanleadershipunits
		[/store_unit]
		{FOREACH marksmanleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$marksmanleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=marksman forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$marksmanleadershipunits[$i].id variables.updated_marksmanleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE marksmanleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=marksman leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_marksmanleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=marksmanleadershipunits
		[/store_unit]
		{FOREACH marksmanleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$marksmanleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=marksman forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$marksmanleadershipunits[$i].id variables.updated_marksmanleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE marksmanleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=backstab leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_backstableadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=backstableadershipunits
		[/store_unit]
		{FOREACH backstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$backstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_BACKSTAB}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$backstableadershipunits[$i].id variables.updated_backstableadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE backstableadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=backstab leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_backstableadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=backstableadershipunits
		[/store_unit]
		{FOREACH backstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$backstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=backstab forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$backstableadershipunits[$i].id variables.updated_backstableadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE backstableadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=backstab leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_backstableadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=backstableadershipunits
		[/store_unit]
		{FOREACH backstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$backstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=backstab forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$backstableadershipunits[$i].id variables.updated_backstableadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE backstableadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker backstab leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerbackstableadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerbackstableadershipunits
		[/store_unit]
		{FOREACH weakerbackstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerbackstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_BACKSTAB}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerbackstableadershipunits[$i].id variables.updated_weakerbackstableadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerbackstableadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker backstab leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerbackstableadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerbackstableadershipunits
		[/store_unit]
		{FOREACH weakerbackstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerbackstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker backstab forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerbackstableadershipunits[$i].id variables.updated_weakerbackstableadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerbackstableadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker backstab leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerbackstableadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerbackstableadershipunits
		[/store_unit]
		{FOREACH weakerbackstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerbackstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker backstab forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerbackstableadershipunits[$i].id variables.updated_weakerbackstableadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerbackstableadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger backstab leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerbackstableadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerbackstableadershipunits
		[/store_unit]
		{FOREACH strongerbackstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerbackstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_BACKSTAB}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerbackstableadershipunits[$i].id variables.updated_strongerbackstableadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerbackstableadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger backstab leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerbackstableadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerbackstableadershipunits
		[/store_unit]
		{FOREACH strongerbackstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerbackstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger backstab forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerbackstableadershipunits[$i].id variables.updated_strongerbackstableadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerbackstableadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger backstab leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerbackstableadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerbackstableadershipunits
		[/store_unit]
		{FOREACH strongerbackstableadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerbackstableadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger backstab forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerbackstableadershipunits[$i].id variables.updated_strongerbackstableadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerbackstableadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=slow leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_slowleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=slowleadershipmeleeunits
		[/store_unit]
		{FOREACH slowleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$slowleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_SLOW_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$slowleadershipmeleeunits[$i].id variables.updated_slowleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE slowleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=slow leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_slowleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=slowleadershipmeleeunits
		[/store_unit]
		{FOREACH slowleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$slowleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=slow forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$slowleadershipmeleeunits[$i].id variables.updated_slowleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE slowleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=slow leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_slowleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=slowleadershipmeleeunits
		[/store_unit]
		{FOREACH slowleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$slowleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=slow forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$slowleadershipmeleeunits[$i].id variables.updated_slowleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE slowleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=slow leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_slowleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=slowleadershiprangedunits
		[/store_unit]
		{FOREACH slowleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$slowleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_SLOW_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$slowleadershiprangedunits[$i].id variables.updated_slowleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE slowleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=slow leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_slowleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=slowleadershiprangedunits
		[/store_unit]
		{FOREACH slowleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$slowleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=slow forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$slowleadershiprangedunits[$i].id variables.updated_slowleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE slowleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=slow leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_slowleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=slowleadershiprangedunits
		[/store_unit]
		{FOREACH slowleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$slowleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=slow forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$slowleadershiprangedunits[$i].id variables.updated_slowleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE slowleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=magical leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_magicalleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=magicalleadershipmeleeunits
		[/store_unit]
		{FOREACH magicalleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$magicalleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_MAGICAL_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$magicalleadershipmeleeunits[$i].id variables.updated_magicalleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE magicalleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=magical leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_magicalleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=magicalleadershipmeleeunits
		[/store_unit]
		{FOREACH magicalleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$magicalleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=magical forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$magicalleadershipmeleeunits[$i].id variables.updated_magicalleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE magicalleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=magical leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_magicalleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=magicalleadershipmeleeunits
		[/store_unit]
		{FOREACH magicalleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$magicalleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=magical forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$magicalleadershipmeleeunits[$i].id variables.updated_magicalleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE magicalleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=magical leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_magicalleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=magicalleadershiprangedunits
		[/store_unit]
		{FOREACH magicalleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$magicalleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_MAGICAL_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$magicalleadershiprangedunits[$i].id variables.updated_magicalleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE magicalleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=magical leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_magicalleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=magicalleadershiprangedunits
		[/store_unit]
		{FOREACH magicalleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$magicalleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=magical forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$magicalleadershiprangedunits[$i].id variables.updated_magicalleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE magicalleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=magical leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_magicalleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=magicalleadershiprangedunits
		[/store_unit]
		{FOREACH magicalleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$magicalleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=magical forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$magicalleadershiprangedunits[$i].id variables.updated_magicalleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE magicalleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=charge leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_chargeleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=chargeleadershipunits
		[/store_unit]
		{FOREACH chargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$chargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_CHARGE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$chargeleadershipunits[$i].id variables.updated_chargeleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE chargeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=charge leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_chargeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=chargeleadershipunits
		[/store_unit]
		{FOREACH chargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$chargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=charge forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$chargeleadershipunits[$i].id variables.updated_chargeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE chargeleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=charge leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_chargeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=chargeleadershipunits
		[/store_unit]
		{FOREACH chargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$chargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=charge forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$chargeleadershipunits[$i].id variables.updated_chargeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE chargeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker charge leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerchargeleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerchargeleadershipunits
		[/store_unit]
		{FOREACH weakerchargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerchargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_CHARGE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerchargeleadershipunits[$i].id variables.updated_weakerchargeleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerchargeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker charge leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerchargeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerchargeleadershipunits
		[/store_unit]
		{FOREACH weakerchargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerchargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker charge forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerchargeleadershipunits[$i].id variables.updated_weakerchargeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerchargeleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker charge leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerchargeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerchargeleadershipunits
		[/store_unit]
		{FOREACH weakerchargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerchargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker charge forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerchargeleadershipunits[$i].id variables.updated_weakerchargeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerchargeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger charge leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerchargeleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerchargeleadershipunits
		[/store_unit]
		{FOREACH strongerchargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerchargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_CHARGE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerchargeleadershipunits[$i].id variables.updated_strongerchargeleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerchargeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger charge leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerchargeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerchargeleadershipunits
		[/store_unit]
		{FOREACH strongerchargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerchargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger charge forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerchargeleadershipunits[$i].id variables.updated_strongerchargeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerchargeleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger charge leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerchargeleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerchargeleadershipunits
		[/store_unit]
		{FOREACH strongerchargeleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerchargeleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger charge forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerchargeleadershipunits[$i].id variables.updated_strongerchargeleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerchargeleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=drain leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_drainleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=drainleadershipmeleeunits
		[/store_unit]
		{FOREACH drainleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$drainleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_DRAIN_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$drainleadershipmeleeunits[$i].id variables.updated_drainleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE drainleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=drain leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_drainleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=drainleadershipmeleeunits
		[/store_unit]
		{FOREACH drainleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$drainleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=drain forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$drainleadershipmeleeunits[$i].id variables.updated_drainleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE drainleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=drain leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_drainleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=drainleadershipmeleeunits
		[/store_unit]
		{FOREACH drainleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$drainleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=drain forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$drainleadershipmeleeunits[$i].id variables.updated_drainleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE drainleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=drain leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_drainleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=drainleadershiprangedunits
		[/store_unit]
		{FOREACH drainleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$drainleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_DRAIN_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$drainleadershiprangedunits[$i].id variables.updated_drainleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE drainleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=drain leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_drainleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=drainleadershiprangedunits
		[/store_unit]
		{FOREACH drainleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$drainleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=drain forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$drainleadershiprangedunits[$i].id variables.updated_drainleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE drainleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=drain leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_drainleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=drainleadershiprangedunits
		[/store_unit]
		{FOREACH drainleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$drainleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=drain forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$drainleadershiprangedunits[$i].id variables.updated_drainleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE drainleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=plague leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_plagueleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=plagueleadershipunits
		[/store_unit]
		{FOREACH plagueleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$plagueleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_PLAGUE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$plagueleadershipunits[$i].id variables.updated_plagueleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE plagueleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=plague leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_plagueleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=plagueleadershipunits
		[/store_unit]
		{FOREACH plagueleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$plagueleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=plague forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$plagueleadershipunits[$i].id variables.updated_plagueleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE plagueleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=plague leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_plagueleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=plagueleadershipunits
		[/store_unit]
		{FOREACH plagueleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$plagueleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=plague forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$plagueleadershipunits[$i].id variables.updated_plagueleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE plagueleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger focus leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerfocusleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerfocusleadershipunits
		[/store_unit]
		{FOREACH strongerfocusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerfocusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_FOCUS}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerfocusleadershipunits[$i].id variables.updated_strongerfocusleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerfocusleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger focus leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerfocusleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerfocusleadershipunits
		[/store_unit]
		{FOREACH strongerfocusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerfocusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger focus forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerfocusleadershipunits[$i].id variables.updated_strongerfocusleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerfocusleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger focus leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerfocusleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerfocusleadershipunits
		[/store_unit]
		{FOREACH strongerfocusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerfocusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger focus forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerfocusleadershipunits[$i].id variables.updated_strongerfocusleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerfocusleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=focus leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_focusleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=focusleadershipunits
		[/store_unit]
		{FOREACH focusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$focusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_FOCUS}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$focusleadershipunits[$i].id variables.updated_focusleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE focusleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=focus leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_focusleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=focusleadershipunits
		[/store_unit]
		{FOREACH focusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$focusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=focus forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$focusleadershipunits[$i].id variables.updated_focusleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE focusleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=focus leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_focusleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=focusleadershipunits
		[/store_unit]
		{FOREACH focusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$focusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=focus forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$focusleadershipunits[$i].id variables.updated_focusleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE focusleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker focus leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerfocusleadershipunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerfocusleadershipunits
		[/store_unit]
		{FOREACH weakerfocusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerfocusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_FOCUS}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerfocusleadershipunits[$i].id variables.updated_weakerfocusleadershipunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerfocusleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker focus leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerfocusleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerfocusleadershipunits
		[/store_unit]
		{FOREACH weakerfocusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerfocusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker focus forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerfocusleadershipunits[$i].id variables.updated_weakerfocusleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerfocusleadershipunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker focus leadership
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerfocusleadershipunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerfocusleadershipunits
		[/store_unit]
		{FOREACH weakerfocusleadershipunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerfocusleadershipunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker focus forced
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerfocusleadershipunits[$i].id variables.updated_weakerfocusleadershipunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerfocusleadershipunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=holy leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_holyleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=holyleadershipmeleeunits
		[/store_unit]
		{FOREACH holyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$holyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_HOLY_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$holyleadershipmeleeunits[$i].id variables.updated_holyleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE holyleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=holy leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_holyleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=holyleadershipmeleeunits
		[/store_unit]
		{FOREACH holyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$holyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=holy forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$holyleadershipmeleeunits[$i].id variables.updated_holyleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE holyleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=holy leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_holyleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=holyleadershipmeleeunits
		[/store_unit]
		{FOREACH holyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$holyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=holy forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$holyleadershipmeleeunits[$i].id variables.updated_holyleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE holyleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker holy leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerholyleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerholyleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerholyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerholyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_HOLY_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerholyleadershipmeleeunits[$i].id variables.updated_weakerholyleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerholyleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker holy leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerholyleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerholyleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerholyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerholyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker holy forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerholyleadershipmeleeunits[$i].id variables.updated_weakerholyleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerholyleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker holy leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerholyleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerholyleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerholyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerholyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker holy forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerholyleadershipmeleeunits[$i].id variables.updated_weakerholyleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerholyleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger holy leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerholyleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerholyleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerholyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerholyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_HOLY_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerholyleadershipmeleeunits[$i].id variables.updated_strongerholyleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerholyleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger holy leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerholyleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerholyleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerholyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerholyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger holy forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerholyleadershipmeleeunits[$i].id variables.updated_strongerholyleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerholyleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger holy leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerholyleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerholyleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerholyleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerholyleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger holy forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerholyleadershipmeleeunits[$i].id variables.updated_strongerholyleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerholyleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger holy leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerholyleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerholyleadershiprangedunits
		[/store_unit]
		{FOREACH strongerholyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerholyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_HOLY_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerholyleadershiprangedunits[$i].id variables.updated_strongerholyleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerholyleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger holy leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerholyleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerholyleadershiprangedunits
		[/store_unit]
		{FOREACH strongerholyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerholyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger holy forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerholyleadershiprangedunits[$i].id variables.updated_strongerholyleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerholyleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger holy leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerholyleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerholyleadershiprangedunits
		[/store_unit]
		{FOREACH strongerholyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerholyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger holy forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerholyleadershiprangedunits[$i].id variables.updated_strongerholyleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerholyleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=holy leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_holyleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=holyleadershiprangedunits
		[/store_unit]
		{FOREACH holyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$holyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_HOLY_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$holyleadershiprangedunits[$i].id variables.updated_holyleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE holyleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=holy leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_holyleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=holyleadershiprangedunits
		[/store_unit]
		{FOREACH holyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$holyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=holy forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$holyleadershiprangedunits[$i].id variables.updated_holyleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE holyleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=holy leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_holyleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=holyleadershiprangedunits
		[/store_unit]
		{FOREACH holyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$holyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=holy forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$holyleadershiprangedunits[$i].id variables.updated_holyleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE holyleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker holy leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerholyleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerholyleadershiprangedunits
		[/store_unit]
		{FOREACH weakerholyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerholyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_HOLY_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerholyleadershiprangedunits[$i].id variables.updated_weakerholyleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerholyleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker holy leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerholyleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerholyleadershiprangedunits
		[/store_unit]
		{FOREACH weakerholyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerholyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker holy forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerholyleadershiprangedunits[$i].id variables.updated_weakerholyleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerholyleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker holy leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerholyleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerholyleadershiprangedunits
		[/store_unit]
		{FOREACH weakerholyleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerholyleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker holy forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerholyleadershiprangedunits[$i].id variables.updated_weakerholyleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerholyleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=horror leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_horrorleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=horrorleadershipmeleeunits
		[/store_unit]
		{FOREACH horrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$horrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_HORROR_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$horrorleadershipmeleeunits[$i].id variables.updated_horrorleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE horrorleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=horror leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_horrorleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=horrorleadershipmeleeunits
		[/store_unit]
		{FOREACH horrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$horrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=horror forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$horrorleadershipmeleeunits[$i].id variables.updated_horrorleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE horrorleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=horror leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_horrorleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=horrorleadershipmeleeunits
		[/store_unit]
		{FOREACH horrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$horrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=horror forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$horrorleadershipmeleeunits[$i].id variables.updated_horrorleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE horrorleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker horror leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerhorrorleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerhorrorleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerhorrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerhorrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_HORROR_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerhorrorleadershipmeleeunits[$i].id variables.updated_weakerhorrorleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerhorrorleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker horror leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerhorrorleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerhorrorleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerhorrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerhorrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker horror forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerhorrorleadershipmeleeunits[$i].id variables.updated_weakerhorrorleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerhorrorleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker horror leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerhorrorleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerhorrorleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerhorrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerhorrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker horror forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerhorrorleadershipmeleeunits[$i].id variables.updated_weakerhorrorleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerhorrorleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger horror leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerhorrorleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerhorrorleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerhorrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerhorrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_HORROR_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerhorrorleadershipmeleeunits[$i].id variables.updated_strongerhorrorleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerhorrorleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger horror leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerhorrorleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerhorrorleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerhorrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerhorrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger horror forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerhorrorleadershipmeleeunits[$i].id variables.updated_strongerhorrorleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerhorrorleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger horror leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerhorrorleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerhorrorleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerhorrorleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerhorrorleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger horror forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerhorrorleadershipmeleeunits[$i].id variables.updated_strongerhorrorleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerhorrorleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger horror leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerhorrorleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerhorrorleadershiprangedunits
		[/store_unit]
		{FOREACH strongerhorrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerhorrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_HORROR_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerhorrorleadershiprangedunits[$i].id variables.updated_strongerhorrorleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerhorrorleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger horror leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerhorrorleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerhorrorleadershiprangedunits
		[/store_unit]
		{FOREACH strongerhorrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerhorrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger horror forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerhorrorleadershiprangedunits[$i].id variables.updated_strongerhorrorleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerhorrorleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger horror leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerhorrorleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerhorrorleadershiprangedunits
		[/store_unit]
		{FOREACH strongerhorrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerhorrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger horror forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerhorrorleadershiprangedunits[$i].id variables.updated_strongerhorrorleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerhorrorleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=horror leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_horrorleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=horrorleadershiprangedunits
		[/store_unit]
		{FOREACH horrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$horrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_HORROR_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$horrorleadershiprangedunits[$i].id variables.updated_horrorleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE horrorleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=horror leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_horrorleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=horrorleadershiprangedunits
		[/store_unit]
		{FOREACH horrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$horrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=horror forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$horrorleadershiprangedunits[$i].id variables.updated_horrorleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE horrorleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=horror leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_horrorleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=horrorleadershiprangedunits
		[/store_unit]
		{FOREACH horrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$horrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=horror forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$horrorleadershiprangedunits[$i].id variables.updated_horrorleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE horrorleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker horror leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerhorrorleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerhorrorleadershiprangedunits
		[/store_unit]
		{FOREACH weakerhorrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerhorrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_HORROR_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerhorrorleadershiprangedunits[$i].id variables.updated_weakerhorrorleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerhorrorleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker horror leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerhorrorleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerhorrorleadershiprangedunits
		[/store_unit]
		{FOREACH weakerhorrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerhorrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker horror forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerhorrorleadershiprangedunits[$i].id variables.updated_weakerhorrorleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerhorrorleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker horror leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerhorrorleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerhorrorleadershiprangedunits
		[/store_unit]
		{FOREACH weakerhorrorleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerhorrorleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker horror forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerhorrorleadershiprangedunits[$i].id variables.updated_weakerhorrorleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerhorrorleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=vicious leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_viciousleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=viciousleadershipmeleeunits
		[/store_unit]
		{FOREACH viciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$viciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_VICIOUS_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$viciousleadershipmeleeunits[$i].id variables.updated_viciousleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE viciousleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=vicious leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_viciousleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=viciousleadershipmeleeunits
		[/store_unit]
		{FOREACH viciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$viciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=vicious forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$viciousleadershipmeleeunits[$i].id variables.updated_viciousleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE viciousleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=vicious leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_viciousleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=viciousleadershipmeleeunits
		[/store_unit]
		{FOREACH viciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$viciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=vicious forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$viciousleadershipmeleeunits[$i].id variables.updated_viciousleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE viciousleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker vicious leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerviciousleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerviciousleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerviciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerviciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_VICIOUS_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerviciousleadershipmeleeunits[$i].id variables.updated_weakerviciousleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerviciousleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker vicious leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerviciousleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerviciousleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerviciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerviciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker vicious forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerviciousleadershipmeleeunits[$i].id variables.updated_weakerviciousleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerviciousleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker vicious leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerviciousleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerviciousleadershipmeleeunits
		[/store_unit]
		{FOREACH weakerviciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerviciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=weaker vicious forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerviciousleadershipmeleeunits[$i].id variables.updated_weakerviciousleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerviciousleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger vicious leadership melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerviciousleadershipmeleeunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerviciousleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerviciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerviciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_VICIOUS_MELEE}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerviciousleadershipmeleeunits[$i].id variables.updated_strongerviciousleadershipmeleeunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerviciousleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger vicious leadership melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerviciousleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerviciousleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerviciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerviciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger vicious forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerviciousleadershipmeleeunits[$i].id variables.updated_strongerviciousleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerviciousleadershipmeleeunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger vicious leadership melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerviciousleadershipmeleeunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerviciousleadershipmeleeunits
		[/store_unit]
		{FOREACH strongerviciousleadershipmeleeunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerviciousleadershipmeleeunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=stronger vicious forced melee
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerviciousleadershipmeleeunits[$i].id variables.updated_strongerviciousleadershipmeleeunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerviciousleadershipmeleeunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger vicious leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_strongerviciousleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=strongerviciousleadershiprangedunits
		[/store_unit]
		{FOREACH strongerviciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerviciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_STRONGER_VICIOUS_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerviciousleadershiprangedunits[$i].id variables.updated_strongerviciousleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE strongerviciousleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=stronger vicious leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_strongerviciousleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerviciousleadershiprangedunits
		[/store_unit]
		{FOREACH strongerviciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerviciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger vicious forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerviciousleadershiprangedunits[$i].id variables.updated_strongerviciousleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerviciousleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=stronger vicious leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_strongerviciousleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=strongerviciousleadershiprangedunits
		[/store_unit]
		{FOREACH strongerviciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$strongerviciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=stronger vicious forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$strongerviciousleadershiprangedunits[$i].id variables.updated_strongerviciousleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE strongerviciousleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=vicious leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_viciousleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=viciousleadershiprangedunits
		[/store_unit]
		{FOREACH viciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$viciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_VICIOUS_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$viciousleadershiprangedunits[$i].id variables.updated_viciousleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE viciousleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=vicious leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_viciousleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=viciousleadershiprangedunits
		[/store_unit]
		{FOREACH viciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$viciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=vicious forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$viciousleadershiprangedunits[$i].id variables.updated_viciousleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE viciousleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=vicious leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_viciousleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=viciousleadershiprangedunits
		[/store_unit]
		{FOREACH viciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$viciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=vicious forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$viciousleadershiprangedunits[$i].id variables.updated_viciousleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE viciousleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker vicious leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_weakerviciousleadershiprangedunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=weakerviciousleadershiprangedunits
		[/store_unit]
		{FOREACH weakerviciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerviciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				[set_specials]
					mode=append
					{WEAPON_SPECIAL_LATENT_WEAKER_VICIOUS_RANGED}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerviciousleadershiprangedunits[$i].id variables.updated_weakerviciousleadershiprangedunits yes}
		{NEXT i}
		{CLEAR_VARIABLE weakerviciousleadershiprangedunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=weaker vicious leadership ranged
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_weakerviciousleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerviciousleadershiprangedunits
		[/store_unit]
		{FOREACH weakerviciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerviciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker vicious forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerviciousleadershiprangedunits[$i].id variables.updated_weakerviciousleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerviciousleadershiprangedunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=weaker vicious leadership ranged
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_weakerviciousleadershiprangedunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=weakerviciousleadershiprangedunits
		[/store_unit]
		{FOREACH weakerviciousleadershiprangedunits i}
		[object]
			silent=yes
			[filter]
				id=$weakerviciousleadershiprangedunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=ranged
				remove_specials=weaker vicious forced ranged
			[/effect]
		[/object]
		{MODIFY_UNIT id=$weakerviciousleadershiprangedunits[$i].id variables.updated_weakerviciousleadershiprangedunits no}
		{NEXT i}
		{CLEAR_VARIABLE weakerviciousleadershiprangedunits}
	[/event]
	[event]
		name=side turn
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=skimirsher_leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_skirmishermwcunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=skirmishermwcunits
		[/store_unit]
		{FOREACH skirmishermwcunits i}
		[object]
			silent=yes
			[filter]
				id=$skirmishermwcunits[$i].id
			[/filter]
			[effect]
				apply_to=remove_ability
				[abilities]
					[skirmisher]
						id=skirmisher_forced
					[/skirmisher]
				[/abilities]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$skirmishermwcunits[$i].id variables.updated_skirmishermwcunits no}
		{NEXT i}
		{CLEAR_VARIABLE skirmishermwcunits}
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=skimirsher_leadership
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_skirmishermwcunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=skirmishermwcunits
		[/store_unit]
		{FOREACH skirmishermwcunits i}
		[object]
            silent=yes
			delayed_variable_substitution=yes
			[filter]
				id=$skirmishermwcunits[$i].id
			[/filter]
			[effect]
				apply_to=new_ability
				[abilities]
					{ABILITY_LATENT_SKIRMISHER}
				[/abilities]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$skirmishermwcunits[$i].id variables.updated_skirmishermwcunits yes}
		{NEXT i}
		{CLEAR_VARIABLE skirmishermwcunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=skimirsher_leadership
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_skirmishermwcunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=skirmishermwcunits
		[/store_unit]
		{FOREACH skirmishermwcunits i}
		[object]
			silent=yes
			[filter]
				id=$skirmishermwcunits[$i].id
			[/filter]
			[effect]
				apply_to=remove_ability
				[abilities]
					[skirmisher]
						id=skirmisher_forced
					[/skirmisher]
				[/abilities]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$skirmishermwcunits[$i].id variables.updated_skirmishermwcunits no}
		{NEXT i}
		{CLEAR_VARIABLE skirmishermwcunits}
	[/event]
	[event]
		name=side turn end
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=healing_leadership_6
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_healing6mwcunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=healing6mwcunits
		[/store_unit]
		{FOREACH healing6mwcunits i}
		[object]
			silent=yes
			[filter]
				id=$healing6mwcunits[$i].id
			[/filter]
			[effect]
				apply_to=remove_ability
				[abilities]
					[heals]
						id=healing_forced_6
					[/heals]
					[heals]
						id=curing_forced_6
					[/heals]
				[/abilities]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$healing6mwcunits[$i].id variables.updated_healing6mwcunits no}
		{NEXT i}
		{CLEAR_VARIABLE healing6mwcunits}
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=healing_leadership_6
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_healing6mwcunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=healing6mwcunits
		[/store_unit]
		{FOREACH healing6mwcunits i}
		[object]
            silent=yes
			delayed_variable_substitution=yes
			[filter]
				id=$healing6mwcunits[$i].id
			[/filter]
			[effect]
				apply_to=new_ability
				[abilities]
					{ABILITY_LATENT_CURES_VALUE 6}
				[/abilities]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$healing6mwcunits[$i].id variables.updated_healing6mwcunits yes}
		{NEXT i}
		{CLEAR_VARIABLE healing6mwcunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=chaotics plague 01 aura melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_chaoticsplague01auraunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=chaoticsplague01auraunits
		[/store_unit]
		{FOREACH chaoticsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$chaoticsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{LATENT_WEAPON_SPECIAL_01_CHAOTICS}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$chaoticsplague01auraunits[$i].id variables.updated_chaoticsplague01auraunits yes}
		{NEXT i}
		{CLEAR_VARIABLE chaoticsplague01auraunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=chaotics plague 01 aura melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_chaoticsplague01auraunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=chaoticsplague01auraunits
		[/store_unit]
		{FOREACH chaoticsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$chaoticsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=latent_plague_chaotics_01
			[/effect]
		[/object]
		{MODIFY_UNIT id=$chaoticsplague01auraunits[$i].id variables.updated_chaoticsplague01auraunits no}
		{NEXT i}
		{CLEAR_VARIABLE chaoticsplague01auraunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=chaotics plague 01 aura melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_chaoticsplague01auraunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=chaoticsplague01auraunits
		[/store_unit]
		{FOREACH chaoticsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$chaoticsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=latent_plague_chaotics_01
			[/effect]
		[/object]
		{MODIFY_UNIT id=$chaoticsplague01auraunits[$i].id variables.updated_chaoticsplague01auraunits no}
		{NEXT i}
		{CLEAR_VARIABLE chaoticsplague01auraunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=lawfuls plague 01 aura melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_lawfulsplague01auraunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=lawfulsplague01auraunits
		[/store_unit]
		{FOREACH lawfulsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$lawfulsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{LATENT_WEAPON_SPECIAL_01_LAWFULS}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$lawfulsplague01auraunits[$i].id variables.updated_lawfulsplague01auraunits yes}
		{NEXT i}
		{CLEAR_VARIABLE lawfulsplague01auraunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=lawfuls plague 01 aura melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_lawfulsplague01auraunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=lawfulsplague01auraunits
		[/store_unit]
		{FOREACH lawfulsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$lawfulsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=latent_plague_lawfuls_01
			[/effect]
		[/object]
		{MODIFY_UNIT id=$lawfulsplague01auraunits[$i].id variables.updated_lawfulsplague01auraunits no}
		{NEXT i}
		{CLEAR_VARIABLE lawfulsplague01auraunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=lawfuls plague 01 aura melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_lawfulsplague01auraunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=lawfulsplague01auraunits
		[/store_unit]
		{FOREACH lawfulsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$lawfulsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=latent_plague_lawfuls_01
			[/effect]
		[/object]
		{MODIFY_UNIT id=$lawfulsplague01auraunits[$i].id variables.updated_lawfulsplague01auraunits no}
		{NEXT i}
		{CLEAR_VARIABLE lawfulsplague01auraunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=neutrals plague 01 aura melee
					is_enemy=no
				[/filter_adjacent]
				[not]
					[filter_wml]
						[variables]
							updated_neutralsplague01auraunits=yes
						[/variables]
					[/filter_wml]
				[/not]
				side=$side_number
			[/filter]
			kill=no
			variable=neutralsplague01auraunits
		[/store_unit]
		{FOREACH neutralsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$neutralsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				[set_specials]
					mode=append
					{LATENT_WEAPON_SPECIAL_01_NEUTRALS}
				[/set_specials]
			[/effect]
		[/object]
		{MODIFY_UNIT id=$neutralsplague01auraunits[$i].id variables.updated_neutralsplague01auraunits yes}
		{NEXT i}
		{CLEAR_VARIABLE neutralsplague01auraunits}
	[/event]
	[event]
		name=attack
		first_time_only=no
		[store_unit]
			[filter]
				[not]
					[filter_adjacent]
						ability=neutrals plague 01 aura melee
						is_enemy=no
					[/filter_adjacent]
				[/not]
				[filter_wml]
					[variables]
						updated_neutralsplague01auraunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=neutralsplague01auraunits
		[/store_unit]
		{FOREACH neutralsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$neutralsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=latent_plague_neutrals_01
			[/effect]
		[/object]
		{MODIFY_UNIT id=$neutralsplague01auraunits[$i].id variables.updated_neutralsplague01auraunits no}
		{NEXT i}
		{CLEAR_VARIABLE neutralsplague01auraunits}
	[/event]
	[event]
		name=side turn end 
		first_time_only=no
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=neutrals plague 01 aura melee
					is_enemy=no
				[/filter_adjacent]
				[filter_wml]
					[variables]
						updated_neutralsplague01auraunits=yes
					[/variables]
				[/filter_wml]
			[/filter]
			kill=no
			variable=neutralsplague01auraunits
		[/store_unit]
		{FOREACH neutralsplague01auraunits i}
		[object]
			silent=yes
			[filter]
				id=$neutralsplague01auraunits[$i].id
			[/filter]
			[effect]
				apply_to=attack
				range=melee
				remove_specials=latent_plague_neutrals_01
			[/effect]
		[/object]
		{MODIFY_UNIT id=$neutralsplague01auraunits[$i].id variables.updated_neutralsplague01auraunits no}
		{NEXT i}
		{CLEAR_VARIABLE neutralsplague01auraunits}
	[/event]
	
[event]
  id=regenerates_20%
  first_time_only=no
  name=side turn
  [store_unit]
    [filter]
      ability=regenerates 20%
      side=$side_number
    [/filter]
    variable=unit_healed
    kill=no
  [/store_unit]
  {FOREACH unit_healed i}
    [if]
      [variable]
        name=unit_healed[$i].status.poisoned
        equals=yes
      [/variable]
      [then]
        [heal_unit]
          [filter]
            id=$unit_healed[$i].id
          [/filter]
          animate=yes
          amount=0
          restore_statuses=yes
        [/heal_unit]
      [/then]
      [else]
        [heal_unit]
          [filter]
            id=$unit_healed[$i].id
          [/filter]
          animate=yes
          amount=$($unit_healed[$i].max_hitpoints/(100/20))
         [/heal_unit]
      [/else]
    [/if]
  {NEXT i}
  {CLEAR_VARIABLE unit_healed}
[/event]
[event]
	name=side turn
	first_time_only=no
	[store_unit]
		[filter]
			ability=freezing aura
			side=$side_number
		[/filter]
		kill=no
		variable=units_with_freezing_aura
	[/store_unit]
	{FOREACH units_with_freezing_aura i}
		[harm_unit]
			[filter]
				[filter_adjacent]
					id=$units_with_freezing_aura[$i].id
					is_enemy=yes
				[/filter_adjacent]
			[/filter]
			amount=4
			damage_type=cold
			slowed=yes
			fire_event=yes
			experience=no
			kill=no
			animate=no
		[/harm_unit]
	{NEXT i}
	{CLEAR_VARIABLE units_with_freezing_aura}
[/event]
[event]
    name=die
    first_time_only=no
	id=fury_event_mwc
    [filter_second]
        side=$side_number
        ability=fury_mwc
    [/filter_second]

    [store_unit]
        variable=furious
        [filter]
            x,y=$x2,$y2
        [/filter]
    [/store_unit]
    {VARIABLE_OP furious.attacks_left add 1}
    {VARIABLE_OP furious.moves add 2}
    [unstore_unit]
        variable=furious
        {COLOR_HARM}
        text= _ "FURY!"
        find_vacant=no
    [/unstore_unit]
[/event]

	[event]
		name=attacker hits
		first_time_only=no
		id=mwc_piercing_unit_attack
		[filter_attack]
			special=pierce_unit_attack
		[/filter_attack]
		[if]
			[have_unit]
				x,y=$x1,$y1
				[filter_adjacent]
					x,y=$x2,$y2
					adjacent=n
				[/filter_adjacent]
			[/have_unit]
			[then]
				{VARIABLE pierce_direction n}
			[/then]
			[else]
				[if]
					[have_unit]
						x,y=$x1,$y1
						[filter_adjacent]
							x,y=$x2,$y2
							adjacent=ne
						[/filter_adjacent]
					[/have_unit]
					[then]
						{VARIABLE pierce_direction ne}
					[/then]
					[else]
						[if]
							[have_unit]
								x,y=$x1,$y1
								[filter_adjacent]
									x,y=$x2,$y2
									adjacent=se
								[/filter_adjacent]
							[/have_unit]
							[then]
								{VARIABLE pierce_direction se}
							[/then]
							[else]
								[if]
									[have_unit]
										x,y=$x1,$y1
										[filter_adjacent]
											x,y=$x2,$y2
											adjacent=s
										[/filter_adjacent]
									[/have_unit]
									[then]
										{VARIABLE pierce_direction s}
									[/then]
									[else]
										[if]
											[have_unit]
												x,y=$x1,$y1
												[filter_adjacent]
													x,y=$x2,$y2
													adjacent=sw
												[/filter_adjacent]
											[/have_unit]
											[then]
												{VARIABLE pierce_direction sw}
											[/then]
											[else]
												[if]
													[have_unit]
														x,y=$x1,$y1
														[filter_adjacent]
														   x,y=$x2,$y2
														   adjacent=nw
														[/filter_adjacent]
													[/have_unit]
													[then]
														{VARIABLE pierce_direction nw}
													[/then]
												[/if]
											[/else]
										[/if]
									[/else]
								[/if]
							[/else]
						[/if]
					[/else]
				[/if]
			[/else]
		[/if]
		[store_locations]
			[filter_adjacent_location]
				x,y=$x2,$y2
				adjacent=-$pierce_direction
			[/filter_adjacent_location]
			variable=pierce_target_hex
		[/store_locations]
		[harm_unit]
			[filter]
				x,y=$pierce_target_hex.x,$pierce_target_hex.y
				[filter_side]
					[enemy_of]
						side=$unit.side
					[/enemy_of]
				[/filter_side]
			[/filter]
			amount="$($weapon.damage/2)"
			damage_type=pierce
			fire_event=yes
			experience=yes
			animate=no
		[/harm_unit]
		{CLEAR_VARIABLE pierce_direction,pierce_target_hex}
	[/event]
	
	
[event]
    name=die

    first_time_only=no

    [filter]
        [not]
            [filter_wml]
                [status]
                    not_living="yes"
                [/status]
            [/filter_wml]
        [/not]
    [/filter]
    [filter_second]
        ability=bloodlust_3
    [/filter_second]
    [unstore_unit]
        variable=second_unit
        {COLOR_HEAL}
        text= _ "3"
        find_vacant=no
    [/unstore_unit]
    [object]
        silent=yes
        duration=forever
        [filter]
            x,y=$x2,$y2
        [/filter]
        [effect]
            apply_to=hitpoints
            increase=3
        [/effect]
    [/object]
[/event]
[event]
    name=die

    first_time_only=no

    [filter]
        [not]
            [filter_wml]
                [status]
                    not_living="yes"
                [/status]
            [/filter_wml]
        [/not]
    [/filter]
    [filter_second]
        ability=bloodlust_6
    [/filter_second]
    [unstore_unit]
        variable=second_unit
        {COLOR_HEAL}
        text= _ "6"
        find_vacant=no
    [/unstore_unit]
    [object]
        silent=yes
        duration=forever
        [filter]
            x,y=$x2,$y2
        [/filter]
        [effect]
            apply_to=hitpoints
            increase=6
        [/effect]
    [/object]
[/event]
[event]
    name=die

    first_time_only=no

    [filter]
        [not]
            [filter_wml]
                [status]
                    not_living="yes"
                [/status]
            [/filter_wml]
        [/not]
    [/filter]
    [filter_second]
        ability=bloodlust_9
    [/filter_second]
    [unstore_unit]
        variable=second_unit
        {COLOR_HEAL}
        text= _ "9"
        find_vacant=no
    [/unstore_unit]
    [object]
        silent=yes
        duration=forever
        [filter]
            x,y=$x2,$y2
        [/filter]
        [effect]
            apply_to=hitpoints
            increase=9
        [/effect]
    [/object]
[/event]
[event]
    name=die

    first_time_only=no

    [filter]
        [not]
            [filter_wml]
                [status]
                    not_living="yes"
                [/status]
            [/filter_wml]
        [/not]
    [/filter]
    [filter_second]
        ability=bloodlust_12
    [/filter_second]
    [unstore_unit]
        variable=second_unit
        {COLOR_HEAL}
        text= _ "12"
        find_vacant=no
    [/unstore_unit]
    [object]
        silent=yes
        duration=forever
        [filter]
            x,y=$x2,$y2
        [/filter]
        [effect]
            apply_to=hitpoints
            increase=12
        [/effect]
    [/object]
[/event]
[event]
    name=attacker hits
    first_time_only=no
    [filter_second]
        ability=thorns
    [/filter_second]
	[if]
		[variable]
			name=unit.hitpoints
			less_than="$(3*$($second_unit.resistance.pierce/100))"
		[/variable]
		[then]
			[harm_unit]
			[filter]
			    x,y=$x1,$y1
			[/filter]
			[filter_second]
			    x,y=$x2,$y2
			[/filter_second]
			amount=3
			damage_type=pierce
			fire_event=yes
			experience=yes
			animate=no
			kill=no
			[/harm_unit]
			[store_unit]
				[filter]
					id=unit.id
				[/filter]
				variable=respecer
			[/store_unit]
			{VARIABLE respecer.variables.may_need_respec yes}
			[unstore_unit]
				variable=respecer
				find_vacant=no
			[/unstore_unit]
		[/then]
		[else]
		     [harm_unit]
			[filter]
			    x,y=$x1,$y1
			[/filter]
			amount=3
			damage_type=pierce
			fire_event=yes
			experience=no
			animate=no
			kill=no
		  [/harm_unit]
		[/else]
	[/if]	
[/event]
[event]
    name=defender hits
    first_time_only=no
    [filter]
        ability=thorns
    [/filter]
	[if]
		[variable]
			name=second_unit.hitpoints
			less_than="$(3*$($second_unit.resistance.pierce/100))"
		[/variable]
		[then]
		     [harm_unit]
			[filter]
			    x,y=$x2,$y2
			[/filter]
			amount=3
			damage_type=pierce
			fire_event=yes
			experience=yes
			animate=no
			kill=no
			[/harm_unit]
			[fire_event]
				name=force respec
				[primary_unit]
					id=$unit.id
				[/primary_unit]
			[/fire_event]
		[/then]
		[else]
		 [harm_unit]
			[filter]
			    x,y=$x2,$y2
			[/filter]
			amount=3
			damage_type=pierce
			fire_event=yes
			experience=no
			animate=no
			kill=no
		  [/harm_unit]
		[/else]
	[/if]	
[/event]
[event]
    name=die
    first_time_only=no
	id=murderedbymurderlust
    [filter_second]
        ability=murderlust
    [/filter_second]
    [heal_unit]
		[filter]
			id=$second_unit.id
		[/filter]
		amount=8
		animate=yes
		restore_statuses=no
    [/heal_unit]
[/event]
[event]
    name=attacker hits
    first_time_only=no
    [filter]
        type=Mwc_Demon Heterodox
    [/filter]
    [filter_attack]
        name=axe
    [/filter_attack]
	{EVENT_DEADLYSTRIKE}
[/event]
[event]
    name=attacker hits
    first_time_only=no
    [filter]
        type=Mwc_Demon Heretic
    [/filter]
    [filter_attack]
        name=cursed_battleaxe
    [/filter_attack]
	{EVENT_DEADLYSTRIKE}
[/event]
[event]
    name=attacker hits
    first_time_only=no
    [filter]
        type=Mwc_Demon Apostate
    [/filter]
    [filter_attack]
        name=cursed_battleaxe
    [/filter_attack]
	{EVENT_DEADLYSTRIKE}
[/event]

[event]
    id=magical_powers_event
    name=side turn
    first_time_only=no
	[store_unit]
		[filter]
			ability=magical_powers
			side=$side_number
		[/filter]
		kill=no
		variable=magical_powers_owner
	[/store_unit]
	{FOREACH magical_powers_owner j}
		[store_unit]
			[filter]
				[filter_adjacent]
					id=$magical_powers_owner[$j].id
					is_enemy=no
				[/filter_adjacent]	
			[/filter]
			kill=no
			variable=magical_powers_units
		[/store_unit]
		{FOREACH magical_powers_units i}
		[set_variable]
			name=some_random
			rand=1..10
		[/set_variable]
		[if]
			[variable]
				name=some_random
				less_than=4
			[/variable]
			[then]
				[set_variable]
					name=some_random_2
					rand=1..100
				[/set_variable]
				[switch]
					variable=some_random_2
					[case]
						value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40
						[set_variable]
							name=some_random_3
							rand=1..30
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=2
										increase_total=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=16,17,18,19,20,21,22,23,24
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=4
										increase_total=4
									[/effect]
								[/object]
							[/case]
							[case]
								value=25,26,27
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=6
										increase_total=6
									[/effect]
								[/object]
							[/case]
							[case]
								value=28,29
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=8
										increase_total=8
									[/effect]
								[/object]
							[/case]
							[case]
								value=30
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=10
										increase_total=10
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64
						[set_variable]
							name=some_random_3
							rand=1..40
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.cold
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.fire
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.arcane
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.pierce
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.blade
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.impact
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=16,17,18,19,20,21,22,23
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.cold
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.fire
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.arcane
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.pierce
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.blade
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.impact
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=24,25,26
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.cold
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.fire
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.arcane
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.pierce
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.blade
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.impact
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=27,28
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.cold
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.fire
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.arcane
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.pierce
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.blade
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.impact
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=29
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.cold
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.fire
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.arcane
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.pierce
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.blade
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=magical_powers_units[$i].resistance.impact
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=30,31,32
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.cold
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.fire
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.arcane
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=33,34,35
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.pierce
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.blade
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.impact
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=36,37
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.cold
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.fire
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.arcane
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=38,39
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.pierce
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.blade
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.impact
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=40
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.cold
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.fire
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.arcane
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.pierce
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.blade
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=magical_powers_units[$i].resistance.impact
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
						[/switch]
					[/case]
					[case]
						value=65,66,67,68,69,70,71,72,73,74,75,76
						[set_variable]
							name=some_random_3
							rand=1..10
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=7,8,9
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=10
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=3
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=77,78,79,80
						[set_variable]
							name=some_random_3
							rand=1..2
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_attacks=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=2
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_attacks=1
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=81,82,83,84,85,86,87,88,89,90,91,92
						[set_variable]
							name=some_random_3
							rand=1..10
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_damage=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=5,6,7,8
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_damage=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=9
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_damage=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=10
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_damage=2
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=93,94,95,96,97,98,99,100
						[set_variable]
							name=some_random_3
							rand=1..4
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack1a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack1b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack1c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack1d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack1e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack1f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack2a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack2b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack2c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack2d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack2e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack2f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=2
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack3a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack3b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack3c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack3d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack3e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack3f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack4a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack4b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack4c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack4d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack4e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack4f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=3
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack5a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack5b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack5c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack5d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack5e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack5f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack6a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack6b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack6c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack6d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack6e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack6f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=4
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack7a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack7b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack7c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack7d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack7e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack7f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack8a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack8b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack8c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack8d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack8e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$magical_powers_units[$i].x,$magical_powers_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack8f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
						[/switch]
					[/case]
				[/switch]
			[/then]
		[/if]
		[clear_variable]
			name=some_random,some_random_2,some_random_3,some_random_4,some_random_5
		[/clear_variable]
		{CLEAR_VARIABLE magical_powers_units[$i].underlying_id,magical_powers_units[$i].id}    
		{NEXT i}
		{CLEAR_VARIABLE magical_powers_units}
		[unstore_unit]
			variable=magical_powers_owner[$j]
			find_vacant=no
		[/unstore_unit]
	{NEXT j}
	{CLEAR_VARIABLE magical_powers_owner}
[/event]

[event]
    id=powers_of_nature_event
    name=side turn
    first_time_only=no
	[store_unit]
		[filter]
			ability=powers_of_nature
			side=$side_number
		[/filter]
		kill=no
		variable=powers_of_nature_owner
	[/store_unit]
	{FOREACH powers_of_nature_owner j}
		[store_unit]
			[filter]
				[filter_adjacent]
					id=$powers_of_nature_owner[$j].id
					is_enemy=no
				[/filter_adjacent]	
			[/filter]
			kill=no
			variable=powers_of_nature_units
		[/store_unit]
		{FOREACH powers_of_nature_units i}
		[set_variable]
			name=some_random
			rand=1..10
		[/set_variable]
		[if]
			[variable]
				name=some_random
				less_than=2
			[/variable]
			[then]
				[set_variable]
					name=some_random_2
					rand=1..100
				[/set_variable]
				[switch]
					variable=some_random_2
					[case]
						value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40
						[set_variable]
							name=some_random_3
							rand=1..30
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=2
										increase_total=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=16,17,18,19,20,21,22,23,24
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=4
										increase_total=4
									[/effect]
								[/object]
							[/case]
							[case]
								value=25,26,27
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=6
										increase_total=6
									[/effect]
								[/object]
							[/case]
							[case]
								value=28,29
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=8
										increase_total=8
									[/effect]
								[/object]
							[/case]
							[case]
								value=30
								[object]
									silent=yes
									duration=forever
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=hitpoints
										increase=10
										increase_total=10
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64
						[set_variable]
							name=some_random_3
							rand=1..40
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=32
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-2
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=2
														increase_total=2
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=16,17,18,19,20,21,22,23
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=34
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-4
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=4
														increase_total=4
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=24,25,26
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=36
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-6
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=6
														increase_total=6
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=27,28
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=38
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-8
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=8
														increase_total=8
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=29
								[set_variable]
									name=some_random_4
									rand=1..6
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.cold
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															cold=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															cold=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=2
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.fire
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															fire=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															fire=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=3
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.arcane
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															arcane=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															arcane=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=4
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.pierce
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															pierce=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															pierce=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=5
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.blade
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															blade=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															blade=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
									[case]
										value=6
										[if]
											[variable]
												name=powers_of_nature_units[$i].resistance.impact
												greater_than_equal_to=40
											[/variable]
											[then]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=no
														[resistance]
															impact=-10
														[/resistance]
													[/effect]
												[/object]
											[/then]
											[else]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=hitpoints
														increase=10
														increase_total=10
													[/effect]
												[/object]
												[object]
													duration=forever
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=resistance
														replace=true
														[resistance]
															impact=30
														[/resistance]
													[/effect]
												[/object]
											[/else]
										[/if]
									[/case]
								[/switch]
							[/case]
							[case]
								value=30,31,32
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.cold
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.fire
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.arcane
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=33,34,35
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.pierce
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.blade
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.impact
										greater_than_equal_to=32
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-2
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=2
												increase_total=2
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=36,37
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.cold
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.fire
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.arcane
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=38,39
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.pierce
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.blade
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.impact
										greater_than_equal_to=34
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-4
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=4
												increase_total=4
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
							[case]
								value=40
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.cold
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													cold=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													cold=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.fire
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													fire=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													fire=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.arcane
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													arcane=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													arcane=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.pierce
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													pierce=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													pierce=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.blade
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													blade=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													blade=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
								[if]
									[variable]
										name=powers_of_nature_units[$i].resistance.impact
										greater_than_equal_to=35
									[/variable]
									[then]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=no
												[resistance]
													impact=-5
												[/resistance]
											[/effect]
										[/object]
									[/then]
									[else]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=hitpoints
												increase=5
												increase_total=5
											[/effect]
										[/object]
										[object]
											duration=forever
											silent=yes
											[filter]
												x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
											[/filter]
											[effect]
												apply_to=resistance
												replace=true
												[resistance]
													impact=30
												[/resistance]
											[/effect]
										[/object]
									[/else]
								[/if]
							[/case]
						[/switch]
					[/case]
					[case]
						value=65,66,67,68,69,70,71,72,73,74,75,76
						[set_variable]
							name=some_random_3
							rand=1..10
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4,5,6
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=7,8,9
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=10
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=movement
										increase=3
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=77,78,79,80
						[set_variable]
							name=some_random_3
							rand=1..2
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_attacks=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=2
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_attacks=1
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=81,82,83,84,85,86,87,88,89,90,91,92
						[set_variable]
							name=some_random_3
							rand=1..10
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1,2,3,4
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_damage=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=5,6,7,8
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_damage=1
									[/effect]
								[/object]
							[/case]
							[case]
								value=9
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=melee
										increase_damage=2
									[/effect]
								[/object]
							[/case]
							[case]
								value=10
								[object]
									duration=forever
									silent=yes
									[filter]
										x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
									[/filter]
									[effect]
										apply_to=attack
										range=ranged
										increase_damage=2
									[/effect]
								[/object]
							[/case]
						[/switch]
					[/case]
					[case]
						value=93,94,95,96,97,98,99,100
						[set_variable]
							name=some_random_3
							rand=1..4
						[/set_variable]
						[switch]
							variable=some_random_3
							[case]
								value=1
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack1a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack1b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack1c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack1d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack1e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack1f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack2a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack2b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack2c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack2d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack2e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack2f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=4
														number=6
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=2
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack3a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack3b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack3c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack3d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack3e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack3f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack4a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack4b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack4c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack4d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack4e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack4f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=6
														number=4
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=3
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack5a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack5b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack5c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack5d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack5e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack5f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack6a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack6b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack6c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack6d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack6e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack6f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=8
														number=3
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
							[case]
								value=4
								[set_variable]
									name=some_random_4
									rand=1..2
								[/set_variable]
								[switch]
									variable=some_random_4
									[case]
										value=1
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ice touch"
														id=mwcnewattack7a
														icon=attacks/touch-undead.png
														type=cold
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "burning torch"
														id=mwcnewattack7b
														icon=attacks/torch.png
														type=fire
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient sacred sword"
														id=mwcnewattack7c
														icon=attacks/sword-holy.png
														type=arcane
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _  "rusty blade"
														id=mwcnewattack7d
														icon=attacks/greatsword-orcish.png
														type=blade
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "huge hammer"
														id=mwcnewattack7e
														icon=attacks/hammer-troll.png
														type=impact
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "steel spear"
														id=mwcnewattack7f
														icon=attacks/pike.png
														type=pierce
														range=melee
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
									[case]
										value=2
										[set_variable]
											name=some_random_5
											rand=1..6
										[/set_variable]
										[switch]
											variable=some_random_5
											[case]
												value=1
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "cold water"
														id=mwcnewattack8a
														icon=attacks/waterspray.png
														type=cold
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=2
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "fire blast"
														id=mwcnewattack8b
														icon=attacks/fire-blast.png
														type=fire
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=3
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "ancient power"
														id=mwcnewattack8c
														icon=attacks/lightbeam.png
														type=arcane
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=4
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown death dagger"
														id=mwcnewattack8d
														icon=attacks/dagger-thrown-human.png
														type=blade
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=5
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "thrown heavy hammer"
														id=mwcnewattack8e
														icon=attacks/hammer.png
														type=impact
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
											[case]
												value=6
												[object]
													silent=yes
													[filter]
														x,y=$powers_of_nature_units[$i].x,$powers_of_nature_units[$i].y
													[/filter]
													[effect]
														apply_to=new_attack
														name= _ "swift javelin"
														id=mwcnewattack8f
														icon=attacks/javelin-human.png
														type=pierce
														range=ranged
														damage=12
														number=2
													[/effect]
												[/object]
											[/case]
										[/switch]
									[/case]
								[/switch]
							[/case]
						[/switch]
					[/case]
				[/switch]
			[/then]
		[/if]
		[clear_variable]
			name=some_random,some_random_2,some_random_3,some_random_4,some_random_5
		[/clear_variable]
		{CLEAR_VARIABLE powers_of_nature_units[$i].underlying_id,powers_of_nature_units[$i].id}    
		{NEXT i}
		{CLEAR_VARIABLE powers_of_nature_units}
		[unstore_unit]
			variable=powers_of_nature_owner[$j]
			find_vacant=no
		[/unstore_unit]
	{NEXT j}
	{CLEAR_VARIABLE powers_of_nature_owner}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_dig
        [/have_unit]
        [then]
            {DIG_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_dig
    [/filter]
    {DIG_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_dig
    [/filter]
    {DIG_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_farm
        [/have_unit]
        [then]
            {FARM_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_farm
    [/filter]
    {FARM_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_farm
    [/filter]
    {FARM_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_afforestation
        [/have_unit]
        [then]
            {AFFORESTATION_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_afforestation
    [/filter]
    {AFFORESTATION_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_afforestation
    [/filter]
    {AFFORESTATION_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_cutter
        [/have_unit]
        [then]
            {CUTTER_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_cutter
    [/filter]
    {CUTTER_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_cutter
    [/filter]
    {CUTTER_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_crusher
        [/have_unit]
        [then]
            {CRUSHER_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_crusher
    [/filter]
    {CRUSHER_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_crusher
    [/filter]
    {CRUSHER_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_mushrooms
        [/have_unit]
        [then]
            {MUSHROOMS_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_mushrooms
    [/filter]
    {MUSHROOMS_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_mushrooms
    [/filter]
    {MUSHROOMS_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_desert
        [/have_unit]
        [then]
            {DESERT_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_desert
    [/filter]
    {DESERT_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_desert
    [/filter]
    {DESERT_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_water
        [/have_unit]
        [then]
            {WATER_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_water
    [/filter]
    {WATER_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_water
    [/filter]
    {WATER_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_ice
        [/have_unit]
        [then]
            {ICE_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_ice
    [/filter]
    {ICE_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_ice
    [/filter]
    {ICE_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_building
        [/have_unit]
        [then]
            {BUILDING_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_building
    [/filter]
    {BUILDING_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_building
    [/filter]
    {BUILDING_HERO_MENU}
[/event]



[event]
    name=start
    [if]
        [have_unit]
            ability=MWC_hero_create_rocks
        [/have_unit]
        [then]
            {CREATE_ROCKS_HERO_MENU}
        [/then]
    [/if]
[/event]

[event]
    name=recruit
    [filter]
        ability=MWC_hero_create_rocks
    [/filter]
    {CREATE_ROCKS_HERO_MENU}
[/event]

[event]
    name=post advance
    [filter]
        ability=MWC_hero_create_rocks
    [/filter]
    {CREATE_ROCKS_HERO_MENU}
[/event]


[event]
    name=start
	{DIG_MENU}
	{FARM_MENU}
	{AFFORESTATION_MENU}
	{CUTTER_MENU}
	{CRUSHER_MENU}
	{MUSHROOMS_MENU}
	{DESERT_MENU}
	{WATER_MENU}
	{ICE_MENU}
	{BUILDING_MENU}
	{CREATE_ROCKS_MENU}
	
	{DIG_HERO_MENU}
	{FARM_HERO_MENU}
	{AFFORESTATION_HERO_MENU}
	{CUTTER_HERO_MENU}
	{CRUSHER_HERO_MENU}
	{MUSHROOMS_HERO_MENU}
	{DESERT_HERO_MENU}
	{WATER_HERO_MENU}
	{ICE_HERO_MENU}
	{BUILDING_HERO_MENU}
	{CREATE_ROCKS_HERO_MENU}
[/event]


[event]
    id=stealing_enemies_mwc
    name=side turn
    first_time_only=no
	[store_unit]
		[filter]
			ability=bloody_ruler_mwc
			side=$side_number
		[/filter]
		kill=no
		variable=stealing_unit_mwc
	[/store_unit]
	{FOREACH stealing_unit_mwc b}
		[store_unit]
			[filter]
				[filter_adjacent]
					ability=bloody_ruler_mwc
					is_enemy=yes
				[/filter_adjacent]
			[/filter]
			kill=no
			variable=stealed_enemies_mwc
		[/store_unit]
		{FOREACH stealed_enemies_mwc a}
			[set_variable]
				name=checked_level
				value=$stealed_enemies_mwc[$a].level
			[/set_variable]
			[switch]
				variable=checked_level
				[case]
					value=0
					[set_variable]
						name=random_iron_value
						rand=1..1
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies_mwc[$a].x,$stealed_enemies_mwc[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=1
					[set_variable]
						name=random_iron_value
						rand=1..3
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies_mwc[$a].x,$stealed_enemies_mwc[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=2
					[set_variable]
						name=random_iron_value
						rand=1..6
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies_mwc[$a].x,$stealed_enemies_mwc[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=3
					[set_variable]
						name=random_iron_value
						rand=1..12
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies_mwc[$a].x,$stealed_enemies_mwc[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=4
					[set_variable]
						name=random_iron_value
						rand=1..24
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies_mwc[$a].x,$stealed_enemies_mwc[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
				[case]
					value=5
					[set_variable]
						name=random_iron_value
						rand=1..48
					[/set_variable]
					[if]
						[variable]
							name=random_iron_value
							equals=1
						[/variable]
						[then]
							[modify_unit]
								[filter]
									x,y=$stealed_enemies_mwc[$a].x,$stealed_enemies_mwc[$a].y
								[/filter]
								side=$side_number
							[/modify_unit]
						[/then]
					[/if]
				[/case]
			[/switch]
		{NEXT a}
		{CLEAR_VARIABLE stealed_enemies_mwc,checked_level,random_iron_value}
	{NEXT b}
	{CLEAR_VARIABLE stealing_unit_mwc}
[/event]

{CONCENTRATED_EVENTS}



       [event]
          name=attack
		  id=mwcgrowingfurya
          first_time_only=no
          [filter_attack]
             special=growingfury
          [/filter_attack]
          [store_unit]
             [filter]
                x,y=$x1,$y1
             [/filter]
             variable=dmgfuryunits
          [/store_unit] 
		{FOREACH dmgfuryunits.attack a}
          [set_variable]
                name=unitdamage_$a
				value=$dmgfuryunits.attack[$a].damage
            [/set_variable]
		{NEXT a}
       [/event]
        [event]
            name=attacker hits
			id=mwcgrowingfuryb
            first_time_only=no
          [filter_attack]
             special=growingfury
          [/filter_attack]
		{FOREACH dmgfuryunits.attack a}
            [set_variable]
                name=unit.attack[$a].damage
                add=3
            [/set_variable]
		{NEXT a}
            [unstore_unit]
                variable=unit
            [/unstore_unit]
        [/event]
       [event]
            name=attack end
			id=mwcgrowingfuryc
          first_time_only=no
          [filter_attack]
             special=growingfury
          [/filter_attack]
		{FOREACH dmgfuryunits.attack a}
          #[set_variable]
          #      name=unit.attack[$a].damage
          #   value=$dmgfuryunits.attack[$a].damage
          #  [/set_variable]
          [set_variable]
                name=unit.attack[$a].damage
				value=$unitdamage_$a
            [/set_variable]
		{NEXT a}
            [unstore_unit]
                variable=unit
            [/unstore_unit]
        [/event]
       [event]
            name=die
			id=mwcgrowingfuryd
          first_time_only=no
          [filter_attack]
             special=growingfury
          [/filter_attack]
		{FOREACH dmgfuryunits.attack a}
          #[set_variable]
          #      name=unit.attack[$a].damage
          #   value=$dmgfuryunits.attack[$a].damage
          #  [/set_variable]
          [set_variable]
                name=unit.attack[$a].damage
				value=$unitdamage_$a
            [/set_variable]
		{NEXT a}
            [unstore_unit]
                variable=unit
            [/unstore_unit]
        [/event]
       [event]
          name=attack
			id=mwcgrowingfurye
          first_time_only=no
          [filter_second_attack]
             special=growingfury
          [/filter_second_attack]
          [store_unit]
             [filter]
                x,y=$x2,$y2
             [/filter]
             variable=dmgfuryunits2
          [/store_unit]
		{FOREACH dmgfuryunits2.attack a}
          [set_variable]
                name=unitdamage2_$a
				value=$dmgfuryunits2.attack[$a].damage
            [/set_variable]
		{NEXT a}
       [/event]
        [event]
            name=defender hits
			id=mwcgrowingfuryf
            first_time_only=no
          [filter_second_attack]
             special=growingfury
          [/filter_second_attack]
		{FOREACH dmgfuryunits2.attack a}
            [set_variable]
                name=second_unit.attack[$a].damage
                add=3
            [/set_variable]
		{NEXT a}
            [unstore_unit]
                variable=second_unit
            [/unstore_unit]
        [/event]
       [event]
            name=attack end
			id=mwcgrowingfuryg
          first_time_only=no
          [filter_second_attack]
             special=growingfury
          [/filter_second_attack]
		{FOREACH dmgfuryunits2.attack a}
          #[set_variable]
          #      name=second_unit.attack[$a].damage
          #   value=$dmgfuryunits2.attack[$a].damage
          #  [/set_variable]
          [set_variable]
                name=second_unit.attack[$a].damage
				value=$unitdamage2_$a
            [/set_variable]
		{NEXT a}
            [unstore_unit]
                variable=second_unit
            [/unstore_unit]
        [/event]
       [event]
            name=die
			id=mwcgrowingfuryh
          first_time_only=no
          [filter_second_attack]
             special=growingfury
          [/filter_second_attack]
		{FOREACH dmgfuryunits2.attack a}
          #[set_variable]
          #      name=second_unit.attack[$a].damage
          #   value=$dmgfuryunits2.attack[$a].damage
          #  [/set_variable]
          [set_variable]
                name=second_unit.attack[$a].damage
				value=$unitdamage2_$a
            [/set_variable]
		{NEXT a}
            [unstore_unit]
                variable=second_unit
            [/unstore_unit]
        [/event]
	[event]
		name=attacker hits
		first_time_only=no
		id=whirlwind_event
		[filter_attack]
				special=whirlwind
		[/filter_attack]
		{INCORPORATE_EFFECTS}
		{VARIABLE has_leech 0}
		{VARIABLE has_drain 0}
		{VARIABLE has_slow no}
		{VARIABLE has_poison no}
		{FOREACH weapon.specials.damage i}
		[if]
			[variable]
				name=weapon.specials.damage[$i].id
				equals=leeches
			[/variable]
			[then]
				{VARIABLE has_leech 1}
			[/then]
		[/if]
		{NEXT i}
		[if]
			[variable]
				name=weapon.specials.poison.id
				equals=poison
			[/variable]
			[then]
				{VARIABLE has_poison yes}

			[/then]
		[/if]
		[if]
			[variable]
				name=weapon.specials.drain.id
				equals=drain
			[/variable]
			[then]
				{VARIABLE has_drain yes}

			[/then]
		[/if]
		[if]
			[variable]
				name=weapon.specials.slow.id
				equals=slow
			[/variable]
			[then]
				{VARIABLE has_slow yes}

			[/then]
		[/if]
		[if]
			[variable]
				name=has_leech
				equals=0
			[/variable]
			[else]
				[store_unit]		#We need to know how many units were leeched, and what were their resistances
					[filter]
						[filter_adjacent]
							x,y=$x1,$y1
						[/filter_adjacent]
						[not]
							x,y=$x2,$y2
						[/not]
						[filter_side]
							[enemy_of]
								side=$unit.side
							[/enemy_of]
						[/filter_side]
					[/filter]
					variable=units
				[/store_unit]  
				{VARIABLE healed_amount 0}
				{FOREACH units i}
					[switch]
						variable=weapon.type
						[case]
							value=arcane
								{VARIABLE_OP healed_amount add "$($units[$i].resistance.arcane*$damage)"}
						[/case]
						[case]
							value=fire
								{VARIABLE_OP healed_amount add "$($units[$i].resistance.fire*$damage)"}
						[/case]
						[case]
							value=cold
								{VARIABLE_OP healed_amount add "$($units[$i].resistance.cold*$damage)"}
						[/case]
						[case]
							value=blade
								{VARIABLE_OP healed_amount add "$($units[$i].resistance.blade*$damage)"}
						[/case]
						[case]
							value=pierce
								{VARIABLE_OP healed_amount add "$($units[$i].resistance.pierce*$damage)"}
						[/case]
						[case]
							value=impact
								{VARIABLE_OP healed_amount add "$($units[$i].resistance.impact*$damage)"}
						[/case]
					[/switch]
				{NEXT i}
				{VARIABLE_OP healed_amount2 value "$($healed_amount/1000)"}
				{VARIABLE_OP healed_amount2 divide 2}
				[if]
					[variable]
						name=healed_amount2
						greater_than=10
					[/variable]
					[then]
						{VARIABLE_OP unit.hitpoints value 10}
						{VARIABLE_OP healed_amount2 value 10}
					[/then]
					[else]
						{VARIABLE_OP unit.hitpoints add "$($healed_amount2)"}
					[/else]
				[/if]
				[if]
					[variable]
						name=unit.hitpoints
						greater_than=$unit.max_hitpoints
					[/variable]
					[then]
						{VARIABLE unit.hitpoints $unit.max_hitpoints}
					[/then]
				[/if]
				[floating_text]
					x,y=$x1,$y1
					text="<span_color='#00FF00'>$($healed_amount2)</span_color>"
				[/floating_text]
				[unstore_unit]
					variable=unit
					find_vacant=no
					{COLOR_HEAL}
					text= _ "$($healed_amount2)"
				[/unstore_unit]
	#			[heal_unit]		#Frikkin bug in wesnoth
	#				[filter]
	#					x,y=$x1,$y1
	#				[/filter]	
	#				amount=$($healed_amount/400)
	#				animate=no
	#				restore_statuses=no
	#			[/heal_unit]
			{CLEAR_VARIABLE units}
			{CLEAR_VARIABLE healed_amount}
			{CLEAR_VARIABLE healed_amount2}
			[/else]
		[/if]
		[if]
			[variable]
				name=has_drain
				equals=0
			[/variable]
			[else]
				[store_unit]		#We need to know how many units were drained, and what were their resistances
					[filter]
						[filter_adjacent]
							x,y=$x1,$y1
						[/filter_adjacent]
						[not]
							x,y=$x2,$y2
						[/not]
						[filter_side]
							[enemy_of]
								side=$unit.side
							[/enemy_of]
						[/filter_side]
					[/filter]
					variable=units
				[/store_unit]  
				{VARIABLE healed_amount 0}
				{FOREACH units i}
				[switch]
					variable=weapon.type
					[case]
						value=arcane
							{VARIABLE_OP healed_amount add "$($units[$i].resistance.arcane*$damage)"}
					[/case]
					[case]
						value=fire
							{VARIABLE_OP healed_amount add "$($units[$i].resistance.fire*$damage)"}
					[/case]
					[case]
						value=cold
							{VARIABLE_OP healed_amount add "$($units[$i].resistance.cold*$damage)"}
					[/case]
					[case]
						value=blade
							{VARIABLE_OP healed_amount add "$($units[$i].resistance.blade*$damage)"}
					[/case]
					[case]
						value=pierce
							{VARIABLE_OP healed_amount add "$($units[$i].resistance.pierce*$damage)"}
					[/case]
					[case]
						value=impact
							{VARIABLE_OP healed_amount add "$($units[$i].resistance.impact*$damage)"}
					[/case]
				[/switch]
				{NEXT i}
				{VARIABLE_OP healed_amount2 value "$($healed_amount/200)"}
				{VARIABLE_OP healed_amount2 divide 2}
				[if]
					[variable]
						name=healed_amount2
						greater_than=10
					[/variable]
					[then]
						{VARIABLE_OP unit.hitpoints value 10}
						{VARIABLE_OP healed_amount2 value 10}
					[/then]
					[else]
						{VARIABLE_OP unit.hitpoints add "$($healed_amount2)"}
					[/else]
				[/if]
				[if]
					[variable]
						name=unit.hitpoints
						greater_than=$unit.max_hitpoints
					[/variable]
					[then]
						{VARIABLE unit.hitpoints $unit.max_hitpoints}
					[/then]
				[/if]
				[floating_text]
					x,y=$x1,$y1
					text="<span_color='#00FF00'>$($healed_amount2)</span_color>"
				[/floating_text]
				[heal_unit]
					[filter]
						x,y=$x1,$y1
					[/filter]	
					amount=$($healed_amount2)
					animate=no
				[/heal_unit]
			{CLEAR_VARIABLE units}
			{CLEAR_VARIABLE healed_amount}
			{CLEAR_VARIABLE healed_amount2}
			[/else]
		[/if]
		{VARIABLE_OP unit.hitpoints value $damage}
		{VARIABLE_OP damage_of_unit value $damage}
		{VARIABLE_OP damage_of_unit divide 2}
		[if]
			[variable]
				name=damage_of_unit
				greater_than=15
			[/variable]
			[then]
				{VARIABLE_OP damage_of_unit value 15}
			[/then]
		[/if]
		[harm_unit]
			[filter]
				[filter_adjacent]
					x,y=$x1,$y1
				[/filter_adjacent]
				[not]
					x,y=$x2,$y2
				[/not]
				[filter_side]
					[enemy_of]
						side=$unit.side
					[/enemy_of]
				[/filter_side]
			[/filter]
			[filter_second]
				x,y=$x1,$y1
			[/filter_second]
			amount=$damage_of_unit
			damage_type=$weapon.type
			fire_event=yes
			experience=no
			poisoned=$has_poison
			slowed=$has_slow
		[/harm_unit] 
		{CLEAR_VARIABLE has_slow}
		{CLEAR_VARIABLE has_poison}
		{CLEAR_VARIABLE has_leech}
		{CLEAR_VARIABLE has_drain,damage,damage_of_unit}
	[/event]

# event that creates a "pickpocket has worked" variable
# and sets it to "yes" if the attacker hits at least once.
[event]
  name=attacker hits
  first_time_only=no   
  [filter_attack]
     special=weapon_pickpocket
  [/filter_attack]   
  [store_unit]
     [filter]
        x,y=$x1,$y1
     [/filter]
     variable=unit_att_with_pickpocket
     mode=append
  [/store_unit]
  [set_variable]
     name=unit_att_with_pickpocket.variables.pickpocket_has_worked
     value=yes
  [/set_variable]
  [unstore_unit]
     variable=unit_att_with_pickpocket
  [/unstore_unit]   
  {CLEAR_VARIABLE unit_att_with_pickpocket}
[/event]
[event]
  name=attacker hits
  first_time_only=no  
  [filter_attack]
     special=weapon_pickpocket
  [/filter_attack]   
  [store_unit]
     [filter]
        x,y=$x1,$y1
     [/filter]
     variable=pickpocketer
     mode=append
  [/store_unit]   
  [store_unit]
     [filter]
        x,y=$x2,$y2
     [/filter]
     variable=pickpocketed
     mode=append
  [/store_unit]   
  [if]
     [variable]
        name=pickpocketer.variables.pickpocket_has_worked
        equals=yes
     [/variable]
     [then]
   [gold]
    side=$side_number
    amount=2
   [/gold]
        [unstore_unit]
           variable=pickpocketed
           text="!"
           {COLOR_HEAL}
        [/unstore_unit]
     [/then]
  [/if]   
  {CLEAR_VARIABLE pickpocketer}
  {CLEAR_VARIABLE pickpocketed}
[/event]


[event]
    name=side turn
    first_time_only=no

	[filter_attack]
		special="split fire"
	[/filter_attack]   
    [store_unit]
       #[filter]
       #	type={TYPE}
       #[/filter]
        variable=split_fire_unit_store
     mode=append
    [/store_unit]

    {FOREACH split_fire_unit_store i}
        [if]
            [variable]
                name=split_fire_unit_store[$i].variables.split_fire_attacked
                boolean_equals=yes
            [/variable]

            [then]
                {FOREACH split_fire_unit_store[$i].attack j}
					{VARIABLE split_fire_variable 0}
					{FOREACH split_fire_unit_store[$i].attack[$j].specials.dummy k}
						[if]
							[variable]
								name=split_fire_unit_store[$i].attack[$j].specials.dummy[$k].id
								not_equals="split fire"
							[/variable]
							[then]
							[/then]
							[else]
								{VARIABLE_OP split_fire_variable add 1}
							[/else]
						[/if]
					{NEXT k}
					[if]
						[variable]
							name="split_fire_variable"
							equals=0
						[/variable]
						[then]
							[set_variable]
								name=split_fire_unit_store[$i].attack[$j].attack_weight
								add=1
							[/set_variable]
						[/then]
					[/if]
                #    [if]
                #        [variable]
                #            name=split_fire_unit_store[$i].attack[$j].name
                #            not_equals={ATTACK_NAME}
                #        [/variable]
				#
                #        [then]
                #            [set_variable]
                #                name=split_fire_unit_store[$i].attack[$j].attack_weight
                #                add=1
                #            [/set_variable]
                #        [/then]
                #    [/if]
                {NEXT j}

                [set_variable]
                    name=split_fire_unit_store[$i].variables.split_fire_attacked
                    value=no
                [/set_variable]

                [unstore_unit]
                    variable=split_fire_unit_store[$i]
                [/unstore_unit]
            [/then]
        [/if]
    {NEXT i}
[/event]

[event]
    name=attack_end
    first_time_only=no
    [filter_attack]
        special="split fire"
    [/filter_attack]

    #[filter]
    #    type={TYPE}
    #[/filter]

    [store_unit]
        [filter]
            id=$unit.id
        [/filter]
        variable=tmp_split_fire_unit_store
    [/store_unit]

    [if]
        [variable]
            name=tmp_split_fire_unit_store.variables.split_fire_attacked
            boolean_not_equals=yes
        [/variable]

        [then]
            {SPLIT_FIRE_SECOND_ATTACK}
        [/then]

        [else]
            [if]
                [variable]
                    name=tmp_split_fire_unit_store.variables.split_fire_turn
                    not_equals=$turn_number
                [/variable]

                [then]
                    {SPLIT_FIRE_SECOND_ATTACK}
                [/then]
            [/if]
        [/else]
    [/if]
[/event]

[event]
    name=victory

    [clear_variable]
        name=tmp_split_fire_unit_store,split_fire_unit_store,split_fire_variable,tmp_split_fire_variable
    [/clear_variable]
[/event]
	

[event]
    name=attacker hits
    first_time_only=no
    [filter_attack]
        special=cleave 2
    [/filter_attack]

    [store_unit]
        variable=loc_store
        [filter]
            [filter_adjacent]
                x,y=$x2,$y2
            [/filter_adjacent]
            [filter_adjacent]
                x,y=$x1,$y1
            [/filter_adjacent]
        [/filter]
    [/store_unit]

    [store_unit]
        variable=unit_with_cleave
        [filter]
            id=$unit.id
        [/filter]
    [/store_unit]

    # Grab the attack's raw power and attack type
    {FOREACH unit_with_cleave i}
        [if]
            [variable]
                name=unit_with_cleave.attack[$i].name
                equals="mighty cyclops tree"
            [/variable]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="raging cyclops tree"
				[/variable]
			[/or]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="cyclops destroyer tree"
				[/variable]
			[/or]

            [then]
                [set_variable]
                    name=tmp_cleave_damage
                    value=$unit_with_cleave.attack[$i].damage
                [/set_variable]

                [set_variable]
                    name=tmp_cleave_attack_type
                    value=$unit_with_cleave.attack[$i].type
                [/set_variable]
            [/then]
        [/if]
    {NEXT i}

    # Divide by two; four if the user is slowed
    [if]
        [variable]
            name=unit_with_cleave.status.slowed
            not_equals=yes
        [/variable]

        [then]
            [set_variable]
                name=tmp_cleave_damage
                divide=2
            [/set_variable]
        [/then]

        [else]
            [set_variable]
                name=tmp_cleave_damage
                divide=4
            [/set_variable]
        [/else]
    [/if]

    # Round down
    [set_variable]
        name=tmp_cleave_damage
        round=floor
    [/set_variable]

    # Deal the damage
    [switch]
        variable=loc_store.length
        [case]
            value=1
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
        [case]
            value=2
            {CLEAVE_DAMAGE_HEX 1}
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
    [/switch]

    [clear_variable]
        name=loc_store,unit_with_cleave,tmp_cleave_damage,tmp_cleave_attack_type
    [/clear_variable]
[/event]

[event]
    name=defender hits
    first_time_only=no
    [filter_second_attack]
        special=cleave 2
    [/filter_second_attack]

    [store_unit]
        variable=loc_store
        [filter]
            [filter_adjacent]
                x,y=$x2,$y2
            [/filter_adjacent]
            [filter_adjacent]
                x,y=$x1,$y1
            [/filter_adjacent]
        [/filter]
    [/store_unit]

    [store_unit]
        variable=unit_with_cleave
        [filter]
            id=$second_unit.id
        [/filter]
    [/store_unit]

    # Grab the attack's raw power and attack type
    {FOREACH unit_with_cleave i}
        [if]
            [variable]
                name=unit_with_cleave.attack[$i].name
                equals="mighty cyclops tree"
            [/variable]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="raging cyclops tree"
				[/variable]
			[/or]
			[or]
				[variable]
					name=unit_with_cleave.attack[$i].name
					equals="cyclops destroyer tree"
				[/variable]
			[/or]

            [then]
                [set_variable]
                    name=tmp_cleave_damage
                    value=$unit_with_cleave.attack[$i].damage
                [/set_variable]

                [set_variable]
                    name=tmp_cleave_attack_type
                    value=$unit_with_cleave.attack[$i].type
                [/set_variable]
            [/then]
        [/if]
    {NEXT i}

    # Divide by two; four if the user is slowed
    [if]
        [variable]
            name=unit_with_cleave.status.slowed
            equals=yes
        [/variable]

        [then]
            [set_variable]
                name=tmp_cleave_damage
                divide=4
            [/set_variable]
        [/then]

        [else]
            [set_variable]
                name=tmp_cleave_damage
                divide=2
            [/set_variable]
        [/else]
    [/if]

    # Round down
    [set_variable]
        name=tmp_cleave_damage
        round=floor
    [/set_variable]

    # Deal the damage
    [switch]
        variable=loc_store.length
        [case]
            value=1
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
        [case]
            value=2
            {CLEAVE_DAMAGE_HEX 1}
            {CLEAVE_DAMAGE_HEX 0}
        [/case]
    [/switch]

    [clear_variable]
        name=loc_store,unit_with_cleave,tmp_cleave_damage,tmp_cleave_attack_type_type
    [/clear_variable]
[/event]	


[event]
    name=attack_end
    first_time_only=no
    [filter_attack]
        special=double attack 2
    [/filter_attack]

    [store_unit]
        [filter]
            id=$unit.id
        [/filter]
        variable=tmp_double_attack_unit_store
    [/store_unit]

    [if]
        [variable]
            name=tmp_double_attack_unit_store.variables.double_attack_attacked
            boolean_not_equals=yes
        [/variable]

        [then]
            {SECOND_ATTACK}
        [/then]

        [else]
            [if]
                [variable]
                    name=tmp_double_attack_unit_store.variables.double_attack_turn
                    not_equals=$turn_number
                [/variable]

                [then]
                    {SECOND_ATTACK}
                [/then]
            [/if]
        [/else]
    [/if]
[/event]

[event]
    name=side turn
    first_time_only=no

    [clear_variable]
        name=tmp_double_attack_unit_store
    [/clear_variable]
[/event]

[event]
    name=victory

    [clear_variable]
        name=tmp_double_attack_unit_store
    [/clear_variable]
[/event]

[event]
    name=attacker hits
    first_time_only=no
    [filter_attack]
        name=demon heterodox axe
    [/filter_attack]
	{EVENT_DEADLYSTRIKE}
[/event]
[event]
    name=attacker hits
    first_time_only=no
    [filter_attack]
        name=demon heretic cursed battleaxe
    [/filter_attack]
	{EVENT_DEADLYSTRIKE}
[/event]
[event]
    name=attacker hits
    first_time_only=no
    [filter_attack]
        name=demon apostate cursed battleaxe
    [/filter_attack]
	{EVENT_DEADLYSTRIKE}
[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_undead_01
		[filter_second_attack]
			special=plague_undead_01_event
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_UNDEAD}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_UNDEAD)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_forgotten_beasts_01_event
		[filter_second_attack]
			special=plague_forgotten_beasts_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_FORGOTTEN_BEASTS}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_FORGOTTEN_BEASTS)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_fallen_legions_01_event
		[filter_second_attack]
			special=plague_fallen_legions_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_FALLEN_LEGIONS}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_FALLEN_LEGIONS)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_chosen_of_magic_01_event
		[filter_second_attack]
			special=plague_chosen_of_magic_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_CHOSEN_OF_MAGIC}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_CHOSEN_OF_MAGIC)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_drakes_01_event
		[filter_second_attack]
			special=plague_drakes_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_DRAKES}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_DRAKES)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_knalgan_alliance_01_event
		[filter_second_attack]
			special=plague_knalgan_alliance_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_KNALGAN_ALLIANCE}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_KNALGAN_ALLIANCE)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_rebels_01_event
		[filter_second_attack]
			special=plague_rebels_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_REBELS}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_REBELS)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_northerners_01_event
		[filter_second_attack]
			special=plague_northerners_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_NORTHERNERS}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_NORTHERNERS)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	[event]
		name=last breath
		first_time_only=no
		id=plague_loyalists_01_event
		[filter_second_attack]
			special=plague_loyalists_01
		[/filter_second_attack]
		{ALL_UNITS_01LVLS_LOYALISTS}
		{VARIABLE_OP transform_type rand ($ALL01LVLS_LOYALISTS)}
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit}
	[/event]
	
	
	[event]
		name=last breath
		first_time_only=no
		id=latent_plague_lawfuls_01_event
		[filter_second_attack]
			special=latent_plague_lawfuls_01
		[/filter_second_attack]
		[set_variable]
			name=random_op_plague
			rand=1..3
		[/set_variable]
		[switch]
			variable=random_op_plague
			[case]
				value=1
				{ALL_UNITS_01LVLS_CHOSEN_OF_MAGIC}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_CHOSEN_OF_MAGIC)}
			[/case]
			[case]
				value=2
				{ALL_UNITS_01LVLS_DRAKES}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_DRAKES)}
			[/case]
			[case]
				value=3
				{ALL_UNITS_01LVLS_LOYALISTS}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_LOYALISTS)}
			[/case]
		[/switch]
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit,random_op_plague}
	[/event]
	
	[event]
		name=last breath
		first_time_only=no
		id=latent_plague_neutrals_01_event
		[filter_second_attack]
			special=latent_plague_neutrals_01
		[/filter_second_attack]
		[set_variable]
			name=random_op_plague
			rand=1..3
		[/set_variable]
		[switch]
			variable=random_op_plague
			[case]
				value=1
				{ALL_UNITS_01LVLS_KNALGAN_ALLIANCE}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_KNALGAN_ALLIANCE)}
			[/case]
			[case]
				value=2
				{ALL_UNITS_01LVLS_REBELS}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_REBELS)}
			[/case]
			[case]
				value=3
				{ALL_UNITS_01LVLS_FORGOTTEN_BEASTS}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_FORGOTTEN_BEASTS)}
			[/case]
		[/switch]
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit,random_op_plague}
	[/event]
	
	[event]
		name=last breath
		first_time_only=no
		id=latent_plague_chaotics_01_event
		[filter_second_attack]
			special=latent_plague_chaotics_01
		[/filter_second_attack]
		[set_variable]
			name=random_op_plague
			rand=1..3
		[/set_variable]
		[switch]
			variable=random_op_plague
			[case]
				value=1
				{ALL_UNITS_01LVLS_UNDEAD}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_UNDEAD)}
			[/case]
			[case]
				value=2
				{ALL_UNITS_01LVLS_NORTHERNERS}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_NORTHERNERS)}
			[/case]
			[case]
				value=3
				{ALL_UNITS_01LVLS_FALLEN_LEGIONS}
				{VARIABLE_OP transform_type rand ($ALL01LVLS_FALLEN_LEGIONS)}
			[/case]
		[/switch]
		[kill]
			x,y=$x1,$y1
			animate=yes
			[secondary_unit]
				x,y=$x2,y2
			[/secondary_unit]
		[/kill]
		[unit]
			side=$second_unit.side
			type=$transform_type
			x,y=$x1,$y1
			moves=0
		[/unit]
		[store_unit]
			variable=newunit
			[filter]
				x,y=$x1,$y1
			[/filter]
		[/store_unit]
		[set_variable]
			name=newunit.attacks_left
			value=0
		[/set_variable]
		[unstore_unit]
			variable=newunit
			find_vacant=no
		[/unstore_unit]
		{CLEAR_VARIABLE transform_type,newunit,random_op_plague}
	[/event]
	
	{ASK_ABOUT_FUNNY_BONUSES}
	{START_FUNNY_BONUSES_EVENTS}
	
	{START_MWC_INFO}
	
	
	[event]
		name=start
		id=unit_menu_start_1
		[if]
			[have_unit]
				side=$side_number
			[/have_unit]
			[then]
				{MWC_UNIT_MENU}
			[/then]
		[/if]
	[/event]
	
	[event]
		name=side turn
		id=unit_menu_start_2
		[if]
			[have_unit]
				side=$side_number
			[/have_unit]
			[then]
				{MWC_UNIT_MENU}
			[/then]
		[/if]
	[/event]

	[event]
		name=recruit
		id=unit_menu_start_3
		[filter]
			side=$side_number
		[/filter]
		{MWC_UNIT_MENU}
	[/event]

	[event]
		name=post advance
		id=unit_menu_start_4
		[filter]
			side=$side_number
		[/filter]
		{MWC_UNIT_MENU}
	[/event]
	
	


	[event]
		id=decreasing_special_abilities_time_values
		name=side turn
		first_time_only=no
		[if]
			[variable]
				name=special_abilities_were_used_atleast_once_$side_number
				not_equals=$null
			[/variable]
			[then]
				[store_unit]
					[filter]
						side=$side_number
					[/filter]
					kill=no
					variable=extra_special_abilities_inside
				[/store_unit]
				{FOREACH extra_special_abilities_inside z}
					[if]
						[variable]
							name=special_abilities_were_used_$side_number
							not_equals=$null
						[/variable]
						[then]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_heal_limited}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_heal_limited}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_heal_unlimited}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_heal_unlimited}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_friendly_heal}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_friendly_heal}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_attack}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_attack}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_mp}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_mp}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_blessed_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_blessed_weaker_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_blessed_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_blessed_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_blessed_weaker_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_blessed_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_vicious_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_vicious_melee_$extra_special_abilities_inside[$z].variables.extra_vicious_melee_value
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_vicious_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_vicious_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_vicious_ranged_$extra_special_abilities_inside[$z].variables.extra_vicious_ranged_value
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_vicious_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_undaunted_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_undaunted1_melee_$extra_special_abilities_inside[$z].variables.extra_undaunted_melee_value
								[/effect]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_undaunted2_melee_$extra_special_abilities_inside[$z].variables.extra_undaunted_melee_value
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_undaunted_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_undaunted_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_undaunted1_ranged_$extra_special_abilities_inside[$z].variables.extra_undaunted_ranged_value
								[/effect]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_undaunted2_ranged_$extra_special_abilities_inside[$z].variables.extra_undaunted_ranged_value
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_undaunted_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_charge_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_charge_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_charge_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_charge_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_charge_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_charge_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_focus_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_focus_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_focus_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_focus_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_focus_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_focus_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_drain_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_drain_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_drain_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_drain_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_drain_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_drain_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_slow_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_slow_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_slow_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_slow_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_slow_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_slow_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_poison_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_poison_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_poison_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_poison_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_poison_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_poison_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_duel2_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_duel2_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_duel2_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_duel2_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_duel2_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_duel2_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_backstab_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_backstab_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_backstab_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_backstab_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_backstab_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_backstab_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_marksman_melee}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=melee
									remove_specials=special_marksman_melee
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_marksman_melee}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_marksman_ranged}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=attack
									range=ranged
									remove_specials=special_marksman_ranged
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_marksman_ranged}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_skirmisher}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=remove_ability
									[abilities]
										[skirmisher]
											id=special_skirmisher
										[/skirmisher]
									[/abilities]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_skirmisher}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_teleport}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=remove_ability
									[abilities]
										[skirmisher]
											id=special_teleport
										[/skirmisher]
									[/abilities]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_teleport}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_mass_poison}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_mass_poison}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_mass_slow}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_mass_slow}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_resistances_physical}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=resistance
									replace=true
									[resistance]
										blade=$extra_special_abilities_inside[$z].variables.extra_blade_value
										pierce=$extra_special_abilities_inside[$z].variables.extra_pierce_value
										impact=$extra_special_abilities_inside[$z].variables.extra_impact_value
									[/resistance]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_resistances_physical}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_resistances_notphysical}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=resistance
									replace=true
									[resistance]
										fire=$extra_special_abilities_inside[$z].variables.extra_fire_value
										cold=$extra_special_abilities_inside[$z].variables.extra_cold_value
										arcane=$extra_special_abilities_inside[$z].variables.extra_arcane_value
									[/resistance]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_resistances_notphysical}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_mountains_hills}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=movement_costs
									replace=yes
									[movement_costs]
										hills=$extra_special_abilities_inside[$z].variables.extra_mountains_value
										mountains=$extra_special_abilities_inside[$z].variables.extra_hills_value
									[/movement_costs]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_mountains_hills}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_swamp_shallow}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=movement_costs
									replace=yes
									[movement_costs]
										swamp_water=$extra_special_abilities_inside[$z].variables.extra_swamp_value
										shallow_water=$extra_special_abilities_inside[$z].variables.extra_shallow_value
									[/movement_costs]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_swamp_shallow}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_reef_sand}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=movement_costs
									replace=yes
									[movement_costs]
										reef=$extra_special_abilities_inside[$z].variables.extra_reef_value
										sand=$extra_special_abilities_inside[$z].variables.extra_sand_value
									[/movement_costs]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_reef_sand}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_cave_fungus}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=movement_costs
									replace=yes
									[movement_costs]
										cave=$extra_special_abilities_inside[$z].variables.extra_cave_value
										fungus=$extra_special_abilities_inside[$z].variables.extra_fungus_value
									[/movement_costs]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_cave_fungus}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_frozen_flat_forest}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=movement_costs
									replace=yes
									[movement_costs]
										frozen=$extra_special_abilities_inside[$z].variables.extra_frozen_value
										flat=$extra_special_abilities_inside[$z].variables.extra_flat_value
										forest=$extra_special_abilities_inside[$z].variables.extra_forest_value
									[/movement_costs]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_frozen_flat_forest}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_deep_unwalkable}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=movement_costs
									replace=yes
									[movement_costs]
										unwalkable=$extra_special_abilities_inside[$z].variables.extra_unwalkable_value
										deep_water=$extra_special_abilities_inside[$z].variables.extra_deep_value
									[/movement_costs]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_deep_unwalkable}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_castle_village}
							[object]
								silent=yes
								[filter]
									id=$extra_special_abilities_inside[$z].id
								[/filter]
								[effect]
									apply_to=movement_costs
									replace=yes
									[movement_costs]
										unwalkable=$extra_special_abilities_inside[$z].variables.extra_castle_value
										deep_water=$extra_special_abilities_inside[$z].variables.extra_village_value
									[/movement_costs]
								[/effect]
							[/object]
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_castle_village}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_START extra_potions}
							{WITHDRAWAL_IMPROVEMENTS_FROM_UNIT_END extra_potions}
							[if]
								[variable]
									name=extra_special_abilities_inside[$z].variables.extra_special_abilities_value
									not_equals=$null
								[/variable]
								[and]
									[variable]
										name=extra_special_abilities_inside[$z].variables.extra_special_abilities_value
										less_than=3
									[/variable]
								[/and]
								[then]
									{MODIFY_UNIT id=$extra_special_abilities_inside[$z].id variables.extra_special_abilities_value 3}
								[/then]
							[/if]
						[/then]
					[/if]
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_heal_limited}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_heal_unlimited}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_friendly_heal}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_attack}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_mp}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_blessed_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_blessed_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_vicious_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_vicious_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_undaunted_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_undaunted_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_charge_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_charge_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_focus_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_focus_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_drain_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_drain_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_slow_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_slow_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_poison_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_poison_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_duel2_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_duel2_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_backstab_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_backstab_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_marksman_melee}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_marksman_ranged}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_skirmisher}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_teleport}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_mass_poison}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_mass_slow}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_resistances_physical}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_resistances_notphysical}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_mountains_hills}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_swamp_shallow}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_reef_sand}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_cave_fungus}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_frozen_flat_forest}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_deep_unwalkable}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_castle_village}
					{DECREASE_VARIABLES_FOR_SPECIAL_ABILITY extra_potions}
					{CLEAR_VARIABLE extra_special_abilities_inside[$z].underlying_id,extra_special_abilities_inside[$z].id} 
				{NEXT z}
				{CLEAR_VARIABLE extra_special_abilities_inside,special_abilities_were_used_$side_number}
			[/then]
		[/if]
	[/event]
	
	[event]
		id=increase_special_abilities_points
		name=post advance
		first_time_only=no
		[store_unit]
			[filter]
				#side=$side_number
				x,y=$x1,$y1
			[/filter]
			variable=unit_to_get_sap
			kill=no
		[/store_unit]   
		[if]
			[variable]
				name=unit_to_get_sap.variables.available_special_abilities
				equals=$null
			[/variable]
			[then]
				{VARIABLE_OP unit_to_get_sap.variables.available_special_abilities value $unit_to_get_sap.level}
				{VARIABLE_OP unit_to_get_sap.variables.available_special_abilities add 1}
			[/then]
			[else]
				{VARIABLE_OP unit_to_get_sap.variables.available_special_abilities add 1}
			[/else]
		[/if]
		[if]
			[variable]
				name=unit_to_get_sap.variables.extra_special_abilities_value
				equals=$null
			[/variable]
			[then]
				{VARIABLE_OP unit_to_get_sap.variables.extra_special_abilities_value value 3}
			[/then]
		[/if]
		[unstore_unit]
		   variable=unit_to_get_sap
		   find_vacant=no
		   check_passability=no
		[/unstore_unit]
	[/event]
	
	[event]
		name=side turn end
		first_time_only=no
		id=check_deposits_1
		{CHECK_DEPOSITS_TURNS_1 1}
		{CHECK_DEPOSITS_TURNS_1 2}
		{CHECK_DEPOSITS_TURNS_1 3}
		{CHECK_DEPOSITS_TURNS_1 4}
		{CHECK_DEPOSITS_TURNS_1 5}
		{CHECK_DEPOSITS_TURNS_1 6}
		{CHECK_DEPOSITS_TURNS_1 7}
		{CHECK_DEPOSITS_TURNS_1 8}
		{CHECK_DEPOSITS_TURNS_1 9}
		{CHECK_DEPOSITS_TURNS_1 10}
	[/event]
	
	[event]
		name=side turn
		first_time_only=no
		id=check_deposits_2
		{CHECK_DEPOSITS_TURNS_2 1}
		{CHECK_DEPOSITS_TURNS_2 2}
		{CHECK_DEPOSITS_TURNS_2 3}
		{CHECK_DEPOSITS_TURNS_2 4}
		{CHECK_DEPOSITS_TURNS_2 5}
		{CHECK_DEPOSITS_TURNS_2 6}
		{CHECK_DEPOSITS_TURNS_2 7}
		{CHECK_DEPOSITS_TURNS_2 8}
		{CHECK_DEPOSITS_TURNS_2 9}
		{CHECK_DEPOSITS_TURNS_2 10}
		[if]
			[variable]
				name=random_variable_for_gold
				not_equals=$null
			[/variable]
			[then]
				[gold]
					amount=$random_variable_for_gold
					side=$side_number
				[/gold]
				{CLEAR_VARIABLE random_variable_for_gold}
			[/then]
		[/if]
	[/event]
	
	{INCREASE_GOLD_FOR_GOLD_COLLECTORS}
	
	{WILD_MAGIC_EVENT}
	
	{CLASSES_FOR_AI_UNITS}
	
	{ADVANCE_MWC_SETUP_START}
#enddef